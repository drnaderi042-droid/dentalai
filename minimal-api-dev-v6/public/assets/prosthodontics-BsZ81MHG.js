import{by as se,bx as ae,r as c,aS as re,aT as ne,aU as I,j as e,aV as ie,aW as oe,aY as le,i as ce,e5 as O,e as M,T as i,B as A,d as l,I as j,aB as de,C as H,cI as R,bc as h,aC as B,cG as T,S as F,dh as v,di as S,H as me}from"./index-BH9ijvcg.js";import{u as z,a as U,F as r}from"./form-provider-b5GXhABL.js";import"./image-CxkC95SJ.js";import"./editor-BUp8U2Vl.js";import{C as xe}from"./confirm-dialog-U4gI9R8N.js";import{G as s}from"./Grid-vZ7eNkvH.js";import{C as he}from"./Card-CwEGl0A2.js";import{C as ue}from"./CardContent-Bbr3YBl8.js";import{D as W}from"./DialogTitle-BFho6EhL.js";import{D as _}from"./DialogContent-CtzR1nPJ.js";import{D as J}from"./dialogTitleClasses-CSmkbKpM.js";import"./TextField-DgF_8CdY.js";import"./Select-fMsy-Lkz.js";import"./Menu-C7S9TApF.js";import"./InputLabel-OzeQogzC.js";import"./FormLabel-Cn8enUsF.js";import"./FormHelperText-CAGzEAMm.js";import"./FormControl-rHOkSiGz.js";import"./Rating-BeEojfFm.js";import"./visuallyHidden-Dan1xhjv.js";import"./Slider-nP-7N9E2.js";import"./RadioGroup-7Oa-Pyj3.js";import"./FormGroup-BEVR9nif.js";import"./FormControlLabel-CVzZoZzb.js";import"./index-DVaqB1VX.js";import"./countries-DSLisFCy.js";import"./Autocomplete-Crt2raTS.js";import"./Chip-CWilL4Fh.js";import"./country-select-DjjsCD_N.js";import"./Checkbox-AhG6TMzi.js";import"./upload-BVxhxEL6.js";import"./preview-multi-file--Yn4-mQ8.js";import"./format-number-z67FV_-O.js";import"./file-thumbnail-GgYbZAeX.js";import"./upload-avatar-Dm2-m_zx.js";import"./avatar-url-votlVkc-.js";import"./DatePicker-Br6g6rY4.js";import"./ListItem-Ch3K_gMr.js";import"./MobileDateTimePicker-CzN3TBFx.js";import"./index-BVzUWzoE.js";function je(a){return se("MuiCardActions",a)}ae("MuiCardActions",["root","spacing"]);const pe=["disableSpacing","className"],ge=a=>{const{classes:d,disableSpacing:o}=a;return le({root:["root",!o&&"spacing"]},je,d)},be=ie("div",{name:"MuiCardActions",slot:"Root",overridesResolver:(a,d)=>{const{ownerState:o}=a;return[d.root,!o.disableSpacing&&d.spacing]}})(({ownerState:a})=>I({display:"flex",alignItems:"center",padding:8},!a.disableSpacing&&{"& > :not(style) ~ :not(style)":{marginLeft:8}})),ye=c.forwardRef(function(d,o){const u=re({props:d,name:"MuiCardActions"}),{disableSpacing:p=!1,className:g}=u,b=ne(u,pe),y=I({},u,{disableSpacing:p}),f=ge(y);return e.jsx(be,I({className:oe(f.root,g),ownerState:y,ref:o},b))}),fe={PENDING:"شروع درمان",IN_TREATMENT:"در حال درمان",COMPLETED:"اتمام درمان",CANCELLED:"متوقف شده"};function De(){const{user:a}=ce(),[d,o]=c.useState([]),[u,p]=c.useState(!0),[g,b]=c.useState(null),[y,f]=c.useState(!1),[Y,w]=c.useState(!1),[q,k]=c.useState(!1),[G,$]=c.useState(null),[m,L]=c.useState(null),D=z({defaultValues:{firstName:"",lastName:"",phone:"",age:"",diagnosis:"",treatment:"",status:"PENDING",notes:"",nextVisitTime:null,treatmentStartDate:null}}),C=z({defaultValues:{firstName:"",lastName:"",phone:"",age:"",diagnosis:"",treatment:"",status:"PENDING",notes:"",nextVisitTime:null,treatmentStartDate:null}});c.useEffect(()=>{a&&(async()=>{try{p(!0);const n=await v.get(S.patients,{headers:{Authorization:`Bearer ${a==null?void 0:a.accessToken}`}});o(n.data.patients||[]),b(null)}catch(n){console.error("Error fetching patients:",n),b("خطا در بارگیری بیماران"),o([])}finally{p(!1)}})()},[a]);const K=()=>{D.reset({firstName:"",lastName:"",phone:"",age:"",diagnosis:"",treatment:"",status:"PENDING",notes:"",nextVisitTime:null,treatmentStartDate:null}),f(!0)},E=()=>{f(!1),D.reset()},Q=t=>{$(t),C.reset({firstName:t.firstName,lastName:t.lastName,phone:t.phone,age:t.age,diagnosis:t.diagnosis,treatment:t.treatment,status:t.status,notes:t.notes||"",nextVisitTime:t.nextVisitTime?new Date(t.nextVisitTime):null,treatmentStartDate:t.treatmentStartDate?new Date(t.treatmentStartDate):null}),w(!0)},P=()=>{w(!1),$(null),C.reset()},X=t=>{L(t),k(!0)},V=()=>{k(!1),L(null)},Z=async t=>{try{const n=await v.post(S.patients,{...t,specialty:"PROSTHODONTICS"},{headers:{Authorization:`Bearer ${a==null?void 0:a.accessToken}`}});o(x=>[...x,n.data.patient]),E()}catch(n){console.error("Error adding patient:",n),alert("خطا در افزودن بیمار")}},ee=async t=>{try{const n=await v.put(`${S.patients}/${G.id}`,t,{headers:{Authorization:`Bearer ${a==null?void 0:a.accessToken}`}});o(x=>x.map(N=>N.id===G.id?n.data.patient:N)),P()}catch(n){console.error("Error updating patient:",n),alert("خطا در بروزرسانی بیمار")}},te=async t=>{try{await v.delete(`${S.patients}/${t}`,{headers:{Authorization:`Bearer ${a==null?void 0:a.accessToken}`}}),o(n=>n.filter(x=>x.id!==t))}catch(n){console.error("Error deleting patient:",n),alert("خطا در حذف بیمار")}};return u?e.jsx(O,{children:e.jsx(M,{children:e.jsx(i,{variant:"h4",sx:{textAlign:"center",mt:4},children:"بارگیری بیماران..."})})}):e.jsx(O,{children:e.jsxs(M,{children:[e.jsxs(A,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3,children:[e.jsx(i,{variant:"h4",children:"بخش پروتزهای دندانی"}),e.jsx(l,{variant:"contained",startIcon:e.jsx(j,{icon:"mingcute:add-line"}),onClick:K,children:"افزودن بیمار جدید"})]}),g&&e.jsx(i,{variant:"body1",color:"error",sx:{mb:4},children:g}),e.jsx(i,{variant:"body1",color:"text.secondary",mb:4,children:"مدیریت بیماران پروتزهای دندانی و ثبت اطلاعات تشخیصی"}),e.jsx(s,{container:!0,spacing:3,children:d.map(t=>{var x;const n=(x=t.radiologyImages)==null?void 0:x.find(N=>N.category==="profile");return e.jsx(s,{item:!0,xs:12,sm:6,md:4,children:e.jsxs(he,{children:[e.jsxs(ue,{children:[e.jsxs(A,{display:"flex",alignItems:"center",mb:2,children:[e.jsx(de,{sx:{mr:2,width:56,height:56},src:n?`${H.site.serverUrl}${n.path}`:void 0,children:n?null:`${t.firstName.charAt(0)}${t.lastName.charAt(0)}`}),e.jsxs(A,{children:[e.jsxs(i,{variant:"h6",children:[t.firstName," ",t.lastName]}),e.jsxs(i,{variant:"body2",color:"text.secondary",children:[t.age," سال"]})]})]}),t.nextVisitTime&&e.jsxs(i,{variant:"body2",color:"text.secondary",mb:1,children:[e.jsx("strong",{children:"ویزیت بعدی:"})," ",new Date(t.nextVisitTime).toLocaleDateString("fa-IR")]}),t.treatmentStartDate&&e.jsxs(i,{variant:"body2",color:"text.secondary",mb:1,children:[e.jsx("strong",{children:"شروع درمان:"})," ",new Date(t.treatmentStartDate).toLocaleDateString("fa-IR")]}),e.jsxs(i,{variant:"body2",color:"text.secondary",mb:1,children:[e.jsx("strong",{children:"تشخیص:"})," ",t.diagnosis]}),e.jsxs(i,{variant:"body2",color:"text.secondary",mb:1,children:[e.jsx("strong",{children:"درمان:"})," ",t.treatment]}),e.jsxs(i,{variant:"body2",color:"text.secondary",mb:1,children:[e.jsx("strong",{children:"وضعیت:"})," ",fe[t.status]||t.status]}),e.jsxs(i,{variant:"body2",color:"text.secondary",children:[e.jsx("strong",{children:"آخرین ویزیت:"})," ",new Date(t.updatedAt).toLocaleDateString("fa-IR")]})]}),e.jsxs(ye,{children:[e.jsx(l,{size:"small",onClick:()=>Q(t),startIcon:e.jsx(j,{icon:"solar:pen-bold"}),children:"اصلاح"}),e.jsx(l,{size:"small",onClick:()=>{window.location.href=`/dashboard/prosthodontics/patient/${t.id}`},startIcon:e.jsx(j,{icon:"solar:user-bold"}),children:"مدیریت بیمار"}),e.jsx(l,{size:"small",color:"error",onClick:()=>X(t),startIcon:e.jsx(j,{icon:"solar:trash-bin-minimalistic-bold"}),children:"حذف"})]})]})},t.id)})}),e.jsx(xe,{open:q,onClose:V,title:"حذف بیمار",content:`آیا مطمئن هستید که می‌خواهید بیمار ${m==null?void 0:m.firstName} ${m==null?void 0:m.lastName} را حذف کنید؟`,action:e.jsx(l,{variant:"contained",color:"error",onClick:()=>{m&&te(m.id),V()},children:"حذف"})}),e.jsxs(R,{open:y,onClose:E,maxWidth:"md",fullWidth:!0,children:[e.jsx(W,{children:"افزودن بیمار جدید"}),e.jsxs(U,{methods:D,onSubmit:D.handleSubmit(Z),children:[e.jsx(_,{children:e.jsxs(s,{container:!0,spacing:2,sx:{mt:1},children:[e.jsx(s,{item:!0,xs:12,sm:6,children:e.jsx(r.Text,{name:"firstName",label:"نام"})}),e.jsx(s,{item:!0,xs:12,sm:6,children:e.jsx(r.Text,{name:"lastName",label:"نام خانوادگی"})}),e.jsx(s,{item:!0,xs:12,sm:6,children:e.jsx(r.Text,{name:"phone",label:"شماره تلفن"})}),e.jsx(s,{item:!0,xs:12,sm:6,children:e.jsx(r.Text,{name:"age",label:"سن",type:"number"})}),e.jsx(s,{item:!0,xs:12,sm:6,children:e.jsx(r.DatePicker,{name:"treatmentStartDate",label:"تاریخ شروع درمان"})}),e.jsx(s,{item:!0,xs:12,sm:6,children:e.jsx(r.DatePicker,{name:"nextVisitTime",label:"تایم ویزیت بعدی"})}),e.jsx(s,{item:!0,xs:12,children:e.jsx(r.Text,{name:"diagnosis",label:"تشخیص",multiline:!0,rows:2})}),e.jsx(s,{item:!0,xs:12,children:e.jsx(r.Text,{name:"treatment",label:"طرح درمان",multiline:!0,rows:2})}),e.jsx(s,{item:!0,xs:12,children:e.jsxs(r.Select,{name:"status",label:"وضعیت",children:[e.jsx(h,{value:"PENDING",children:"شروع درمان"}),e.jsx(h,{value:"IN_TREATMENT",children:"در حال درمان"}),e.jsx(h,{value:"COMPLETED",children:"اتمام درمان"}),e.jsx(h,{value:"CANCELLED",children:"متوقف شده"})]})}),e.jsx(s,{item:!0,xs:12,children:e.jsx(r.Text,{name:"notes",label:"یادداشت ها",multiline:!0,rows:3})}),e.jsxs(s,{item:!0,xs:12,children:[e.jsx(i,{variant:"h6",gutterBottom:!0,children:"آپلود تصاویر رادیولوژی"}),e.jsxs(B,{variant:"outlined",sx:{p:3,textAlign:"center",borderStyle:"dashed",bgcolor:t=>T(t.palette.grey[500],.08),cursor:"pointer","&:hover":{bgcolor:t=>T(t.palette.grey[500],.16)}},children:[e.jsxs(F,{spacing:1,alignItems:"center",children:[e.jsx(j,{icon:"solar:cloud-upload-bold",width:32}),e.jsx(i,{variant:"body2",children:"تصاویر رادیولوژی را اینجا بکشید یا کلیک کنید"}),e.jsx(i,{variant:"caption",color:"text.secondary",children:"PNG, JPG, JPEG (حداکثر ۱۰ مگابایت)"})]}),e.jsxs("label",{htmlFor:"radiology-upload-add",children:[e.jsx("input",{type:"file",multiple:!0,accept:"image/*",style:{display:"none"},id:"radiology-upload-add"}),e.jsx(l,{variant:"outlined",component:"span",sx:{mt:2},children:"انتخاب فایل"})]})]})]})]})}),e.jsxs(J,{children:[e.jsx(l,{onClick:E,children:"انصراف"}),e.jsx(l,{type:"submit",variant:"contained",children:"افزودن بیمار"})]})]})]}),e.jsxs(R,{open:Y,onClose:P,maxWidth:"md",fullWidth:!0,children:[e.jsx(W,{children:"ویرایش بیمار"}),e.jsxs(U,{methods:C,onSubmit:C.handleSubmit(ee),children:[e.jsx(_,{children:e.jsxs(s,{container:!0,spacing:2,sx:{mt:1},children:[e.jsx(s,{item:!0,xs:12,sm:6,children:e.jsx(r.Text,{name:"firstName",label:"نام"})}),e.jsx(s,{item:!0,xs:12,sm:6,children:e.jsx(r.Text,{name:"lastName",label:"نام خانوادگی"})}),e.jsx(s,{item:!0,xs:12,sm:6,children:e.jsx(r.Text,{name:"phone",label:"شماره تلفن"})}),e.jsx(s,{item:!0,xs:12,sm:6,children:e.jsx(r.Text,{name:"age",label:"سن",type:"number"})}),e.jsx(s,{item:!0,xs:12,sm:6,children:e.jsx(r.DatePicker,{name:"treatmentStartDate",label:"تاریخ شروع درمان"})}),e.jsx(s,{item:!0,xs:12,sm:6,children:e.jsx(r.DatePicker,{name:"nextVisitTime",label:"تایم ویزیت بعدی"})}),e.jsx(s,{item:!0,xs:12,children:e.jsx(r.Text,{name:"diagnosis",label:"تشخیص",multiline:!0,rows:2})}),e.jsx(s,{item:!0,xs:12,children:e.jsx(r.Text,{name:"treatment",label:"طرح درمان",multiline:!0,rows:2})}),e.jsx(s,{item:!0,xs:12,children:e.jsxs(r.Select,{name:"status",label:"وضعیت",children:[e.jsx(h,{value:"PENDING",children:"شروع درمان"}),e.jsx(h,{value:"IN_TREATMENT",children:"در حال درمان"}),e.jsx(h,{value:"COMPLETED",children:"اتمام درمان"}),e.jsx(h,{value:"CANCELLED",children:"متوقف شده"})]})}),e.jsx(s,{item:!0,xs:12,children:e.jsx(r.Text,{name:"notes",label:"یادداشت ها",multiline:!0,rows:3})}),e.jsxs(s,{item:!0,xs:12,children:[e.jsx(i,{variant:"h6",gutterBottom:!0,children:"آپلود تصاویر رادیولوژی"}),e.jsxs(B,{variant:"outlined",sx:{p:3,textAlign:"center",borderStyle:"dashed",bgcolor:t=>T(t.palette.grey[500],.08),cursor:"pointer","&:hover":{bgcolor:t=>T(t.palette.grey[500],.16)}},children:[e.jsxs(F,{spacing:1,alignItems:"center",children:[e.jsx(j,{icon:"solar:cloud-upload-bold",width:32}),e.jsx(i,{variant:"body2",children:"تصاویر رادیولوژی را اینجا بکشید یا کلیک کنید"}),e.jsx(i,{variant:"caption",color:"text.secondary",children:"PNG, JPG, JPEG (حداکثر ۱۰ مگابایت)"})]}),e.jsxs("label",{htmlFor:"radiology-upload-edit",children:[e.jsx("input",{type:"file",multiple:!0,accept:"image/*",style:{display:"none"},id:"radiology-upload-edit"}),e.jsx(l,{variant:"outlined",component:"span",sx:{mt:2},children:"انتخاب فایل"})]})]})]})]})}),e.jsxs(J,{children:[e.jsx(l,{onClick:P,children:"انصراف"}),e.jsx(l,{type:"submit",variant:"contained",children:"بروزرسانی"})]})]})]})]})})}const Ce={title:`پروستودونتیکس | ${H.site.name}`};function ct(){return e.jsxs(e.Fragment,{children:[e.jsx(me,{children:e.jsx("title",{children:Ce.title})}),e.jsx(De,{})]})}export{ct as default};
