import{h as G,r as F,dh as T,di as w,dA as t,p as c,j as i,G as N,dd as I,B as j,T as n,bf as L,S as q,d as E,cI as R,A as W,fF as _,bc as B}from"./index-BH9ijvcg.js";import{t as k,z as l}from"./zod-DcsM6yCN.js";import{u as z,a as D,F as o,C as O,i as P}from"./form-provider-b5GXhABL.js";import{a as M}from"./format-number-z67FV_-O.js";import"./image-CxkC95SJ.js";import"./editor-BUp8U2Vl.js";import{s as x}from"./schema-helper-DNntP_fU.js";import{C as A}from"./Card-CwEGl0A2.js";import{F as Q}from"./FormControlLabel-CVzZoZzb.js";import{L as V}from"./LoadingButton-jh3yI-IT.js";import{D as Z}from"./DialogTitle-BFho6EhL.js";import{D as H}from"./DialogContent-CtzR1nPJ.js";import{D as J}from"./dialogTitleClasses-CSmkbKpM.js";const K=l.object({avatarUrl:x.file({message:{required_error:"تصویر پروفایل الزامی است!"}}).optional(),name:l.string().min(1,{message:"نام الزامی است!"}),email:l.string().min(1,{message:"ایمیل الزامی است!"}).email({message:"ایمیل باید معتبر باشد!"}),phoneNumber:x.phoneNumber({isValidPhoneNumber:P}).optional(),country:x.objectOrNull({message:{required_error:"کشور الزامی است!"}}).optional(),address:l.string().optional(),company:l.string().optional(),state:l.string().optional(),city:l.string().optional(),role:l.string().min(1,{message:"نقش کاربری الزامی است!"}),zipCode:l.string().optional(),status:l.string().optional(),isVerified:l.boolean().optional()});function da({currentUser:a}){const p=G(),e=F.useMemo(()=>({status:(a==null?void 0:a.status)||"active",avatarUrl:(a==null?void 0:a.avatarUrl)||(a==null?void 0:a.avatar)||null,isVerified:(a==null?void 0:a.isVerified)!==void 0?a==null?void 0:a.isVerified:!0,name:(a==null?void 0:a.name)||(a==null?void 0:a.firstName)||"",email:(a==null?void 0:a.email)||"",phoneNumber:(a==null?void 0:a.phoneNumber)||(a==null?void 0:a.phone)||"",country:(a==null?void 0:a.country)||null,state:(a==null?void 0:a.state)||"",city:(a==null?void 0:a.city)||"",address:(a==null?void 0:a.address)||"",zipCode:(a==null?void 0:a.zipCode)||"",company:(a==null?void 0:a.company)||"",role:(a==null?void 0:a.role)||""}),[a]),h=z({mode:"onSubmit",resolver:k(K),defaultValues:e}),{reset:y,watch:f,control:v,handleSubmit:C,formState:{isSubmitting:S}}=h,s=f(),b=C(async m=>{try{a?(await T.put(w.user.update(a.id),m),t.success("اطلاعات کاربر با موفقیت به‌روزرسانی شد!")):(await T.post(w.user.list,m),t.success("کاربر جدید با موفقیت ایجاد شد!")),p.push(c.dashboard.user.list)}catch(g){console.error("Error saving user:",g),t.error(g.message||"خطا در ذخیره اطلاعات کاربر")}}),d=async()=>{if(a!=null&&a.id&&window.confirm("آیا از حذف این کاربر مطمئن هستید؟ این عمل غیرقابل بازگشت است."))try{await T.delete(w.user.delete(a.id)),t.success("کاربر با موفقیت حذف شد!"),p.push(c.dashboard.user.list)}catch(m){console.error("Error deleting user:",m),t.error(m.message||"خطا در حذف کاربر")}};return i.jsx(D,{methods:h,onSubmit:b,children:i.jsxs(N,{container:!0,spacing:3,children:[i.jsx(N,{xs:12,md:4,children:i.jsxs(A,{sx:{pt:10,pb:5,px:3},children:[a&&i.jsx(I,{color:s.status==="active"&&"success"||s.status==="banned"&&"error"||"warning",sx:{position:"absolute",top:24,right:24},children:s.status==="active"?"فعال":s.status==="banned"?"مسدود":s.status}),i.jsx(j,{sx:{mb:5},children:i.jsx(o.UploadAvatar,{name:"avatarUrl",maxSize:3145728,helperText:i.jsxs(n,{variant:"caption",sx:{mt:3,mx:"auto",display:"block",textAlign:"center",color:"text.disabled"},children:["فرمت‌های مجاز: *.jpeg, *.jpg, *.png, *.gif",i.jsx("br",{})," حداکثر حجم: ",M(3145728)]})})}),a&&i.jsx(Q,{labelPlacement:"start",control:i.jsx(O,{name:"status",control:v,render:({field:m})=>i.jsx(L,{...m,checked:m.value!=="active",onChange:g=>m.onChange(g.target.checked?"banned":"active")})}),label:i.jsxs(i.Fragment,{children:[i.jsx(n,{variant:"subtitle2",sx:{mb:.5},children:"مسدود کردن"}),i.jsx(n,{variant:"body2",sx:{color:"text.secondary"},children:"غیرفعال کردن حساب کاربری"})]}),sx:{mx:0,mb:3,width:1,justifyContent:"space-between"}}),i.jsx(o.Switch,{name:"isVerified",labelPlacement:"start",label:i.jsxs(i.Fragment,{children:[i.jsx(n,{variant:"subtitle2",sx:{mb:.5},children:"ایمیل تأیید شده"}),i.jsx(n,{variant:"body2",sx:{color:"text.secondary"},children:"غیرفعال کردن این گزینه به طور خودکار ایمیل تأیید برای کاربر ارسال می‌کند"})]}),sx:{mx:0,width:1,justifyContent:"space-between"}}),a&&i.jsx(q,{justifyContent:"center",alignItems:"center",sx:{mt:3},children:i.jsx(E,{variant:"soft",color:"error",onClick:d,children:"حذف کاربر"})})]})}),i.jsx(N,{xs:12,md:8,children:i.jsxs(A,{sx:{p:3},children:[i.jsxs(j,{rowGap:3,columnGap:2,display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(2, 1fr)"},children:[i.jsx(o.Text,{name:"name",label:"نام کامل"}),i.jsx(o.Text,{name:"email",label:"آدرس ایمیل"}),i.jsx(o.Phone,{name:"phoneNumber",label:"شماره تلفن"}),i.jsx(o.CountrySelect,{fullWidth:!0,name:"country",label:"کشور",placeholder:"انتخاب کشور"}),i.jsx(o.Text,{name:"state",label:"استان/منطقه"}),i.jsx(o.Text,{name:"city",label:"شهر"}),i.jsx(o.Text,{name:"address",label:"آدرس"}),i.jsx(o.Text,{name:"zipCode",label:"کد پستی"}),i.jsx(o.Text,{name:"company",label:"شرکت"})]}),i.jsx(q,{alignItems:"flex-end",sx:{mt:3},children:i.jsx(V,{type:"submit",variant:"contained",loading:S,children:a?"ذخیره تغییرات":"ایجاد کاربر"})})]})})]})})}const X=l.object({name:l.string().min(1,{message:"Name is required!"}),email:l.string().min(1,{message:"Email is required!"}).email({message:"Email must be a valid email address!"}),phoneNumber:x.phoneNumber({isValidPhoneNumber:P}),country:x.objectOrNull({message:{required_error:"Country is required!"}}),state:l.string().min(1,{message:"State is required!"}),city:l.string().min(1,{message:"City is required!"}),address:l.string().min(1,{message:"Address is required!"}),zipCode:l.string().min(1,{message:"Zip code is required!"}),company:l.string().min(1,{message:"Company is required!"}),role:l.string().min(1,{message:"Role is required!"}),status:l.string()});function na({currentUser:a,open:p,onClose:e}){const h=F.useMemo(()=>({name:(a==null?void 0:a.name)||"",email:(a==null?void 0:a.email)||"",phoneNumber:(a==null?void 0:a.phoneNumber)||"",address:(a==null?void 0:a.address)||"",country:(a==null?void 0:a.country)||"",state:(a==null?void 0:a.state)||"",city:(a==null?void 0:a.city)||"",zipCode:(a==null?void 0:a.zipCode)||"",status:a==null?void 0:a.status,company:(a==null?void 0:a.company)||"",role:(a==null?void 0:a.role)||""}),[a]),y=z({mode:"all",resolver:k(X),defaultValues:h}),{reset:f,handleSubmit:v,formState:{isSubmitting:C}}=y,S=v(async s=>{const b=new Promise(d=>setTimeout(d,1e3));try{f(),e(),t.promise(b,{loading:"Loading...",success:"Update success!",error:"Update error!"}),await b,console.info("DATA",s)}catch(d){console.error(d)}});return i.jsx(R,{fullWidth:!0,maxWidth:!1,open:p,onClose:e,PaperProps:{sx:{maxWidth:720}},children:i.jsxs(D,{methods:y,onSubmit:S,children:[i.jsx(Z,{children:"Quick Update"}),i.jsxs(H,{children:[i.jsx(W,{variant:"outlined",severity:"info",sx:{mb:3},children:"Account is waiting for confirmation"}),i.jsxs(j,{rowGap:3,columnGap:2,display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(2, 1fr)"},children:[i.jsx(o.Select,{name:"status",label:"Status",children:_.map(s=>i.jsx(B,{value:s.value,children:s.label},s.value))}),i.jsx(j,{sx:{display:{xs:"none",sm:"block"}}}),i.jsx(o.Text,{name:"name",label:"Full name"}),i.jsx(o.Text,{name:"email",label:"Email address"}),i.jsx(o.Phone,{name:"phoneNumber",label:"Phone number"}),i.jsx(o.CountrySelect,{fullWidth:!0,name:"country",label:"Country",placeholder:"Choose a country"}),i.jsx(o.Text,{name:"state",label:"State/region"}),i.jsx(o.Text,{name:"city",label:"City"}),i.jsx(o.Text,{name:"address",label:"Address"}),i.jsx(o.Text,{name:"zipCode",label:"Zip/code"}),i.jsx(o.Text,{name:"company",label:"Company"}),i.jsx(o.Text,{name:"role",label:"Role"})]})]}),i.jsxs(J,{children:[i.jsx(E,{variant:"outlined",onClick:e,children:"Cancel"}),i.jsx(V,{type:"submit",variant:"contained",loading:C,children:"Update"})]})]})})}export{na as U,da as a};
