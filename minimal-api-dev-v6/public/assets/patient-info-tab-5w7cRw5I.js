import{r as m,i as D,j as e,S as p,I as c,bc as x,B as u,T as v,d as k,dh as N,di as P,dA as C}from"./index-BH9ijvcg.js";import{u as w,a as A,F as l}from"./form-provider-b5GXhABL.js";import"./image-CxkC95SJ.js";import"./editor-BUp8U2Vl.js";import{C as b}from"./Card-CwEGl0A2.js";import{C as j}from"./CardHeader-BBcGHbnO.js";import{C as g}from"./CardContent-Bbr3YBl8.js";import{G as i}from"./Grid-vZ7eNkvH.js";import{F}from"./FormControlLabel-CVzZoZzb.js";import{C as H}from"./Checkbox-AhG6TMzi.js";import"./TextField-DgF_8CdY.js";import"./Select-fMsy-Lkz.js";import"./Menu-C7S9TApF.js";import"./InputLabel-OzeQogzC.js";import"./FormLabel-Cn8enUsF.js";import"./FormHelperText-CAGzEAMm.js";import"./FormControl-rHOkSiGz.js";import"./Rating-BeEojfFm.js";import"./visuallyHidden-Dan1xhjv.js";import"./Slider-nP-7N9E2.js";import"./RadioGroup-7Oa-Pyj3.js";import"./FormGroup-BEVR9nif.js";import"./index-DVaqB1VX.js";import"./countries-DSLisFCy.js";import"./Autocomplete-Crt2raTS.js";import"./Chip-CWilL4Fh.js";import"./country-select-DjjsCD_N.js";import"./upload-BVxhxEL6.js";import"./preview-multi-file--Yn4-mQ8.js";import"./format-number-z67FV_-O.js";import"./file-thumbnail-GgYbZAeX.js";import"./upload-avatar-Dm2-m_zx.js";import"./avatar-url-votlVkc-.js";import"./DatePicker-Br6g6rY4.js";import"./dialogTitleClasses-CSmkbKpM.js";import"./ListItem-Ch3K_gMr.js";import"./DialogContent-CtzR1nPJ.js";import"./MobileDateTimePicker-CzN3TBFx.js";import"./index-BVzUWzoE.js";const z=[{id:"diabetes",label:"دیابت",icon:"solar:medicine-bold-duotone"},{id:"hypertension",label:"فشار خون بالا",icon:"solar:heart-pulse-bold-duotone"},{id:"cardiovascularDisease",label:"بیماری‌های قلبی",icon:"solar:heart-pulse-2-bold-duotone"},{id:"rheumatoidArthritis",label:"آرتریت روماتوئید",icon:"solar:bone-bold-duotone"},{id:"osteoporosis",label:"استئوپروز",icon:"solar:bone-crack-bold-duotone"},{id:"hiv",label:"HIV/AIDS",icon:"solar:virus-bold-duotone"},{id:"hepatitis",label:"هپاتیت",icon:"solar:medical-kit-bold-duotone"},{id:"smoking",label:"مصرف سیگار",icon:"solar:cigarette-bold-duotone"},{id:"alcohol",label:"مصرف الکل",icon:"solar:wineglass-triangle-bold-duotone"},{id:"stress",label:"استرس",icon:"solar:emoji-funny-bold-duotone"},{id:"pregnancy",label:"بارداری",icon:"solar:heart-pulse-rounded-bold-duotone"}],L=[{value:"PENDING",label:"شروع درمان"},{value:"IN_TREATMENT",label:"در حال درمان"},{value:"COMPLETED",label:"اتمام درمان"},{value:"CANCELLED",label:"متوقف شده"}];function B({patient:s,onUpdate:t}){const{user:a}=D(),[n,f]=m.useState(!1),[h,S]=m.useState({}),o=m.useMemo(()=>({"& .MuiInputBase-input":{fontSize:"0.8125rem"},"& .MuiInputLabel-root":{fontSize:"0.8125rem"},"& .MuiSelect-select":{fontSize:"0.8125rem"},"& .MuiFormHelperText-root":{fontSize:"0.75rem"}}),[]),T=m.useMemo(()=>({paper:{"& .MuiMenuItem-root":{fontSize:"0.8125rem"}}}),[]),y=w({defaultValues:{firstName:(s==null?void 0:s.firstName)||"",lastName:(s==null?void 0:s.lastName)||"",phone:(s==null?void 0:s.phone)||"",age:(s==null?void 0:s.age)||"",gender:(s==null?void 0:s.gender)||"",diagnosis:(s==null?void 0:s.diagnosis)||"",treatment:(s==null?void 0:s.treatment)||"",status:(s==null?void 0:s.status)||"PENDING",notes:(s==null?void 0:s.notes)||"",nextVisitTime:s!=null&&s.nextVisitTime?new Date(s.nextVisitTime):null,treatmentStartDate:s!=null&&s.treatmentStartDate?new Date(s.treatmentStartDate):null}});m.useEffect(()=>{s!=null&&s.medicalHistory&&S(typeof s.medicalHistory=="string"?JSON.parse(s.medicalHistory):s.medicalHistory)},[s]);const E=(r,d)=>{S(M=>({...M,[r]:d}))},I=async r=>{try{f(!0),await N.put(`${P.patients}/${s.id}`,{...r,medicalHistory:h},{headers:{Authorization:`Bearer ${a==null?void 0:a.accessToken}`}}),C.success("اطلاعات بیمار با موفقیت ذخیره شد"),t==null||t()}catch(d){console.error("Error updating patient:",d),C.error("خطا در ذخیره اطلاعات")}finally{f(!1)}};return e.jsx(A,{methods:y,onSubmit:y.handleSubmit(I),children:e.jsxs(p,{spacing:3,children:[e.jsxs(b,{children:[e.jsx(j,{title:"اطلاعات پایه",avatar:e.jsx(c,{icon:"solar:user-id-bold-duotone",width:24})}),e.jsx(g,{children:e.jsxs(i,{container:!0,spacing:3,children:[e.jsx(i,{item:!0,xs:12,md:6,children:e.jsx(l.Text,{name:"firstName",label:"نام",sx:o})}),e.jsx(i,{item:!0,xs:12,md:6,children:e.jsx(l.Text,{name:"lastName",label:"نام خانوادگی",sx:o})}),e.jsx(i,{item:!0,xs:12,md:6,children:e.jsx(l.Text,{name:"phone",label:"شماره تماس",sx:o})}),e.jsx(i,{item:!0,xs:12,md:6,children:e.jsx(l.Text,{name:"age",label:"سن",type:"number",sx:o})}),e.jsx(i,{item:!0,xs:12,md:6,children:e.jsxs(l.Select,{name:"gender",label:"جنسیت",sx:o,slotProps:T,children:[e.jsx(x,{value:"MALE",children:"مرد"}),e.jsx(x,{value:"FEMALE",children:"زن"}),e.jsx(x,{value:"OTHER",children:"سایر"})]})}),e.jsx(i,{item:!0,xs:12,md:6,children:e.jsx(l.DatePicker,{name:"treatmentStartDate",label:"تاریخ شروع درمان",slotProps:{textField:{sx:o}}})}),e.jsx(i,{item:!0,xs:12,md:6,children:e.jsx(l.DatePicker,{name:"nextVisitTime",label:"ویزیت بعدی",slotProps:{textField:{sx:o}}})}),e.jsx(i,{item:!0,xs:12,md:6,children:e.jsx(l.Select,{name:"status",label:"وضعیت",sx:o,slotProps:T,children:L.map(r=>e.jsx(x,{value:r.value,children:r.label},r.value))})})]})})]}),e.jsxs(b,{children:[e.jsx(j,{title:"بیماری‌های زمینه‌ای و سابقه پزشکی",subheader:"بیماری‌های سیستمیک که می‌توانند بر وضعیت پریودونشیال تأثیر بگذارند",avatar:e.jsx(c,{icon:"solar:health-bold-duotone",width:24})}),e.jsxs(g,{children:[e.jsx(i,{container:!0,spacing:1,children:z.map(r=>e.jsx(i,{item:!0,xs:12,sm:6,md:4,children:e.jsx(F,{control:e.jsx(H,{checked:h[r.id]||!1,onChange:d=>E(r.id,d.target.checked),size:"small"}),label:e.jsxs(u,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(c,{icon:r.icon,width:18}),e.jsx(v,{variant:"body2",sx:{fontSize:"0.875rem"},children:r.label})]}),sx:{margin:0,padding:"4px 8px","& .MuiFormControlLabel-label":{marginLeft:"4px"}}})},r.id))}),h.smoking&&e.jsxs(u,{sx:{mt:3},children:[e.jsx(v,{variant:"subtitle2",gutterBottom:!0,children:"اطلاعات تکمیلی سیگار:"}),e.jsx(i,{container:!0,spacing:2,children:e.jsx(i,{item:!0,xs:12,md:6,children:e.jsx(l.Text,{name:"smokingPackYears",label:"تعداد پاکت-سال (Pack-Years)",type:"number",helperText:"تعداد پاکت در روز × تعداد سال",sx:o})})})]}),e.jsx(u,{sx:{mt:3},children:e.jsx(l.Text,{name:"otherDiseases",label:"سایر بیماری‌ها",multiline:!0,rows:2,placeholder:"سایر بیماری‌های زمینه‌ای را وارد کنید...",sx:o})})]})]}),e.jsxs(b,{children:[e.jsx(j,{title:"اطلاعات بالینی",avatar:e.jsx(c,{icon:"solar:clipboard-text-bold-duotone",width:24})}),e.jsx(g,{children:e.jsxs(p,{spacing:3,children:[e.jsx(l.Text,{name:"diagnosis",label:"تشخیص",multiline:!0,rows:3,sx:o}),e.jsx(l.Text,{name:"treatment",label:"طرح درمان",multiline:!0,rows:3,sx:o}),e.jsx(l.Text,{name:"notes",label:"یادداشت‌ها",multiline:!0,rows:4,sx:o})]})})]}),e.jsx(u,{sx:{display:"flex",justifyContent:"flex-end",gap:2},children:e.jsx(k,{type:"submit",variant:"contained",size:"large",disabled:n,startIcon:e.jsx(c,{icon:"solar:diskette-bold-duotone"}),children:n?"در حال ذخیره...":"ذخیره اطلاعات"})})]})})}const Ce=m.memo(B,(s,t)=>{var a,n;return((a=s.patient)==null?void 0:a.id)===((n=t.patient)==null?void 0:n.id)&&s.onUpdate===t.onUpdate});export{Ce as PatientInfoTab};
