import{b9 as U,j as e,S as v,I as m,B as b,aK as Z,ef as J,L as Q,p as f,R as V,eX as N,o as O,dl as _,bb as $,bc as T,h as z,r as c,d as B,dm as Y,dn as ee,aB as I,T as C,n as te,c9 as se,be as ae,cV as ne,dp as L,ar as oe,az as re,dq as ie,k as le,dr as G,eZ as ce,fo as A,fl as de,fp as pe,fq as he,e5 as xe,dx as E,e$ as me,H as ue,C as be}from"./index-BSItzkt3.js";import{E as je}from"./empty-content-Cx4hswZg.js";import{C as ge}from"./custom-breadcrumbs-u_kfWYpE.js";import{b as q}from"./format-number-BVcmMM5V.js";import{I as P}from"./image-BuqYs7tq.js";import{C as ve}from"./Card-BqWDE3fr.js";import{P as fe,p as ye}from"./Pagination-DCxMl0QM.js";import{A as H}from"./Autocomplete-B4c-hVbi.js";import{T as K}from"./TextField-DpdcsLRb.js";import{C as Ce}from"./country-select-B4qFdROS.js";import{D as W}from"./DatePicker-BK0jorBV.js";import{C as k}from"./Chip-CHY_XJWs.js";import{F as Se}from"./FormControlLabel-CtXEP1QR.js";import{C as ke}from"./Checkbox-p5PKnry8.js";import{F as De,a as D,c as w}from"./filters-result-CMxzGTKR.js";import"./tour-new-edit-form-DiOip6sn.js";import"./html-to-markdown-CuRjBHl-.js";import"./LastPage-DHcM-itg.js";import"./Select-QPCMlUZ4.js";import"./Menu-Cy0n4kRw.js";import"./InputLabel-DqZ4yv4U.js";import"./FormLabel-Dg62SF9b.js";import"./FormHelperText-CBXzj8d7.js";import"./FormControl-1z33WGqh.js";import"./countries-DSLisFCy.js";import"./index-b5NUrSMh.js";import"./visuallyHidden-Dan1xhjv.js";import"./dialogTitleClasses-BJYaWiXv.js";import"./ListItem-Doeuyi4X.js";import"./DialogContent-CPx_wcNJ.js";import"./zod-BOXuI70n.js";import"./form-provider-IFaCVrX4.js";import"./Rating-LRaLudfA.js";import"./editor-cOR4tKCy.js";import"./index-DC_o48Ax.js";import"./Slider-B4qW6LuH.js";import"./RadioGroup-DuXlXr3g.js";import"./FormGroup-DIAu_15X.js";import"./upload-C5NUn5Ko.js";import"./preview-multi-file-C1SdoyfF.js";import"./file-thumbnail-J0C6dV__.js";import"./upload-avatar-DTAGrxFf.js";import"./avatar-url-S8pB8DFh.js";import"./MobileDateTimePicker-Baldv5MM.js";import"./schema-helper-DeS_g_Vm.js";import"./CardHeader-CavtfEuu.js";import"./LoadingButton-HyVDRRh6.js";function we({tour:t,onView:d,onEdit:p,onDelete:s}){const n=U(),r=e.jsxs(v,{direction:"row",alignItems:"center",sx:{top:8,right:8,zIndex:9,borderRadius:1,position:"absolute",p:"2px 6px 2px 4px",typography:"subtitle2",bgcolor:"warning.lighter"},children:[e.jsx(m,{icon:"eva:star-fill",sx:{color:"warning.main",mr:.25}})," ",t.ratingNumber]}),o=e.jsxs(v,{direction:"row",alignItems:"center",sx:{top:8,left:8,zIndex:9,borderRadius:1,bgcolor:"grey.800",position:"absolute",p:"2px 6px 2px 4px",color:"common.white",typography:"subtitle2"},children:[!!t.priceSale&&e.jsx(b,{component:"span",sx:{color:"grey.500",mr:.25,textDecoration:"line-through"},children:q(t.priceSale)}),q(t.price)]}),a=e.jsxs(b,{gap:.5,display:"flex",sx:{p:1},children:[e.jsxs(b,{flexGrow:1,sx:{position:"relative"},children:[o,r,e.jsx(P,{alt:t.images[0],src:t.images[0],sx:{width:1,height:164,borderRadius:1}})]}),e.jsxs(b,{gap:.5,display:"flex",flexDirection:"column",children:[e.jsx(P,{alt:t.images[1],src:t.images[1],ratio:"1/1",sx:{borderRadius:1,width:80,height:80}}),e.jsx(P,{alt:t.images[2],src:t.images[2],ratio:"1/1",sx:{borderRadius:1,width:80,height:80}})]})]}),h=e.jsx(Z,{sx:{p:l=>l.spacing(2.5,2.5,2,2.5)},primary:`Posted date: ${J(t.createdAt)}`,secondary:e.jsx(Q,{component:V,href:f.dashboard.tour.details(t.id),color:"inherit",children:t.name}),primaryTypographyProps:{typography:"caption",color:"text.disabled"},secondaryTypographyProps:{mt:1,noWrap:!0,component:"span",color:"text.primary",typography:"subtitle1"}}),x=e.jsxs(v,{spacing:1.5,sx:{position:"relative",p:l=>l.spacing(0,2.5,2.5,2.5)},children:[e.jsx(O,{onClick:n.onOpen,sx:{position:"absolute",bottom:20,right:8},children:e.jsx(m,{icon:"eva:more-vertical-fill"})}),[{icon:e.jsx(m,{icon:"mingcute:location-fill",sx:{color:"error.main"}}),label:t.destination},{icon:e.jsx(m,{icon:"solar:clock-circle-bold",sx:{color:"info.main"}}),label:N(t.available.startDate,t.available.endDate)},{icon:e.jsx(m,{icon:"solar:users-group-rounded-bold",sx:{color:"primary.main"}}),label:`${t.bookers.length} Booked`}].map(l=>e.jsxs(v,{spacing:1,direction:"row",alignItems:"center",sx:{typography:"body2"},children:[l.icon,l.label]},l.label))]});return e.jsxs(e.Fragment,{children:[e.jsxs(ve,{children:[a,h,x]}),e.jsx(_,{open:n.open,anchorEl:n.anchorEl,onClose:n.onClose,slotProps:{arrow:{placement:"right-top"}},children:e.jsxs($,{children:[e.jsxs(T,{onClick:()=>{n.onClose(),d()},children:[e.jsx(m,{icon:"solar:eye-bold"}),"View"]}),e.jsxs(T,{onClick:()=>{n.onClose(),p()},children:[e.jsx(m,{icon:"solar:pen-bold"}),"Edit"]}),e.jsxs(T,{onClick:()=>{n.onClose(),s()},sx:{color:"error.main"},children:[e.jsx(m,{icon:"solar:trash-bin-trash-bold"}),"Delete"]})]})})]})}function Te({tours:t}){const d=z(),p=c.useCallback(r=>{d.push(f.dashboard.tour.details(r))},[d]),s=c.useCallback(r=>{d.push(f.dashboard.tour.edit(r))},[d]),n=c.useCallback(r=>{console.info("DELETE",r)},[]);return e.jsxs(e.Fragment,{children:[e.jsx(b,{gap:3,display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(2, 1fr)",md:"repeat(3, 1fr)"},children:t.map(r=>e.jsx(we,{tour:r,onView:()=>p(r.id),onEdit:()=>s(r.id),onDelete:()=>n(r.id)},r.id))}),t.length>8&&e.jsx(fe,{count:8,sx:{mt:{xs:5,md:8},[`& .${ye.ul}`]:{justifyContent:"center"}}})]})}function Ie({sort:t,onSort:d,sortOptions:p}){const s=U();return e.jsxs(e.Fragment,{children:[e.jsxs(B,{disableRipple:!0,color:"inherit",onClick:s.onOpen,endIcon:e.jsx(m,{icon:s.open?"eva:arrow-ios-upward-fill":"eva:arrow-ios-downward-fill"}),sx:{fontWeight:"fontWeightSemiBold"},children:["Sort by:",e.jsx(b,{component:"span",sx:{ml:.5,fontWeight:"fontWeightBold",textTransform:"capitalize"},children:t})]}),e.jsx(_,{open:s.open,anchorEl:s.anchorEl,onClose:s.onClose,children:e.jsx($,{children:p.map(n=>e.jsx(T,{selected:n.value===t,onClick:()=>{s.onClose(),d(n.value)},children:n.label},n.value))})})]})}function Re({search:t,onSearch:d}){const p=z(),{state:s}=t,n=o=>{p.push(f.dashboard.tour.details(o))},r=o=>{if(s.query&&o.key==="Enter"){const a=s.results.filter(h=>h.name===s.query)[0];n(a.id)}};return e.jsx(H,{sx:{width:{xs:1,sm:260}},autoHighlight:!0,popupIcon:null,options:s.results,onInputChange:(o,a)=>d(a),getOptionLabel:o=>o.name,noOptionsText:e.jsx(ae,{query:s.query}),isOptionEqualToValue:(o,a)=>o.id===a.id,slotProps:{popper:{placement:"bottom-start",sx:{minWidth:320}},paper:{sx:{[` .${se.option}`]:{pl:.75}}}},renderInput:o=>e.jsx(K,{...o,placeholder:"Search...",onKeyUp:r,InputProps:{...o.InputProps,startAdornment:e.jsx(te,{position:"start",children:e.jsx(m,{icon:"eva:search-fill",sx:{ml:1,color:"text.disabled"}})})}}),renderOption:(o,a,{inputValue:h})=>{const x=Y(a.name,h),l=ee(a.name,x);return c.createElement(b,{component:"li",...o,onClick:()=>n(a.id),key:a.id},e.jsx(I,{alt:a.name,src:a.images[0],variant:"rounded",sx:{mr:1.5,width:48,height:48,flexShrink:0,borderRadius:1}},a.id),e.jsx("div",{children:l.map((j,S)=>e.jsx(C,{component:"span",color:j.highlight?"primary":"textPrimary",sx:{typography:"body2",fontWeight:j.highlight?"fontWeightSemiBold":"fontWeightMedium"},children:j.text},S))},h))}})}function Fe({open:t,onOpen:d,onClose:p,filters:s,options:n,canReset:r,dateError:o}){const a=c.useCallback(i=>{const u=s.state.services.includes(i)?s.state.services.filter(y=>y!==i):[...s.state.services,i];s.setState({services:u})},[s]),h=c.useCallback(i=>{s.setState({startDate:i})},[s]),x=c.useCallback(i=>{s.setState({endDate:i})},[s]),l=c.useCallback(i=>{s.setState({destination:i})},[s]),j=c.useCallback(i=>{s.setState({tourGuides:i})},[s]),S=e.jsxs(e.Fragment,{children:[e.jsxs(b,{display:"flex",alignItems:"center",sx:{py:2,pr:1,pl:2.5},children:[e.jsx(C,{variant:"h6",sx:{flexGrow:1},children:"Filters"}),e.jsx(ne,{title:"Reset",children:e.jsx(O,{onClick:s.onResetState,children:e.jsx(L,{color:"error",variant:"dot",invisible:!r,children:e.jsx(m,{icon:"solar:restart-bold"})})})}),e.jsx(O,{onClick:p,children:e.jsx(m,{icon:"mingcute:close-line"})})]}),e.jsx(oe,{sx:{borderStyle:"dashed"}})]}),g=e.jsxs(b,{display:"flex",flexDirection:"column",children:[e.jsx(C,{variant:"subtitle2",sx:{mb:1.5},children:"Durations"}),e.jsx(W,{label:"Start date",value:s.state.startDate,onChange:h,sx:{mb:2.5}}),e.jsx(W,{label:"End date",value:s.state.endDate,onChange:x,slotProps:{textField:{error:o,helperText:o?"End date must be later than start date":null}}})]}),R=e.jsxs(b,{display:"flex",flexDirection:"column",children:[e.jsx(C,{variant:"subtitle2",sx:{mb:1.5},children:"Destination"}),e.jsx(Ce,{id:"multiple-destinations",multiple:!0,fullWidth:!0,placeholder:s.state.destination.length?"+ Destination":"Select Destination",value:s.state.destination,onChange:(i,u)=>l(u)})]}),F=e.jsxs(b,{display:"flex",flexDirection:"column",children:[e.jsx(C,{variant:"subtitle2",sx:{mb:1.5},children:"Tour guide"}),e.jsx(H,{multiple:!0,disableCloseOnSelect:!0,options:n.tourGuides,value:s.state.tourGuides,onChange:(i,u)=>j(u),getOptionLabel:i=>i.name,renderInput:i=>e.jsx(K,{placeholder:"Select Tour Guides",...i}),renderOption:(i,u)=>c.createElement("li",{...i,key:u.id},e.jsx(I,{alt:u.avatarUrl,src:u.avatarUrl,sx:{mr:1,width:24,height:24,flexShrink:0}},u.id),u.name),renderTags:(i,u)=>i.map((y,X)=>c.createElement(k,{...u({index:X}),key:y.id,size:"small",variant:"soft",label:y.name,avatar:e.jsx(I,{alt:y.name,src:y.avatarUrl})}))})]}),M=e.jsxs(b,{display:"flex",flexDirection:"column",children:[e.jsx(C,{variant:"subtitle2",sx:{mb:1},children:"Services"}),n.services.map(i=>e.jsx(Se,{control:e.jsx(ke,{checked:s.state.services.includes(i),onClick:()=>a(i)}),label:i},i))]});return e.jsxs(e.Fragment,{children:[e.jsx(B,{disableRipple:!0,color:"inherit",endIcon:e.jsx(L,{color:"error",variant:"dot",invisible:!r,children:e.jsx(m,{icon:"ic:round-filter-list"})}),onClick:d,children:"Filters"}),e.jsxs(re,{anchor:"right",open:t,onClose:p,slotProps:{backdrop:{invisible:!0}},PaperProps:{sx:{width:320}},children:[S,e.jsx(ie,{sx:{px:2.5,py:3},children:e.jsxs(v,{spacing:3,children:[g,R,F,M]})})]})]})}function Ee({filters:t,totalResults:d,sx:p}){const s=c.useCallback(a=>{const h=t.state.services.filter(x=>x!==a);t.setState({services:h})},[t]),n=c.useCallback(()=>{t.setState({startDate:null,endDate:null})},[t]),r=c.useCallback(a=>{const h=t.state.tourGuides.filter(x=>x.name!==a.name);t.setState({tourGuides:h})},[t]),o=c.useCallback(a=>{const h=t.state.destination.filter(x=>x!==a);t.setState({destination:h})},[t]);return e.jsxs(De,{totalResults:d,onReset:t.onResetState,sx:p,children:[e.jsx(D,{label:"Available:",isShow:!!(t.state.startDate&&t.state.endDate),children:e.jsx(k,{...w,label:N(t.state.startDate,t.state.endDate),onDelete:n})}),e.jsx(D,{label:"Services:",isShow:!!t.state.services.length,children:t.state.services.map(a=>c.createElement(k,{...w,key:a,label:a,onDelete:()=>s(a)}))}),e.jsx(D,{label:"Tour guide:",isShow:!!t.state.tourGuides.length,children:t.state.tourGuides.map(a=>c.createElement(k,{...w,key:a.id,avatar:e.jsx(I,{alt:a.name,src:a.avatarUrl}),label:a.name,onDelete:()=>r(a)}))}),e.jsx(D,{label:"Destination:",isShow:!!t.state.destination.length,children:t.state.destination.map(a=>c.createElement(k,{...w,key:a,label:a,onDelete:()=>o(a)}))})]})}function Pe(){const t=le(),[d,p]=c.useState("latest"),s=G({query:"",results:[]}),n=G({destination:[],tourGuides:[],services:[],startDate:null,endDate:null}),r=ce(n.state.startDate,n.state.endDate),o=Oe({inputData:A,filters:n.state,sortBy:d,dateError:r}),a=n.state.destination.length>0||n.state.tourGuides.length>0||n.state.services.length>0||!!n.state.startDate&&!!n.state.endDate,h=!o.length&&a,x=c.useCallback(g=>{p(g)},[]),l=c.useCallback(g=>{if(s.setState({query:g}),g){const R=A.filter(F=>F.name.toLowerCase().indexOf(s.state.query.toLowerCase())!==-1);s.setState({results:R})}},[s]),j=e.jsxs(v,{spacing:3,justifyContent:"space-between",alignItems:{xs:"flex-end",sm:"center"},direction:{xs:"column",sm:"row"},children:[e.jsx(Re,{search:s,onSearch:l}),e.jsxs(v,{direction:"row",spacing:1,flexShrink:0,children:[e.jsx(Fe,{filters:n,canReset:a,dateError:r,open:t.value,onOpen:t.onTrue,onClose:t.onFalse,options:{tourGuides:pe,services:de.map(g=>g.label)}}),e.jsx(Ie,{sort:d,onSort:x,sortOptions:he})]})]}),S=e.jsx(Ee,{filters:n,totalResults:o.length});return e.jsxs(xe,{children:[e.jsx(ge,{heading:"List",links:[{name:"Dashboard",href:f.dashboard.root},{name:"Tour",href:f.dashboard.tour.root},{name:"List"}],action:e.jsx(B,{component:V,href:f.dashboard.tour.new,variant:"contained",startIcon:e.jsx(m,{icon:"mingcute:add-line"}),children:"New Tour"}),sx:{mb:{xs:3,md:5}}}),e.jsxs(v,{spacing:2.5,sx:{mb:{xs:3,md:5}},children:[j,a&&S]}),h&&e.jsx(je,{filled:!0,sx:{py:10}}),e.jsx(Te,{tours:o})]})}const Oe=({inputData:t,filters:d,sortBy:p,dateError:s})=>{const{services:n,destination:r,startDate:o,endDate:a,tourGuides:h}=d,x=h.map(l=>l.id);return p==="latest"&&(t=E(t,["createdAt"],["desc"])),p==="oldest"&&(t=E(t,["createdAt"],["asc"])),p==="popular"&&(t=E(t,["totalViews"],["desc"])),r.length&&(t=t.filter(l=>r.includes(l.destination))),x.length&&(t=t.filter(l=>l.tourGuides.some(j=>x.includes(j.id)))),n.length&&(t=t.filter(l=>l.services.some(j=>n.includes(j)))),s||o&&a&&(t=t.filter(l=>me(o,l.available.startDate,l.available.endDate))),t},Be={title:`Tour list | Dashboard - ${be.site.name}`};function It(){return e.jsxs(e.Fragment,{children:[e.jsx(ue,{children:e.jsxs("title",{children:[" ",Be.title]})}),e.jsx(Pe,{})]})}export{It as default};
