import{dV as gs,r as I,bL as Pn,aU as Pe,bN as mn,by as Nn,bx as Dn,aS as wn,aT as Qo,j as T,aV as Ao,aW as hs,aY as Gn,aC as Ls,dL as ps,b as Un,cA as Tn,bR as xs,aX as Mo,cy as Ps,S as Ue,o as Oe,I as ke,cV as Sn,B as Te,T as $e,ar as ms,bc as Co,bd as Ss,cI as bs,d as bn,bo as ys,b7 as Fs}from"./index-BSItzkt3.js";import{P as ve}from"./index-b5NUrSMh.js";import{a as Cs}from"./color-preview-CjTlM1Ll.js";import{C as yn}from"./Card-BqWDE3fr.js";import{C as Fn}from"./CardContent-DE24Aeed.js";import{M as Cn}from"./Menu-Cy0n4kRw.js";import{D as Ms}from"./DialogTitle-D9mOMHyE.js";import{D as As}from"./DialogContent-CPx_wcNJ.js";import{T as ks}from"./TextField-DpdcsLRb.js";import{D as Ns}from"./dialogTitleClasses-BJYaWiXv.js";import{C as Ds}from"./ClickAwayListener-BBFqwi2L.js";function ws(et={}){const{autoHideDuration:nt=null,disableWindowBlurListener:Ot=!1,onClose:dt,open:pt,resumeHideDuration:ee}=et,$t=gs();I.useEffect(()=>{if(!pt)return;function xt(Nt){Nt.defaultPrevented||(Nt.key==="Escape"||Nt.key==="Esc")&&(dt==null||dt(Nt,"escapeKeyDown"))}return document.addEventListener("keydown",xt),()=>{document.removeEventListener("keydown",xt)}},[pt,dt]);const Vt=Pn((xt,Nt)=>{dt==null||dt(xt,Nt)}),oe=Pn(xt=>{!dt||xt==null||$t.start(xt,()=>{Vt(null,"timeout")})});I.useEffect(()=>(pt&&oe(nt),$t.clear),[pt,nt,oe,$t]);const F=xt=>{dt==null||dt(xt,"clickaway")},Wt=$t.clear,de=I.useCallback(()=>{nt!=null&&oe(ee??nt*.5)},[nt,ee,oe]),Le=xt=>Nt=>{const V=xt.onBlur;V==null||V(Nt),de()},me=xt=>Nt=>{const V=xt.onFocus;V==null||V(Nt),Wt()},kt=xt=>Nt=>{const V=xt.onMouseEnter;V==null||V(Nt),Wt()},to=xt=>Nt=>{const V=xt.onMouseLeave;V==null||V(Nt),de()};return I.useEffect(()=>{if(!Ot&&pt)return window.addEventListener("focus",de),window.addEventListener("blur",Wt),()=>{window.removeEventListener("focus",de),window.removeEventListener("blur",Wt)}},[Ot,pt,de,Wt]),{getRootProps:(xt={})=>{const Nt=Pe({},mn(et),mn(xt));return Pe({role:"presentation"},xt,Nt,{onBlur:Le(Nt),onFocus:me(Nt),onMouseEnter:kt(Nt),onMouseLeave:to(Nt)})},onClickAway:F}}function Gs(et){return Nn("MuiSnackbarContent",et)}Dn("MuiSnackbarContent",["root","message","action"]);const Us=["action","className","message","role"],Ts=et=>{const{classes:nt}=et;return Gn({root:["root"],action:["action"],message:["message"]},Gs,nt)},vs=Ao(Ls,{name:"MuiSnackbarContent",slot:"Root",overridesResolver:(et,nt)=>nt.root})(({theme:et})=>{const nt=et.palette.mode==="light"?.8:.98,Ot=ps(et.palette.background.default,nt);return Pe({},et.typography.body2,{color:et.vars?et.vars.palette.SnackbarContent.color:et.palette.getContrastText(Ot),backgroundColor:et.vars?et.vars.palette.SnackbarContent.bg:Ot,display:"flex",alignItems:"center",flexWrap:"wrap",padding:"6px 16px",borderRadius:(et.vars||et).shape.borderRadius,flexGrow:1,[et.breakpoints.up("sm")]:{flexGrow:"initial",minWidth:288}})}),Bs=Ao("div",{name:"MuiSnackbarContent",slot:"Message",overridesResolver:(et,nt)=>nt.message})({padding:"8px 0"}),Is=Ao("div",{name:"MuiSnackbarContent",slot:"Action",overridesResolver:(et,nt)=>nt.action})({display:"flex",alignItems:"center",marginLeft:"auto",paddingLeft:16,marginRight:-8}),Os=I.forwardRef(function(nt,Ot){const dt=wn({props:nt,name:"MuiSnackbarContent"}),{action:pt,className:ee,message:$t,role:Vt="alert"}=dt,oe=Qo(dt,Us),F=dt,Wt=Ts(F);return T.jsxs(vs,Pe({role:Vt,square:!0,elevation:6,className:hs(Wt.root,ee),ownerState:F,ref:Ot},oe,{children:[T.jsx(Bs,{className:Wt.message,ownerState:F,children:$t}),pt?T.jsx(Is,{className:Wt.action,ownerState:F,children:pt}):null]}))});function Ws(et){return Nn("MuiSnackbar",et)}Dn("MuiSnackbar",["root","anchorOriginTopCenter","anchorOriginBottomCenter","anchorOriginTopRight","anchorOriginBottomRight","anchorOriginTopLeft","anchorOriginBottomLeft"]);const js=["onEnter","onExited"],Es=["action","anchorOrigin","autoHideDuration","children","className","ClickAwayListenerProps","ContentProps","disableWindowBlurListener","message","onBlur","onClose","onFocus","onMouseEnter","onMouseLeave","open","resumeHideDuration","TransitionComponent","transitionDuration","TransitionProps"],Rs=et=>{const{classes:nt,anchorOrigin:Ot}=et,dt={root:["root",`anchorOrigin${Mo(Ot.vertical)}${Mo(Ot.horizontal)}`]};return Gn(dt,Ws,nt)},Mn=Ao("div",{name:"MuiSnackbar",slot:"Root",overridesResolver:(et,nt)=>{const{ownerState:Ot}=et;return[nt.root,nt[`anchorOrigin${Mo(Ot.anchorOrigin.vertical)}${Mo(Ot.anchorOrigin.horizontal)}`]]}})(({theme:et,ownerState:nt})=>{const Ot={left:"50%",right:"auto",transform:"translateX(-50%)"};return Pe({zIndex:(et.vars||et).zIndex.snackbar,position:"fixed",display:"flex",left:8,right:8,justifyContent:"center",alignItems:"center"},nt.anchorOrigin.vertical==="top"?{top:8}:{bottom:8},nt.anchorOrigin.horizontal==="left"&&{justifyContent:"flex-start"},nt.anchorOrigin.horizontal==="right"&&{justifyContent:"flex-end"},{[et.breakpoints.up("sm")]:Pe({},nt.anchorOrigin.vertical==="top"?{top:24}:{bottom:24},nt.anchorOrigin.horizontal==="center"&&Ot,nt.anchorOrigin.horizontal==="left"&&{left:24,right:"auto"},nt.anchorOrigin.horizontal==="right"&&{right:24,left:"auto"})})}),zs=I.forwardRef(function(nt,Ot){const dt=wn({props:nt,name:"MuiSnackbar"}),pt=Un(),ee={enter:pt.transitions.duration.enteringScreen,exit:pt.transitions.duration.leavingScreen},{action:$t,anchorOrigin:{vertical:Vt,horizontal:oe}={vertical:"bottom",horizontal:"left"},autoHideDuration:F=null,children:Wt,className:de,ClickAwayListenerProps:Le,ContentProps:me,disableWindowBlurListener:kt=!1,message:to,open:Ve,TransitionComponent:xt=Tn,transitionDuration:Nt=ee,TransitionProps:{onEnter:V,onExited:We}={}}=dt,y=Qo(dt.TransitionProps,js),ro=Qo(dt,Es),ae=Pe({},dt,{anchorOrigin:{vertical:Vt,horizontal:oe},autoHideDuration:F,disableWindowBlurListener:kt,TransitionComponent:xt,transitionDuration:Nt}),ko=Rs(ae),{getRootProps:No,onClickAway:lo}=ws(Pe({},ae)),[co,uo]=I.useState(!0),ue=xs({elementType:Mn,getSlotProps:No,externalForwardedProps:ro,ownerState:ae,additionalProps:{ref:Ot},className:[ko.root,de]}),fo=oo=>{uo(!0),We&&We(oo)},eo=(oo,N)=>{uo(!1),V&&V(oo,N)};return!Ve&&co?null:T.jsx(Ds,Pe({onClickAway:lo},Le,{children:T.jsx(Mn,Pe({},ue,{children:T.jsx(xt,Pe({appear:!0,in:Ve,timeout:Nt,direction:Vt==="top"?"down":"up",onEnter:eo,onExited:fo},y,{children:Wt||T.jsx(Os,Pe({message:to,action:$t},me))}))}))}))}),vn=Fs.forwardRef((et,nt)=>{const{children:Ot,in:dt,timeout:pt={enter:300,exit:300},...ee}=et;return T.jsx(Tn,{ref:nt,in:dt,timeout:pt,...ee,style:{transformOrigin:"center center"},children:Ot})});vn.displayName="ZoomTransition";const Zo={S:["S","s","Sella","sella"],N:["N","n","Nasion","nasion"],A:["A","a","Point A"],B:["B","b","Point B"],Pog:["Pog","pog","POG","pogonion","Pogonion"],"Pog'":["Pog′","Pog'","pog′","pog'","Soft tissue Pogonion","soft tissue pogonion"],"Pog`":["Pog`","pog`","Pog`","pog`","Soft tissue Pogonion","soft tissue pogonion"],Go:["Go","go","GO","gonion","Gonion"],Me:["Me","me","ME","menton","Menton"],"Me'":["Me′","Me'","me′","me'","Soft tissue Menton","soft tissue menton"],"Me`":["Me`","me`","Me`","me`","Soft tissue Menton","soft tissue menton"],Or:["Or","or","OR","orbitale","Orbitale"],Po:["Po","po","PO","porion","Porion"],Ar:["Ar","ar","AR","articulare","Articulare"],ANS:["ANS","ans","Anterior Nasal Spine"],PNS:["PNS","pns","posterior nasal spine","Posterior Nasal Spine"],Gn:["Gn","gn","GN","gnathion","Gnathion"],"Gn'":["Gn′","Gn'","gn′","gn'","GN'","GN","Soft tissue Gnathion","soft tissue gnathion"],"Gn`":["Gn`","gn`","Gn`","gn`","Soft tissue Gnathion","soft tissue gnathion"],"N'":["N′","N'","n′","n'","Nprime","nprime"],"N`":["N`","n`","N`","n`","Nprime","nprime"],UL:["UL","ul","UL′","UL'","ul′","ul'","Ls","ls","LS","Labiale Superius","labiale superius","Upper Lip"],"UL'":["UL′","UL'","ul′","ul'"],"UL`":["UL`","ul`","UL`","ul`"],LL:["LL","ll","LL′","LL'","ll′","ll'","Li","li","LI","Labiale Inferius","labiale inferius","Lower Lip"],"LL'":["LL′","LL'","ll′","ll'"],"LL`":["LL`","ll`","LL`","ll`"],U1:["U1","u1","upper_incisor","Upper Incisor"],U1A:["U1A","u1a","U1a","upper_incisor_apex","Upper_incisor_apex"],L1:["L1","l1","lower_incisor","Lower Incisor","lower","incisor"],L1A:["L1A","l1a","L1a","lower_incisor_apex","Lower_incisor_apex"],LMT:["LMT","lmt","lower_molar","Lower Molar","L6","l6"],UMT:["UMT","umt","upper_molar","Upper Molar","U6","u6"],G:["G","g","Glabella","glabella"],Sn:["Sn","sn","SN","Subnasale","subnasale"],Cm:["Cm","cm","CM","Columella","columella"],Pn:["Pn","pn","PN","Prn","prn","PRN","Pronasale","pronasale"],Co:["Co","co","CO","condyle","Condyle"],Ba:["Ba","ba","BA"],Pt:["Pt","pt","PT"],C:["C","c","Cervical","cervical","Cervical Point","cervical point","C point","c point"]},An=["#7eebff","#ff7497","#ffd33b","#74ffbb","#c78eff"],mt={N:{name:"Nasion (N)",description:"نقطه تقاطع خط ساجیتال میانی با استخوان بینی. نقطه مرجع مهم برای اندازه‌گیری‌های صورت و جمجمه."},"N'":{name:"Soft Nasion (N')",description:"نقطه نرم ناسیون در بافت نرم بینی. برای ارزیابی پروفایل نرم صورت و زیبایی استفاده می‌شود."},"N`":{name:"Soft Nasion (N`)",description:"نقطه نرم ناسیون در بافت نرم بینی. برای ارزیابی پروفایل نرم صورت و زیبایی استفاده می‌شود."},Nprime:{name:"Soft Nasion (N')",description:"نقطه نرم ناسیون در بافت نرم بینی. برای ارزیابی پروفایل نرم صورت و زیبایی استفاده می‌شود."},"N′":{name:"Soft Nasion (N′)",description:"نقطه نرم ناسیون در بافت نرم بینی. برای ارزیابی پروفایل نرم صورت و زیبایی استفاده می‌شود."},S:{name:"Sella (S)",description:"نقطه مرکزی حفره سلار (sella turcica) در استخوان اسفنوئید. نقطه مرجع اصلی برای آنالیزهای سفالومتری."},A:{name:"Point A (A)",description:"عمیق‌ترین نقطه قدامی ماگزیلا در خط میانی. نقطه مرجع برای ارزیابی موقعیت فک بالا."},B:{name:"Point B (B)",description:"عمیق‌ترین نقطه قدامی مندیبل در خط میانی. نقطه مرجع برای ارزیابی موقعیت فک پایین."},Pog:{name:"Pogonion (Pog)",description:"قسمت قدامی‌ترین نقطه چانه در نمای لترال. برای ارزیابی موقعیت قدامی-خلفی چانه استفاده می‌شود."},"Pog'":{name:"Soft Pogonion (Pog')",description:"قسمت قدامی‌ترین نقطه چانه در بافت نرم. برای ارزیابی پروفایل نرم صورت و زیبایی استفاده می‌شود."},"Pog`":{name:"Soft Pogonion (Pog`)",description:"قسمت قدامی‌ترین نقطه چانه در بافت نرم. برای ارزیابی پروفایل نرم صورت و زیبایی استفاده می‌شود."},Pogprime:{name:"Soft Pogonion (Pog')",description:"قسمت قدامی‌ترین نقطه چانه در بافت نرم. برای ارزیابی پروفایل نرم صورت و زیبایی استفاده می‌شود."},Go:{name:"Gonion (Go)",description:"نقطه زاویه‌ای مندیبل در محل تقاطع راموس و بادی مندیبل. برای محاسبه زاویه گونیال و طول مندیبل استفاده می‌شود."},Me:{name:"Menton (Me)",description:"پایین‌ترین نقطه چانه در نمای لترال. برای اندازه‌گیری ارتفاع صورت و موقعیت عمودی چانه استفاده می‌شود."},"Me'":{name:"Soft Menton (Me')",description:"پایین‌ترین نقطه چانه در بافت نرم. برای ارزیابی پروفایل نرم صورت و زیبایی استفاده می‌شود."},"Me`":{name:"Soft Menton (Me`)",description:"پایین‌ترین نقطه چانه در بافت نرم. برای ارزیابی پروفایل نرم صورت و زیبایی استفاده می‌شود."},MeSoft:{name:"Soft Menton (MeSoft)",description:"پایین‌ترین نقطه چانه در بافت نرم. برای ارزیابی پروفایل نرم صورت و زیبایی استفاده می‌شود."},Meprime:{name:"Soft Menton (Meprime)",description:"پایین‌ترین نقطه چانه در بافت نرم. برای ارزیابی پروفایل نرم صورت و زیبایی استفاده می‌شود."},"Me′":{name:"Soft Menton (Me′)",description:"پایین‌ترین نقطه چانه در بافت نرم. برای ارزیابی پروفایل نرم صورت و زیبایی استفاده می‌شود."},Or:{name:"Orbitale (Or)",description:"پایین‌ترین نقطه لبه تحتانی کاسه چشم. بخشی از خط فرانکفورت (Frankfort Horizontal) است."},Po:{name:"Porion (Po)",description:"بالاترین نقطه کانال گوش خارجی. بخشی از خط فرانکفورت (Frankfort Horizontal) است."},ANS:{name:"Anterior Nasal Spine (ANS)",description:"قدامی‌ترین نقطه نوک‌تیز در خط میانی فک بالا"},PNS:{name:"Posterior Nasal Spine (PNS)",description:"خلفی ترین نقطه نوک‌تیز در خط میانی فک بالا"},Gn:{name:"Gnathion (Gn)",description:"پایین‌ترین نقطه قسمت چانه در نمای لترال. برای ارزیابی موقعیت عمودی چانه استفاده می‌شود."},"Gn'":{name:"Soft Gnathion (Gn')",description:"پایین‌ترین نقطه قسمت چانه در بافت نرم. برای ارزیابی پروفایل نرم صورت و زیبایی استفاده می‌شود."},"Gn`":{name:"Soft Gnathion (Gn`)",description:"پایین‌ترین نقطه قسمت چانه در بافت نرم. برای ارزیابی پروفایل نرم صورت و زیبایی استفاده می‌شود."},"Gn′":{name:"Soft Gnathion (Gn′)",description:"پایین‌ترین نقطه قسمت چانه در بافت نرم. برای ارزیابی پروفایل نرم صورت و زیبایی استفاده می‌شود."},G:{name:"Glabella (G)",description:"برجسته‌ترین نقطه پیشانی در خط میانی. نقطه مرجع برای ارزیابی ارتفاع صورت و موقعیت پیشانی استفاده می‌شود."},g:{name:"Glabella (G)",description:"برجسته‌ترین نقطه پیشانی در خط میانی. نقطه مرجع برای ارزیابی ارتفاع صورت و موقعیت پیشانی استفاده می‌شود."},glabella:{name:"Glabella (G)",description:"برجسته‌ترین نقطه پیشانی در خط میانی. نقطه مرجع برای ارزیابی ارتفاع صورت و موقعیت پیشانی استفاده می‌شود."},Ar:{name:"Articulare (Ar)",description:"نقطه تقاطع کانتور خلفی راموس مندیبل با قاعده جمجمه. برای ارزیابی موقعیت مفصل گیجگاهی-فکی استفاده می‌شود."},U1:{name:"Upper Incisor (U1)",description:"نقطه لبه برش دندان اینسایزور فک بالا. برای ارزیابی موقعیت و زاویه دندان‌های پیشین بالا استفاده می‌شود."},u1:{name:"Upper Incisor (U1)",description:"نقطه لبه برش دندان اینسایزور فک بالا. برای ارزیابی موقعیت و زاویه دندان‌های پیشین بالا استفاده می‌شود."},upper_incisor:{name:"Upper Incisor (U1)",description:"نقطه لبه برش دندان اینسایزور فک بالا. برای ارزیابی موقعیت و زاویه دندان‌های پیشین بالا استفاده می‌شود."},"upper incisor":{name:"Upper Incisor (U1)",description:"نقطه لبه برش دندان اینسایزور فک بالا. برای ارزیابی موقعیت و زاویه دندان‌های پیشین بالا استفاده می‌شود."},L1:{name:"Lower Incisor (L1)",description:"نقطه لبه برش دندان اینسایزور فک پایین. برای ارزیابی موقعیت و زاویه دندان‌های پیشین پایین استفاده می‌شود."},l1:{name:"Lower Incisor (L1)",description:"نقطه لبه برش دندان اینسایزور فک پایین. برای ارزیابی موقعیت و زاویه دندان‌های پیشین پایین استفاده می‌شود."},lower_incisor:{name:"Lower Incisor (L1)",description:"نقطه لبه برش دندان اینسایزور فک پایین. برای ارزیابی موقعیت و زاویه دندان‌های پیشین پایین استفاده می‌شود."},"lower incisor":{name:"Lower Incisor (L1)",description:"نقطه لبه برش دندان اینسایزور فک پایین. برای ارزیابی موقعیت و زاویه دندان‌های پیشین پایین استفاده می‌شود."},UL:{name:"Upper Lip (UL)",description:"نقطه قدامی‌ترین قسمت لب بالا. برای ارزیابی موقعیت لب بالا و زیبایی صورت استفاده می‌شود."},"UL'":{name:"Soft Upper Lip (UL')",description:"نقطه قدامی‌ترین قسمت لب بالا در بافت نرم. برای ارزیابی پروفایل نرم صورت و زیبایی استفاده می‌شود."},"UL`":{name:"Soft Upper Lip (UL`)",description:"نقطه قدامی‌ترین قسمت لب بالا در بافت نرم. برای ارزیابی پروفایل نرم صورت و زیبایی استفاده می‌شود."},ULprime:{name:"Soft Upper Lip (UL')",description:"نقطه قدامی‌ترین قسمت لب بالا در بافت نرم. برای ارزیابی پروفایل نرم صورت و زیبایی استفاده می‌شود."},"UL′":{name:"Soft Upper Lip (UL′)",description:"نقطه قدامی‌ترین قسمت لب بالا در بافت نرم. برای ارزیابی پروفایل نرم صورت و زیبایی استفاده می‌شود."},LL:{name:"Lower Lip (LL)",description:"نقطه قدامی‌ترین قسمت لب پایین. برای ارزیابی موقعیت لب پایین و زیبایی صورت استفاده می‌شود."},"LL'":{name:"Soft Lower Lip (LL')",description:"نقطه قدامی‌ترین قسمت لب پایین در بافت نرم. برای ارزیابی پروفایل نرم صورت و زیبایی استفاده می‌شود."},"LL′":{name:"Soft Lower Lip (LL′)",description:"نقطه قدامی‌ترین قسمت لب پایین در بافت نرم. برای ارزیابی پروفایل نرم صورت و زیبایی استفاده می‌شود."},LLprime:{name:"Soft Lower Lip (LL')",description:"نقطه قدامی‌ترین قسمت لب پایین در بافت نرم. برای ارزیابی پروفایل نرم صورت و زیبایی استفاده می‌شود."},Sn:{name:"Subnasale (Sn)",description:"نقطه تقاطع ستون بینی با فیلتروم لب بالا. برای ارزیابی ارتفاع صورت و موقعیت بینی استفاده می‌شود."},Pn:{name:"Pronasale (Pn)",description:"قسمت قدامی‌ترین نقطه بینی. برای ارزیابی برجستگی بینی و زیبایی صورت استفاده می‌شود."},"Pog′":{name:"Soft Pogonion (Pog′)",description:"قسمت قدامی‌ترین نقطه چانه در بافت نرم. برای ارزیابی پروفایل نرم صورت استفاده می‌شود."},PogSoft:{name:"Soft Pogonion (PogSoft)",description:"قسمت قدامی‌ترین نقطه چانه در بافت نرم. برای ارزیابی پروفایل نرم صورت استفاده می‌شود."},U1A:{name:"Upper Incisor Apex (U1A)",description:"نقطه رأس (apex) دندان اینسایزور فک بالا. برای محاسبه زاویه و موقعیت دندان اینسایزور بالا استفاده می‌شود."},L1A:{name:"Lower Incisor Apex (L1A)",description:"نقطه رأس (apex) دندان اینسایزور فک پایین. برای محاسبه زاویه و موقعیت دندان اینسایزور پایین استفاده می‌شود."},U1T:{name:"Upper Incisor Tip (U1T)",description:"نوک دندان اینسایزور فک بالا. برای اندازه‌گیری طول و موقعیت دندان اینسایزور بالا استفاده می‌شود."},L1T:{name:"Lower Incisor Tip (L1T)",description:"نوک دندان اینسایزور فک پایین. برای اندازه‌گیری طول و موقعیت دندان اینسایزور پایین استفاده می‌شود."},LMT:{name:"Lower Molar Tip (LMT)",description:"نوک دندان مولر فک پایین. برای تعریف صفحه اکلوزال (Occlusal Plane) استفاده می‌شود."},Ba:{name:"Basion (Ba)",description:"پایین‌ترین نقطه قدامی سوراخ بزرگ پس‌سری (foramen magnum). برای ارزیابی موقعیت قاعده جمجمه استفاده می‌شود."},Pt:{name:"Pterygomaxillary Fissure (Pt)",description:"نقطه در شکاف پتریگوماکسیلاری. برای ارزیابی موقعیت خلفی ماگزیلا استفاده می‌شود."},pt:{name:"Pterygomaxillary Fissure (Pt)",description:"نقطه در شکاف پتریگوماکسیلاری. برای ارزیابی موقعیت خلفی ماگزیلا استفاده می‌شود."},PT:{name:"Pterygomaxillary Fissure (Pt)",description:"نقطه در شکاف پتریگوماکسیلاری. برای ارزیابی موقعیت خلفی ماگزیلا استفاده می‌شود."},pterygomaxillary:{name:"Pterygomaxillary Fissure (Pt)",description:"نقطه در شکاف پتریگوماکسیلاری. برای ارزیابی موقعیت خلفی ماگزیلا استفاده می‌شود."},Ptm:{name:"Pterygomaxillary Point (Ptm)",description:"نقطه پتریگوماکسیلاری. نقطه مرجع در شکاف پتریگوماکسیلاری که برای ارزیابی موقعیت خلفی ماگزیلا و محاسبه فاصله‌های خلفی استفاده می‌شود."},ptm:{name:"Pterygomaxillary Point (Ptm)",description:"نقطه پتریگوماکسیلاری. نقطه مرجع در شکاف پتریگوماکسیلاری که برای ارزیابی موقعیت خلفی ماگزیلا و محاسبه فاصله‌های خلفی استفاده می‌شود."},PTM:{name:"Pterygomaxillary Point (Ptm)",description:"نقطه پتریگوماکسیلاری. نقطه مرجع در شکاف پتریگوماکسیلاری که برای ارزیابی موقعیت خلفی ماگزیلا و محاسبه فاصله‌های خلفی استفاده می‌شود."},Bo:{name:"Bolton Point (Bo)",description:"بالاترین نقطه در انحنای رو به بالای فوسای رتروکندیلار استخوان پس‌سری. نقطه مرجع آناتومیک برای ارزیابی موقعیت قاعده جمجمه."},bo:{name:"Bolton Point (Bo)",description:"بالاترین نقطه در انحنای رو به بالای فوسای رتروکندیلار استخوان پس‌سری. نقطه مرجع آناتومیک برای ارزیابی موقعیت قاعده جمجمه."},BO:{name:"Bolton Point (Bo)",description:"بالاترین نقطه در انحنای رو به بالای فوسای رتروکندیلار استخوان پس‌سری. نقطه مرجع آناتومیک برای ارزیابی موقعیت قاعده جمجمه."},bolton:{name:"Bolton Point (Bo)",description:"بالاترین نقطه در انحنای رو به بالای فوسای رتروکندیلار استخوان پس‌سری. نقطه مرجع آناتومیک برای ارزیابی موقعیت قاعده جمجمه."},Bolton:{name:"Bolton Point (Bo)",description:"بالاترین نقطه در انحنای رو به بالای فوسای رتروکندیلار استخوان پس‌سری. نقطه مرجع آناتومیک برای ارزیابی موقعیت قاعده جمجمه."},UMT:{name:"Upper Molar Tip (UMT)",description:"تاج دندان مولر فک بالا. برای تعریف صفحه اکلوزال و ارزیابی موقعیت دندان‌های مولر بالا استفاده می‌شود."},umt:{name:"Upper Molar Tip (UMT)",description:"تاج دندان مولر فک بالا. برای تعریف صفحه اکلوزال و ارزیابی موقعیت دندان‌های مولر بالا استفاده می‌شود."},upper_molar:{name:"Upper Molar Tip (UMT)",description:"تاج دندان مولر فک بالا. برای تعریف صفحه اکلوزال و ارزیابی موقعیت دندان‌های مولر بالا استفاده می‌شود."},"Upper Molar":{name:"Upper Molar Tip (UMT)",description:"تاج دندان مولر فک بالا. برای تعریف صفحه اکلوزال و ارزیابی موقعیت دندان‌های مولر بالا استفاده می‌شود."},U6:{name:"Upper Molar (U6)",description:"تاج دندان مولر فک بالا. برای تعریف صفحه اکلوزال و ارزیابی موقعیت دندان‌های مولر بالا استفاده می‌شود."},u6:{name:"Upper Molar (U6)",description:"تاج دندان مولر فک بالا. برای تعریف صفحه اکلوزال و ارزیابی موقعیت دندان‌های مولر بالا استفاده می‌شود."},Cm:{name:"Columella (Cm)",description:"قسمت پایینی دیواره بینی (سپتوم) است که بین دو سوراخ بینی (Nostrils) قرار گرفته و بینی را به لب بالا وصل می‌کند."},cm:{name:"Columella (Cm)",description:"قسمت پایینی دیواره بینی (سپتوم) است که بین دو سوراخ بینی (Nostrils) قرار گرفته و بینی را به لب بالا وصل می‌کند."},CM:{name:"Columella (Cm)",description:"قسمت پایینی دیواره بینی (سپتوم) است که بین دو سوراخ بینی (Nostrils) قرار گرفته و بینی را به لب بالا وصل می‌کند."},columella:{name:"Columella (Cm)",description:"قسمت پایینی دیواره بینی (سپتوم) است که بین دو سوراخ بینی (Nostrils) قرار گرفته و بینی را به لب بالا وصل می‌کند."},Columella:{name:"Columella (Cm)",description:"قسمت پایینی دیواره بینی (سپتوم) است که بین دو سوراخ بینی (Nostrils) قرار گرفته و بینی را به لب بالا وصل می‌کند."},Co:{name:"Condylion (Co)",description:"بالاترین نقطه کندیل مندیبل. برای اندازه‌گیری طول مندیبل و موقعیت مفصل استفاده می‌شود."},LIA:{name:"Lower Incisor Apex (LIA)",description:"نقطه رأس (apex) دندان اینسایزور فک پایین. برای محاسبه زاویه و موقعیت دندان اینسایزور پایین استفاده می‌شود."},LIT:{name:"Lower Incisor Tip (LIT)",description:"نوک دندان اینسایزور فک پایین. برای اندازه‌گیری طول و موقعیت دندان اینسایزور پایین استفاده می‌شود."},UIA:{name:"Upper Incisor Apex (UIA)",description:"نقطه رأس (apex) دندان اینسایزور فک بالا. برای محاسبه زاویه و موقعیت دندان اینسایزور بالا استفاده می‌شود."},UIT:{name:"Upper Incisor Tip (UIT)",description:"نوک دندان اینسایزور فک بالا. برای اندازه‌گیری طول و موقعیت دندان اینسایزور بالا استفاده می‌شود."},C:{name:"Cervical Point (C)",description:"نقطه گردنی. نقطه مرجع در ناحیه گردن که برای ارزیابی پروفایل نرم صورت و محاسبه زوایای بافت نرم استفاده می‌شود."},c:{name:"Cervical Point (C)",description:"نقطه گردنی. نقطه مرجع در ناحیه گردن که برای ارزیابی پروفایل نرم صورت و محاسبه زوایای بافت نرم استفاده می‌شود."},Cervical:{name:"Cervical Point (C)",description:"نقطه گردنی. نقطه مرجع در ناحیه گردن که برای ارزیابی پروفایل نرم صورت و محاسبه زوایای بافت نرم استفاده می‌شود."},cervical:{name:"Cervical Point (C)",description:"نقطه گردنی. نقطه مرجع در ناحیه گردن که برای ارزیابی پروفایل نرم صورت و محاسبه زوایای بافت نرم استفاده می‌شود."},"Cervical Point":{name:"Cervical Point (C)",description:"نقطه گردنی. نقطه مرجع در ناحیه گردن که برای ارزیابی پروفایل نرم صورت و محاسبه زوایای بافت نرم استفاده می‌شود."},"cervical point":{name:"Cervical Point (C)",description:"نقطه گردنی. نقطه مرجع در ناحیه گردن که برای ارزیابی پروفایل نرم صورت و محاسبه زوایای بافت نرم استفاده می‌شود."},"C point":{name:"Cervical Point (C)",description:"نقطه گردنی. نقطه مرجع در ناحیه گردن که برای ارزیابی پروفایل نرم صورت و محاسبه زوایای بافت نرم استفاده می‌شود."},"c point":{name:"Cervical Point (C)",description:"نقطه گردنی. نقطه مرجع در ناحیه گردن که برای ارزیابی پروفایل نرم صورت و محاسبه زوایای بافت نرم استفاده می‌شود."},D:{name:"D Point (D)",description:"نقطه D. نقطه مرجع در آنالیزهای سفالومتری که برای محاسبه زوایا و فاصله‌های خاص استفاده می‌شود."},d:{name:"D Point (D)",description:"نقطه D. نقطه مرجع در آنالیزهای سفالومتری که برای محاسبه زوایا و فاصله‌های خاص استفاده می‌شود."},"D point":{name:"D Point (D)",description:"نقطه D. نقطه مرجع در آنالیزهای سفالومتری که برای محاسبه زوایا و فاصله‌های خاص استفاده می‌شود."},"d point":{name:"D Point (D)",description:"نقطه D. نقطه مرجع در آنالیزهای سفالومتری که برای محاسبه زوایا و فاصله‌های خاص استفاده می‌شود."},p1:{name:"Calibration Point 1 (p1)",description:"نقطه کالیبراسیون پایینی. این نقطه همراه با p2 برای تبدیل مقیاس پیکسل به میلی‌متر استفاده می‌شود. فاصله بین p1 و p2 معمولاً 1 سانتی‌متر (10 میلی‌متر) است."},p2:{name:"Calibration Point 2 (p2)",description:"نقطه کالیبراسیون بالایی. این نقطه همراه با p1 برای تبدیل مقیاس پیکسل به میلی‌متر استفاده می‌شود. فاصله بین p1 و p2 معمولاً 1 سانتی‌متر (10 میلی‌متر) است."}},Hs=["#00D9FF","#2196F3","#03A9F4","#00BCD4","#FF3B6D","#F44336","#E91E63","#9C27B0","#FF8A00","#FF9800","#FFC107","#FFD600","#00E676","#4CAF50","#8BC34A","#CDDC39","#B388FF","#673AB7","#607D8B","#9E9E9E"],_s={S:"#f32194",N:"#FF3B6D",A:"#03A9F4",B:"#00BCD4",Pog:"#4CAF50",Go:"#e116e7",Me:"#881aee",Or:"#FFC107",Po:"#ff6600",ANS:"#02ffb4",PNS:"#c1fe07",Gn:"#E91E63",Ar:"#9C27B0",G:"#FF6B9D",Glabella:"#FF6B9D",U1:"#FF3B6D",L1:"#d9ff18",UL:"#FF8A00",LL:"#FF9800",Sn:"#FF3B6D",Pn:"#00E676",Cm:"#B388FF",cm:"#B388FF",CM:"#B388FF",columella:"#B388FF",Columella:"#B388FF","Pog'":"#342070","Pog′":"#c9ff2d",PogSoft:"#342070",LIA:"#FF3B6D",LIT:"#38a1a0",UIA:"#ff3ba8",UIT:"#FF3B6D",LMT:"#FF6B6B",L6:"#FF6B6B",l6:"#FF6B6B",lower_molar:"#FF6B6B","Lower Molar":"#FF6B6B",UMT:"#FF8787",umt:"#FF8787",upper_molar:"#FF8787","Upper Molar":"#FF8787",U6:"#FF8787",u6:"#FF8787",Co:"#4ECDC4",condylion:"#4ECDC4",Ba:"#95E1D3",basion:"#95E1D3",Pt:"#F38181",pt:"#F38181",PT:"#F38181",pterygomaxillary:"#F38181",Ptm:"#FF8E8E",ptm:"#FF8E8E",PTM:"#FF8E8E",L1A:"#FF3B6D",L1T:"#FCBAD3",U1A:"#d59066",U1T:"#FFD3A5","N'":"#FF6B9D","N`":"#FF6B9D",Nprime:"#FF6B9D","Me'":"#C8A2C8","Me`":"#C8A2C8",MeSoft:"#C8A2C8",Meprime:"#C8A2C8",Bo:"#FFB74D",bolton:"#FFB74D",Bolton:"#FFB74D",Co1:"#4ECDC4",Co2:"#45B7B8",Co3:"#3DA3A4",C:"#FF6B9D",c:"#FF6B9D",Cervical:"#FF6B9D",cervical:"#FF6B9D","Cervical Point":"#FF6B9D","cervical point":"#FF6B9D","C point":"#FF6B9D","c point":"#FF6B9D",D:"#FF9800",d:"#FF9800","D point":"#FF9800","d point":"#FF9800",p1:"#ffffff",p2:"#ffffff",default:"#0ab0dd"},Bn=[{start:"S",end:"N",label:"S-N"},{start:"N",end:"A",label:"N-A"},{start:"S",end:"A",label:"S-A"},{start:"N",end:"B",label:"N-B"},{start:"N",end:"Pog",label:"N-Pog"},{start:"Go",end:"Me",label:"Go-Me (Mandibular Plane)"},{start:"Go",end:"Gn",label:"Go-Gn"},{start:"ANS",end:"PNS",label:"ANS-PNS"},{start:"Or",end:"Po",label:"Or-Po (Frankfort)"},{start:"U1",end:"L1",label:"U1-L1"},{start:"S",end:"U1",label:"S-U1 (for U1-SN)"},{start:"L1",end:"Me",label:"L1-Me (for IMPA & L1-MP)"},{start:"Or",end:"L1",label:"Or-L1 (for FMIA)"},{start:"Po",end:"L1",label:"Po-L1 (for FMIA)"}],qs={mcnamara:{exclude:[["Go","Me"],["Me","Go"]],include:[["N","A"],["N","Pog"],["S","Go"],["N","Me"],["Go","Gn"],["U1","A"],["L1","A"]]},jarabak:{exclude:[["Or","Po"],["Po","Or"],["ANS","PNS"],["PNS","ANS"]],include:[["S","N"],["Go","Me"],["Go","Gn"],["S","Ar"],["Ar","Go"],["Co","Gn"]]},softTissue:{exclude:[["S","N"],["N","S"],["Or","Po"],["Po","Or"],["ANS","PNS"],["PNS","ANS"],["N","A"],["A","N"],["N","B"],["B","N"],["N","Pog"],["Pog","N"],["S","A"],["A","S"],["S","B"],["B","S"],["Go","Me"],["Me","Go"],["Go","Gn"],["Gn","Go"],["Ar","Go"],["Go","Ar"],["S","Ar"],["Ar","S"],["S","Go"],["Go","S"],["U1","L1"],["L1","U1"],["U1","A"],["A","U1"],["L1","A"],["A","L1"],["S","U1"],["U1","S"],["L1","Me"],["Me","L1"],["Or","L1"],["L1","Or"],["Po","L1"],["L1","Po"],["Gn","Pt"],["Pt","Gn"],["Ba","Pt"],["Pt","Ba"],["N","Me"],["Me","N"],["Co","Gn"],["Gn","Co"],["L1","LMT"],["LMT","L1"],["A","B"],["B","A"],["L1A","L1"],["L1","L1A"]]}},Ys=(et,nt,Ot)=>{var pt;const dt=qs[Ot];return dt?(pt=dt.exclude)!=null&&pt.some(([ee,$t])=>et===ee&&nt===$t||et===$t&&nt===ee)?!1:dt.include?dt.include.some(([ee,$t])=>et===ee&&nt===$t||et===$t&&nt===ee):!0:!0},kn={steiner:[{start:"S",end:"N",label:"S-N",extend:!0},{start:"N",end:"A",label:"N-A"},{start:"N",end:"B",label:"N-B"},{start:"ANS",end:"PNS",label:"ANS-PNS",extend:!0}],ricketts:[{start:"Gn",end:"Pt",label:"Gn-Pt"},{start:"Ba",end:"Pt",label:"Ba-Pt"},{start:"N",end:"Pog",label:"N-Pog"},{start:"Go",end:"Me",label:"Go-Me",extend:!0},{start:"Or",end:"Po",label:"Or-Po"},{start:"ANS",end:"PNS",label:"ANS-PNS"},{start:"Pn",end:"Pog`",label:"E-line",extend:!0},{start:"L1",end:"LMT",label:"Occlusal Plane"}],mcnamara:[{start:"N",end:"A",label:"N-A"},{start:"N",end:"Pog",label:"N-Pog"},{start:"S",end:"Go",label:"S-Go"},{start:"N",end:"Me",label:"N-Me"},{start:"Go",end:"Gn",label:"Go-Gn"},{start:"U1",end:"A",label:"U1-A"},{start:"L1",end:"A",label:"L1-A"}],wits:[{start:"A",end:"B",label:"A-B"},{start:"L1",end:"LMT",label:"Occlusal Plane"}],tweed:[{start:"Or",end:"Po",label:"Or-Po (Frankfort)"},{start:"Go",end:"Me",label:"Go-Me (Mandibular Plane)"},{start:"L1A",end:"L1",label:"L1A-L1"}],jarabak:[{start:"S",end:"N",label:"S-N"},{start:"Go",end:"Me",label:"Go-Me"},{start:"Go",end:"Gn",label:"Go-Gn"},{start:"S",end:"Ar",label:"S-Ar"},{start:"Ar",end:"Go",label:"Ar-Go"},{start:"Co",end:"Gn",label:"Co-Gn"}],sassouni:[{start:"S",end:"N",label:"S-N"},{start:"Me",end:"Go",label:"Me-Go"},{start:"S",end:"Ar",label:"S-Ar"},{start:"Ar",end:"Go",label:"Ar-Go"},{start:"L1",end:"LMT",label:"Occlusal Plane"},{start:"ANS",end:"PNS",label:"ANS-PNS"}],all:Bn};function Xs({imageUrl:et,landmarks:nt,imageSize:Ot,onLandmarksChange:dt,showMeasurements:pt=!0,calibrationPoints:ee=null,showCoordinateSystem:$t=!1,readOnly:Vt=!1,viewMode:oe="normal",analysisType:F="all",measurements:Wt={},pixelToMmConversion:de=null}){const Le=I.useRef(null),me=I.useRef(null),kt=I.useRef(null),to=()=>{if(typeof window<"u"){const e=window.innerWidth;return Math.min(e-100,1200)*1.2}return 600},[Ve,xt]=I.useState(to()),Nt=Un(),[V,We]=I.useState(nt||{}),[y,ro]=I.useState(1),[ae,ko]=I.useState({x:0,y:0}),[No,lo]=I.useState(!1),[co,uo]=I.useState({x:0,y:0}),[ue,fo]=I.useState(!1),[eo,oo]=I.useState($t),N=Ps(Nt.breakpoints.down("sm")),[tn,$s]=I.useState(4),[Do,Vs]=I.useState(1),wo=N?tn/2.5:tn,In=N?Do/1:Do,Go=wo*y,st=In*y,[no,On]=I.useState("#FFFFFF"),[je,Uo]=I.useState("solid"),[To,Ks]=I.useState(!0),[so,Wn]=I.useState(!0),[pe,Js]=I.useState(!0),[r,vo]=I.useState(_s),[Bo,Zs]=I.useState(!0),[Ee,jn]=I.useState(!0),Be=I.useMemo(()=>{const e=new Map;return{getColorForLandmark:t=>{if(e.has(t))return e.get(t);if(!t||t==="default"||t==="vertex"){const a=r.default||"#00D9FF";return e.set(t,a),a}if(r[t])return e.set(t,r[t]),r[t];const U=[t,t.toUpperCase(),t.toLowerCase(),t.charAt(0).toUpperCase()+t.slice(1).toLowerCase(),t.replace(/'/g,"'"),t.replace(/′/g,"'"),t.replace(/'/g,"′")];for(const a of U)if(r[a])return e.set(t,r[a]),r[a];if(t==="G"||t==="g"){const a=r.G||r.Glabella||r.default||"#00D9FF";return e.set(t,a),a}if(t==="Pog`"||t==="Pog'"||t==="Pog′"){const a=r["Pog`"]||r["Pog'"]||r["Pog′"]||r.Pog||r.default||"#00D9FF";return e.set(t,a),a}if(t==="N`"||t==="N'"||t==="N′"){const a=r["N`"]||r["N'"]||r["N′"]||r.N||r.default||"#00D9FF";return e.set(t,a),a}if(t==="Me`"||t==="Me'"||t==="Me′"){const a=r["Me`"]||r["Me'"]||r["Me′"]||r.Me||r.default||"#00D9FF";return e.set(t,a),a}if(t==="Gn`"||t==="Gn'"||t==="Gn′"){const a=r["Gn`"]||r["Gn'"]||r["Gn′"]||r.Gn||r.default||"#00D9FF";return e.set(t,a),a}if(t==="UL`"||t==="UL'"||t==="UL′"){const a=r["UL`"]||r["UL'"]||r["UL′"]||r.UL||r.default||"#00D9FF";return e.set(t,a),a}if(t==="LL`"||t==="LL'"||t==="LL′"){const a=r["LL`"]||r["LL'"]||r["LL′"]||r.LL||r.default||"#00D9FF";return e.set(t,a),a}if(t==="Pt"||t==="pt"||t==="PT"){const a=r.Pt||r.pt||r.PT||r.Pterygoid||r.default||"#00D9FF";return e.set(t,a),a}const A=r.default||"#00D9FF";return e.set(t,A),A},cache:e}},[r]),[Ie,en]=I.useState(null),[Io,En]=I.useState(null),[Qs,Rn]=I.useState(null),[Se,zn]=I.useState(null),[ti,ei]=I.useState({});I.useRef(null);const Ke=I.useRef(null),go=I.useRef(V),on=I.useRef(null),ho=I.useRef(!1),[Hn,_n]=I.useState(!1),[oi,ni]=I.useState(""),[qn,si]=I.useState(!1),[Je,Yn]=I.useState([]),[Ze,Xn]=I.useState([]),[ii,ai]=I.useState(""),[_t,nn]=I.useState(null),[sn,Lo]=I.useState(null),[an,Oo]=I.useState(null),[$n,po]=I.useState(!1),[Wo,xo]=I.useState(null),[io,Po]=I.useState(""),[ri,jo]=I.useState({show:!1,text:"",x:0,y:0}),[Vn,Eo]=I.useState(!1),[Kn,Ro]=I.useState(null),[mo,zo]=I.useState(null),So=I.useRef({});I.useEffect(()=>{nt&&We(nt)},[nt]),I.useEffect(()=>{oo($t)},[$t]),I.useEffect(()=>{if(!et)return;const e=new Image;et.startsWith("data:")||(e.crossOrigin="anonymous");const i=()=>{if(kt.current&&e&&e.complete&&e.naturalHeight>0){const U=kt.current.getBoundingClientRect().width;if(U===0&&typeof window<"u"){const A=window.innerWidth,H=Math.min(A-100,1200)/e.width,q=e.height*H;xt(q);return}if(U>0){const A=U/e.width,a=e.height*A;xt(a)}}};return e.onload=()=>{if(me.current=e,fo(!0),kt.current){const U=kt.current.getBoundingClientRect().width;if(U>0){const A=U/e.width,a=e.height*A;xt(a)}else if(typeof window<"u"){const A=window.innerWidth,H=Math.min(A-100,1200)/e.width,q=e.height*H;xt(q)}}else if(typeof window<"u"){const t=window.innerWidth,A=Math.min(t-100,1200)/e.width,a=e.height*A;xt(a)}requestAnimationFrame(()=>{setTimeout(i,0)}),console.log("[AdvancedCephalometricVisualizer] Image loaded successfully:",`${et.substring(0,50)}...`)},e.onerror=t=>{console.error("[AdvancedCephalometricVisualizer] Error loading image:",t),console.error("[AdvancedCephalometricVisualizer] Failed URL:",`${et.substring(0,50)}...`),fo(!1)},e.src=et,window.addEventListener("resize",i),()=>{window.removeEventListener("resize",i)}},[et]),I.useLayoutEffect(()=>{if(ue&&me.current&&kt.current){const e=()=>{if(!kt.current||!me.current)return;const U=kt.current.getBoundingClientRect().width,A=me.current;if(U===0&&typeof window<"u"){const a=window.innerWidth,H=Math.min(a-100,1200);if(A&&A.complete&&A.naturalHeight>0){const q=H/A.width,v=A.height*q;xt(v)}return}if(A&&A.complete&&A.naturalHeight>0&&U>0){const a=U/A.width,H=A.height*a;xt(H)}};e();const i=new ResizeObserver(()=>{e()});return kt.current&&i.observe(kt.current),window.addEventListener("resize",e),()=>{i.disconnect(),window.removeEventListener("resize",e)}}},[ue]);const jt=I.useCallback((e,i)=>{for(const A of i)if(e[A])return e[A];const t=Object.keys(e);for(const A of i){const a=A.toLowerCase(),H=t.find(q=>q.toLowerCase()===a);if(H)return e[H]}const U={Or:["or","orbit","orbitale"],Po:["po","porion"],L1:["l1","lower","incisor","li","lower_incisor"],U1:["u1","upper","incisor","ui","upper_incisor"],Me:["me","menton"],Go:["go","gonion"],S:["s","sella"],N:["n","nasion"],A:["a","point_a","point a"],B:["b","point_b","point b"],Gn:["gn","gnathion"],Pog:["pog","pogonion"],ANS:["ans","anterior"],PNS:["pns","posterior"]};for(const A of i)if(U[A])for(const a of U[A]){const H=t.find(q=>q.toLowerCase().includes(a)||a.includes(q.toLowerCase()));if(H)return e[H]}return null},[]),Et=I.useCallback((e,i,t)=>{const U=Math.atan2(e.y-i.y,e.x-i.x);let a=(Math.atan2(t.y-i.y,t.x-i.x)-U)*(180/Math.PI);return a<0&&(a+=360),a>180&&(a=360-a),a},[]),Ho=I.useCallback((e,i)=>Math.atan2(i.y-e.y,i.x-e.x)*(180/Math.PI),[]),ne=I.useCallback((e,i,t,U)=>{const A=i.x-e.x,a=i.y-e.y,H=U.x-t.x,q=U.y-t.y,v=A*H+a*q,vt=Math.sqrt(A*A+a*a),Lt=Math.sqrt(H*H+q*q);if(vt===0||Lt===0)return 0;const Kt=v/(vt*Lt),rt=Math.max(-1,Math.min(1,Kt));let Xt=Math.acos(rt)*(180/Math.PI);return Xt>180&&(Xt=360-Xt),Xt},[]),Jn=I.useCallback(e=>{const i={},t=U=>Math.max(0,Math.min(180,U));try{const U=jt(e,["S","s","Sella","sella"]),A=jt(e,["N","n","Nasion","nasion"]),a=jt(e,["A","a"]),H=jt(e,["B","b"]),q=jt(e,["Or","or","OR","orbitale","Orbitale"]),v=jt(e,["Po","po","PO","porion","Porion"]),vt=jt(e,["Go","go","GO","gonion","Gonion"]),Lt=jt(e,["Me","me","ME","menton","Menton"]),Kt=jt(e,["Gn","gn","GN","gnathion","Gnathion"]),rt=jt(e,["U1","u1","upper_incisor","Upper Incisor"]),Xt=jt(e,["L1","l1","lower_incisor","Lower_incisor","lower incisor"]);if(U&&A&&a&&(i.SNA=Et(U,A,a)),U&&A&&H&&(i.SNB=Et(U,A,H)),i.SNA&&i.SNB&&(i.ANB=i.SNA-i.SNB),q&&v&&Lt&&vt&&(i.FMA=t(ne(Lt,vt,q,v))),U&&A&&vt&&Kt){const Qt=Ho(U,A),ao=Ho(vt,Kt);i.GoGnSN=Math.abs(Qt-ao)}const qt=jt(e,["U1A","u1a","U1a","upper_incisor_apex","Upper_incisor_apex"]);U&&A&&rt&&qt?i["U1-SN"]=ne(rt,qt,U,A):U&&A&&rt&&(i["U1-SN"]=Et(rt,A,U));const He=jt(e,["LIA","lia","Lia","L1A","l1a","L1a","lower_incisor_apex","Lower_incisor_apex","lower incisor apex"]),_e=jt(e,["LIT","lit","Lit","L1","l1","lower_incisor_tip","Lower_incisor_tip","lower incisor tip"]);if(vt&&Lt&&He&&_e)i.IMPA=t(ne(Lt,vt,He,_e));else if(vt&&Lt&&Xt){const Qt=jt(e,["L1A","l1a","L1a","LIA","lia","Lia","lower_incisor_apex","Lower_incisor_apex"]);Qt&&(i.IMPA=t(ne(vt,Lt,Qt,Xt)))}if(q&&v&&He&&_e)i.FMIA=t(ne(v,q,He,_e));else if(q&&v&&Xt){const Qt=jt(e,["L1A","l1a","L1a","LIA","lia","Lia","lower_incisor_apex","Lower_incisor_apex"]);Qt&&(i.FMIA=t(ne(q,v,Qt,Xt)))}i.IMPA?i["L1-MP"]=i.IMPA:vt&&Lt&&Xt&&(i["L1-MP"]=t(Et(Xt,Lt,vt)));const se=jt(e,["L1A","l1a","L1a","lower_incisor_apex","Lower_incisor_apex"]);rt&&qt&&Xt&&se&&(i.InterincisalAngle=ne(rt,qt,Xt,se));const qe=jt(e,["Ba","ba","BA","basion","Basion"]),Ye=jt(e,["Pt","pt","PT","pterygoid","Pterygoid"]);qe&&Ye&&Kt&&(i["Facial Axis"]=Et(Kt,Ye,qe));const fe=jt(e,["Pog","pog","POG","pogonion","Pogonion"]);A&&fe&&q&&v&&(i["Facial Depth"]=ne(A,fe,q,v));const re=jt(e,["LMT","lmt","lower_molar","Lower Molar","L6","l6"]),Xe=jt(e,["UMT","umt","upper_molar","Upper Molar","U6","u6"]);if(Xt&&re&&U&&A)if(Xe){const Qt={x:(re.x+Xe.x)/2,y:(re.y+Xe.y)/2};i["Occlusal Plane Angle"]=ne(Xt,Qt,U,A)}else i["Occlusal Plane Angle"]=ne(Xt,re,U,A);if(qe&&A&&U){const Qt=Et(qe,A,U);i["Cranial Deflection"]=typeof Qt=="number"?Math.round(Qt*10)/10:Qt}}catch(U){console.error("Error calculating measurements:",U)}return i},[jt,Et,Ho,ne]),xe=I.useMemo(()=>Object.keys(V).length>=3?Jn(V):{},[V]),s=I.useCallback(e=>{var Kt;const i=Le.current,t=me.current;if(!i||!t)return null;const U=(Kt=kt.current)==null?void 0:Kt.getBoundingClientRect();if(!U)return null;const A=U.width,a=U.height,H=Math.min(A/t.width,a/t.height)*y,q=t.width*H,v=t.height*H,vt=(A-q)/2+ae.x,Lt=(a-v)/2+ae.y;return{x:vt+e.x*H,y:Lt+e.y*H,scale:H}},[y,ae]),rn=(e,i)=>{var rt;const t=Le.current,U=me.current;if(!t||!U)return null;const A=(rt=kt.current)==null?void 0:rt.getBoundingClientRect();if(!A)return null;const a=A.width,H=A.height,q=Math.min(a/U.width,H/U.height)*y,v=U.width*q,vt=U.height*q,Lt=(a-v)/2+ae.x,Kt=(H-vt)/2+ae.y;return{x:(e-Lt)/q,y:(i-Kt)/q}},ln=e=>{if(!e)return null;if(mt[e])return e;const i=e.trim();if(i==="N`"||i==="N'"||i==="Nprime"||i==="N` "||i==="N' "||i==="Nprime "||i.toLowerCase()==="n`"||i.toLowerCase()==="n'"||i.toLowerCase()==="nprime"||i.toLowerCase()==="n`"||i.toLowerCase()==="n'"){if(mt["N`"])return"N`";if(mt["N'"])return"N'";if(mt.Nprime)return"Nprime"}if(i==="Me`"||i==="Me'"||i==="Me′"||i==="MeSoft"||i==="Meprime"||i==="Me` "||i==="Me' "||i==="Me′ "||i.toLowerCase()==="me`"||i.toLowerCase()==="me'"||i.toLowerCase()==="me′"||i.toLowerCase()==="mesoft"||i.toLowerCase()==="meprime"||i.toLowerCase()==="me`"||i.toLowerCase()==="me'"){if(mt["Me`"])return"Me`";if(mt["Me'"])return"Me'";if(mt["Me′"])return"Me′";if(mt.MeSoft)return"MeSoft";if(mt.Meprime)return"Meprime"}if(i==="Pog`"||i==="Pog'"||i==="Pog′"||i==="Pogprime"||i.toLowerCase()==="pog`"||i.toLowerCase()==="pog'"||i.toLowerCase()==="pog′"||i.toLowerCase()==="pogprime"){if(mt["Pog`"])return"Pog`";if(mt["Pog'"])return"Pog'";if(mt["Pog′"])return"Pog′";if(mt.Pogprime)return"Pogprime"}if(i==="Gn`"||i==="Gn'"||i==="Gn′"||i==="Gnprime"||i.toLowerCase()==="gn`"||i.toLowerCase()==="gn'"||i.toLowerCase()==="gn′"||i.toLowerCase()==="gnprime"){if(mt["Gn`"])return"Gn`";if(mt["Gn'"])return"Gn'";if(mt["Gn′"])return"Gn′"}if(i==="UL`"||i==="UL'"||i==="UL′"||i==="ULprime"||i.toLowerCase()==="ul`"||i.toLowerCase()==="ul'"||i.toLowerCase()==="ul′"||i.toLowerCase()==="ulprime"){if(mt["UL`"])return"UL`";if(mt["UL'"])return"UL'";if(mt["UL′"])return"UL′";if(mt.ULprime)return"ULprime"}if(i==="LL`"||i==="LL'"||i==="LL′"||i==="LLprime"||i.toLowerCase()==="ll`"||i.toLowerCase()==="ll'"||i.toLowerCase()==="ll′"||i.toLowerCase()==="llprime"){if(mt["LL`"])return"LL`";if(mt["LL'"])return"LL'";if(mt["LL′"])return"LL′";if(mt.LLprime)return"LLprime"}return e},bo=(e,i)=>{for(const[t,U]of Object.entries(V)){const A=s(U);if(!A)continue;if(Math.sqrt((A.x-e)**2+(A.y-i)**2)<=Go+5)return t}return null},Re=I.useCallback(()=>{var gn,hn,Ln,pn;const e=Le.current,i=me.current;if(!e)return;const t=e.getContext("2d"),U=(gn=kt.current)==null?void 0:gn.getBoundingClientRect();if(!U)return;const A=U,a=A.height||e.height,H=A.width||e.width,q=new Map,v=G=>{const Y=Math.round(G.x/5)*5,_=Math.round(G.y/5)*5;return`${Y},${_}`},vt=(G,x="#FFD700")=>{t.font=`bold ${G*y}px Arial`,t.textAlign="center",t.textBaseline="middle",t.fillStyle=x},Lt=(G,x,Y,_,wt="#FFD700")=>{vt(_,wt),t.strokeStyle="rgba(0, 0, 0, 0.7)";const W=N?1:2;t.lineWidth=W*y,t.strokeText(G,x,Y),t.fillText(G,x,Y)},Kt=(G,x,Y,_,wt,W="#FFD700")=>{t.save(),t.translate(x,Y),t.rotate(_),vt(wt,W),t.strokeStyle="rgba(0, 0, 0, 0.7)";const K=N?1:2;t.lineWidth=K*y,t.strokeText(G,0,0),t.fillText(G,0,0),t.restore()},rt=(G,x,Y,_,wt,W,K,o,St=null,bt=null,E=!0)=>{var n;let X=Math.atan2(G.y-x.y,G.x-x.x),gt=Math.atan2(Y.y-x.y,Y.x-x.x);X<0&&(X+=2*Math.PI),gt<0&&(gt+=2*Math.PI);let Gt=gt-X;if(Gt<0&&(Gt+=2*Math.PI),Gt>Math.PI){Gt=2*Math.PI-Gt;const l=X;X=gt,gt=l,gt<X&&(gt+=2*Math.PI)}else gt<X&&(gt+=2*Math.PI);const Rt=(n=kt.current)==null?void 0:n.getBoundingClientRect(),ot=(Rt==null?void 0:Rt.width)||e.width,p=(Rt==null?void 0:Rt.height)||e.height,P=(Math.max(ot,p)+100)*y,w=(l,d,k,g)=>{const m=Be.getColorForLandmark(l),O=Be.getColorForLandmark(d);if(pe&&k&&g){const M=t.createLinearGradient(k.x,k.y,g.x,g.y);return M.addColorStop(0,m),M.addColorStop(1,O),M}return m},j=x.x-G.x,$=x.y-G.y,z=Math.sqrt(j*j+$*$);if(z>0){const l=j/z,d=$/z,k={x:G.x-l*P,y:G.y-d*P},g={x:x.x+l*P,y:x.y+d*P},m=w(St||"default","vertex",G,x);t.strokeStyle=m,t.lineWidth=st,t.setLineDash([]),t.beginPath(),t.moveTo(G.x,G.y),t.lineTo(x.x,x.y),t.stroke(),E&&(t.strokeStyle=m,t.lineWidth=st,t.setLineDash([5*y,5*y]),t.beginPath(),t.moveTo(k.x,k.y),t.lineTo(G.x,G.y),t.stroke(),t.beginPath(),t.moveTo(x.x,x.y),t.lineTo(g.x,g.y),t.stroke())}const C=Y.x-x.x,h=Y.y-x.y,L=Math.sqrt(C*C+h*h);if(L>0){const l=C/L,d=h/L,k={x:x.x-l*P,y:x.y-d*P},g={x:Y.x+l*P,y:Y.y+d*P},m=w("vertex",bt||"default",x,Y);t.strokeStyle=m,t.lineWidth=st,t.setLineDash([]),t.beginPath(),t.moveTo(x.x,x.y),t.lineTo(Y.x,Y.y),t.stroke(),E&&(t.strokeStyle=m,t.lineWidth=st,t.setLineDash([5*y,5*y]),t.beginPath(),t.moveTo(k.x,k.y),t.lineTo(x.x,x.y),t.stroke(),t.beginPath(),t.moveTo(Y.x,Y.y),t.lineTo(g.x,g.y),t.stroke())}t.strokeStyle="#FFD700",t.lineWidth=st,t.setLineDash([]),t.beginPath(),t.arc(x.x,x.y,o,X,gt),t.stroke();const b=(N?12:18)*y,u=(N?20:25)*y;if(F!=="general"&&F!=="all"){const l=v(x),d=q.get(l)||0;q.set(l,d+1);const k=b+d*u,g=(X+gt)/2,m=o+k,O=x.x+Math.cos(g-Math.PI/2)*m,M=x.y+Math.sin(g-Math.PI/2)*m,f=_!==void 0?`${wt}: ${typeof _=="number"?_.toFixed(1):_}°`:wt;Lt(f,O,M,K,"#FFD700")}},Xt=(G,x,Y,_,wt,W)=>{if(F==="general"||F==="all")return;const K=(G.x+x.x)/2,o=(G.y+x.y)/2,St=Y!==void 0?`${_}: ${typeof Y=="number"?Y.toFixed(1):Y}mm`:_;Lt(St,K,o,W,wt)},qt=(G,x,Y,_,wt,W,K,o,St,bt=null,E=null,X=null,gt=null,Gt=!0)=>{var at;const Rt=G.x,ot=G.y,p=x.x,c=x.y,P=Y.x,w=Y.y,j=_.x,$=_.y,z=(Rt-p)*(w-$)-(ot-c)*(P-j);if(Math.abs(z)<1e-10)return;const C=((Rt-P)*(w-$)-(ot-w)*(P-j))/z,h=Rt+C*(p-Rt),L=ot+C*(c-ot),b=(at=kt.current)==null?void 0:at.getBoundingClientRect(),u=(b==null?void 0:b.width)||e.width,n=(b==null?void 0:b.height)||e.height,d=(Math.max(u,n)+100)*y,k=(D,Z,Q,tt)=>{const J=Be.getColorForLandmark(D),ct=Be.getColorForLandmark(Z);if(pe&&Q&&tt){const Ct=t.createLinearGradient(Q.x,Q.y,tt.x,tt.y);return Ct.addColorStop(0,J),Ct.addColorStop(1,ct),Ct}return J},g=x.x-G.x,m=x.y-G.y,O=Math.sqrt(g*g+m*m);if(O>0){const D=g/O,Z=m/O,Q={x:h-D*d,y:L-Z*d},tt={x:h+D*d,y:L+Z*d},J=k(bt||"default",E||"default",G,x),ct=Math.sqrt((h-G.x)**2+(L-G.y)**2),Ct=Math.sqrt((x.x-G.x)**2+(x.y-G.y)**2),ht=Math.sqrt((x.x-h)**2+(x.y-L)**2),ut=Math.abs(ct+ht-Ct)<1;t.strokeStyle=J,t.lineWidth=st,t.setLineDash([]),t.beginPath(),t.moveTo(G.x,G.y),t.lineTo(x.x,x.y),t.stroke(),Gt&&(t.strokeStyle=J,t.lineWidth=st,t.setLineDash([5*y,5*y]),t.beginPath(),t.moveTo(Q.x,Q.y),t.lineTo(G.x,G.y),t.stroke(),ut?(t.beginPath(),t.moveTo(x.x,x.y),t.lineTo(tt.x,tt.y),t.stroke()):(t.beginPath(),t.moveTo(x.x,x.y),t.lineTo(h,L),t.stroke()))}const M=_.x-Y.x,f=_.y-Y.y,S=Math.sqrt(M*M+f*f);if(S>0){const D=M/S,Z=f/S,Q={x:h-D*d,y:L-Z*d},tt={x:h+D*d,y:L+Z*d},J=k(X||"default",gt||"default",Y,_),ct=Math.sqrt((h-Y.x)**2+(L-Y.y)**2),Ct=Math.sqrt((_.x-Y.x)**2+(_.y-Y.y)**2),ht=Math.sqrt((_.x-h)**2+(_.y-L)**2),ut=Math.abs(ct+ht-Ct)<1;t.strokeStyle=J,t.lineWidth=st,t.setLineDash([]),t.beginPath(),t.moveTo(Y.x,Y.y),t.lineTo(_.x,_.y),t.stroke(),Gt&&(t.strokeStyle=J,t.lineWidth=st,t.setLineDash([5*y,5*y]),t.beginPath(),t.moveTo(Q.x,Q.y),t.lineTo(Y.x,Y.y),t.stroke(),ut?(t.beginPath(),t.moveTo(_.x,_.y),t.lineTo(tt.x,tt.y),t.stroke()):(t.beginPath(),t.moveTo(_.x,_.y),t.lineTo(h,L),t.stroke()))}let B=Math.atan2(x.y-L,x.x-h),R=Math.atan2(_.y-L,_.x-h),it=R-B;if(it<0&&(it+=2*Math.PI),it>Math.PI){const D=B;B=R,R=D,it=2*Math.PI-it}R<B&&(R+=2*Math.PI,it=R-B),t.strokeStyle="#FFD700",t.lineWidth=st,t.setLineDash([]),t.beginPath(),t.arc(h,L,St,B,R),t.stroke();const Pt=(N?12:18)*y,lt=(N?20:25)*y;if(F!=="general"&&F!=="all"){const Z=v({x:h,y:L}),Q=q.get(Z)||0;q.set(Z,Q+1);const tt=Pt+Q*lt,J=(B+R)/2,ct=St+tt,Ct=h+Math.cos(J-Math.PI/2)*ct,ht=L+Math.sin(J-Math.PI/2)*ct,ut=wt!==void 0?`${W}: ${typeof wt=="number"?wt.toFixed(1):wt}°`:W;Lt(ut,Ct,ht,o,"#FFD700")}},He=(G,x,Y,_,wt)=>{const W=Y.x-x.x,K=Y.y-x.y,o=Math.sqrt(W*W+K*K);if(o===0)return;const St=((G.x-x.x)*W+(G.y-x.y)*K)/(o*o),bt=x.x+St*W,E=x.y+St*K;t.strokeStyle=_,t.lineWidth=wt,t.setLineDash([3*y,3*y]),t.beginPath(),t.moveTo(G.x,G.y),t.lineTo(bt,E),t.stroke(),t.setLineDash([])},_e=(G,x,Y,_,wt,W,K)=>{if(F==="general"||F==="all")return;const o=Y.x-x.x,St=Y.y-x.y,bt=Math.sqrt(o*o+St*St);if(bt===0)return;const E=((G.x-x.x)*o+(G.y-x.y)*St)/(bt*bt),X=x.x+E*o,gt=x.y+E*St,Gt=(G.x+X)/2,Rt=(G.y+gt)/2,ot=_!==void 0?`${wt}: ${typeof _=="number"?_.toFixed(1):_}mm`:wt;Lt(ot,Gt,Rt,K,W)},se=(G,x,Y,_,wt=st,W=!0,K=null,o=null)=>{var Rt;if(!G||!x)return;const St=x.x-G.x,bt=x.y-G.y,E=Math.sqrt(St*St+bt*bt);if(E===0)return;const X=St/E,gt=bt/E;let Gt=0;if(W){const ot=(Rt=kt.current)==null?void 0:Rt.getBoundingClientRect();Gt=(Math.max((ot==null?void 0:ot.width)||e.width,(ot==null?void 0:ot.height)||e.height)+100)*y}if(pe&&Y&&_){const ot=t.createLinearGradient(G.x,G.y,x.x,x.y);ot.addColorStop(0,Y),ot.addColorStop(1,_),t.strokeStyle=ot}else t.strokeStyle=Y||_||r.default||"#00D9FF";if(t.lineWidth=wt,t.setLineDash([]),t.beginPath(),t.moveTo(G.x,G.y),t.lineTo(x.x,x.y),t.stroke(),W&&Gt>0&&(t.setLineDash([5*y,5*y]),t.beginPath(),t.moveTo(G.x-X*Gt,G.y-gt*Gt),t.lineTo(G.x,G.y),t.stroke(),t.beginPath(),t.moveTo(x.x,x.y),t.lineTo(x.x+X*Gt,x.y+gt*Gt),t.stroke(),t.setLineDash([])),K&&o!==null&&o!==void 0&&!isNaN(o)){const ot=(G.x+x.x)/2,p=(G.y+x.y)/2,c=Math.atan2(x.y-G.y,x.x-G.x),P=N?7:10,w=typeof o=="number"?o.toFixed(1):o,j=K.includes("°")?"":"mm";Kt(`${K}: ${w}${j}`,ot,p,c,P,"#FFD700")}},qe=window.devicePixelRatio||1,Ye=N?qe*2:qe,fe=U.width,re=U.height;e.width=fe*Ye,e.height=re*Ye,e.style.width=`${fe}px`,e.style.height=`${re}px`,t.scale(Ye,Ye),t.imageSmoothingEnabled=!0,t.imageSmoothingQuality="high",t.clearRect(0,0,fe,re);let Xe,Qt,ao,un,fn;if(i&&ue&&oe!=="coordinate"&&(Xe=Math.min(fe/i.width,re/i.height)*y,Qt=i.width*Xe,ao=i.height*Xe,un=(fe-Qt)/2+ae.x,fn=(re-ao)/2+ae.y,t.filter="none",t.drawImage(i,un,fn,Qt,ao),t.filter="none"),eo||oe==="coordinate"){const G=Nt.palette.mode==="dark",x=G?"#ff6b6b":"#ff0000",Y=G?"#4a5568":"#f0f0f0";t.strokeStyle=x;const _=N?1:2;t.lineWidth=_*y,t.beginPath(),t.moveTo(fe/2,0),t.lineTo(fe/2,re),t.moveTo(0,re/2),t.lineTo(fe,re/2),t.stroke(),t.strokeStyle=Y;const wt=N?.5:1;t.lineWidth=wt*y;const W=20;for(let K=0;K<fe;K+=W)t.beginPath(),t.moveTo(K,0),t.lineTo(K,re),t.stroke();for(let K=0;K<re;K+=W)t.beginPath(),t.moveTo(0,K),t.lineTo(fe,K),t.stroke()}if(Object.keys(V).length>0){if(so){t.lineWidth=st,je==="dashed"?t.setLineDash([8*y,4*y]):je==="dotted"?t.setLineDash([2*y,3*y]):t.setLineDash([]);const W=c=>{if(V[c])return V[c];const P=c.toLowerCase(),w=Object.keys(V).find(L=>L.toLowerCase()===P);if(w)return V[w];const j={Or:["or","orbit","orbitale"],Po:["po","porion"],L1:["l1","lower","incisor","li","lower_incisor"],U1:["u1","upper","incisor","ui","upper_incisor"],Me:["me","menton"],Go:["go","gonion"],S:["s","sella"],N:["n","nasion"],A:["a","point_a","point a"],B:["b","point_b","point b"],Gn:["gn","gnathion"],Pog:["pog","pogonion"],ANS:["ans","anterior"],PNS:["pns","posterior"],Pn:["pn","prn","pronasale"],"Pog′":["pog′","pog'","pog`","pogsoft","soft pogonion","pogonion soft","pog prime"],LMT:["lmt","LMT","lower_molar","Lower Molar","L6","l6"]};if(j[c])for(const L of j[c]){const b=Object.keys(V).find(u=>u.toLowerCase().includes(L.toLowerCase())||L.toLowerCase().includes(u.toLowerCase()));if(b)return V[b]}const $=c.replace(/['"`′]/g,"").toLowerCase(),z=Object.keys(V).find(L=>L.replace(/['"`′]/g,"").toLowerCase()===$);if(z)return V[z];const C=c.replace(/'/g,"\\'").replace(/`/g,"\\`").replace(/′/g,"\\′"),h=Object.keys(V).find(L=>L===c||L===C||L.toLowerCase()===c.toLowerCase()||L.toLowerCase()===C.toLowerCase());if(h)return V[h];if(c.includes("'")){const L=c.replace(/'/g,"′"),b=Object.keys(V).find(u=>u===L||u.toLowerCase()===L.toLowerCase());if(b)return V[b]}if(c.includes("′")){const L=c.replace(/′/g,"'"),b=Object.keys(V).find(u=>u===L||u.toLowerCase()===L.toLowerCase());if(b)return V[b]}if(c.includes("'")){const L=c.replace(/'/g,"`"),b=Object.keys(V).find(u=>u===L||u.toLowerCase()===L.toLowerCase());if(b)return V[b]}if(c.includes("`")){const L=c.replace(/`/g,"'"),b=Object.keys(V).find(u=>u===L||u.toLowerCase()===L.toLowerCase());if(b)return V[b]}return null},K=c=>{for(const P of c){const w=W(P);if(w)return w}return null},o=c=>{let P=Zo[c];if(P){const w=K(P);if(w)return w}if(c.includes("'")){const w=c.replace(/'/g,"`");if(P=Zo[w],P){const j=K(P);if(j)return j}}if(c.includes("`")){const w=c.replace(/`/g,"'");if(P=Zo[w],P){const j=K(P);if(j)return j}}return null},St=(c,P,w=[])=>{if(p&&p[P]!==void 0&&p[P]!==null)return parseFloat(p[P]);for(const j of w)if(p&&p[j]!==void 0&&p[j]!==null)return parseFloat(p[j]);return de&&de>0?c*de:null},bt=F&&kn[F]?kn[F]:Bn,E=F==="leganBurstone"||F==="arnettMcLaughlin"||F==="holdaway"||F==="softTissueAngular",X=[...F!=="mcnamara"&&F!=="wits"&&F!=="jarabak"&&F!=="sassouni"&&F!=="steiner"&&!E?[{start:"Or",end:"Po",label:"Or-Po (Frankfort)"}]:[],...F!=="mcnamara"&&F!=="wits"&&F!=="tweed"&&F!=="jarabak"&&F!=="steiner"&&!E?[{start:"ANS",end:"PNS",label:"ANS-PNS"}]:[],...F!=="mcnamara"&&F!=="wits"&&F!=="tweed"&&F!=="steiner"&&!E?[{start:"S",end:"N",label:"S-N"}]:[]],gt=(c,P)=>c<P?`${c}-${P}`:`${P}-${c}`,Gt=new Set,Rt=[];X.forEach(c=>{const P=gt(c.start,c.end);Gt.has(P)||(Gt.add(P),Rt.push(c))}),bt.forEach(c=>{const P=gt(c.start,c.end);Gt.has(P)||(Gt.add(P),Rt.push(c))}),Rt.forEach(({start:c,end:P,label:w,extend:j})=>{var C;if((F==="mcnamara"||F==="jarabak"||F==="general")&&!Ys(c,P,F))return;if(E){const h=new Set(["S-N","N-S","Or-Po","Po-Or","ANS-PNS","PNS-ANS","N-A","A-N","N-B","B-N","N-Pog","Pog-N","S-A","A-S","S-B","B-S","Go-Me","Me-Go","Go-Gn","Gn-Go","Ar-Go","Go-Ar","S-Ar","Ar-S","S-Go","Go-S","U1-L1","L1-U1","U1-A","A-U1","L1-A","A-L1","S-U1","U1-S","L1-Me","Me-L1","Or-L1","L1-Or","Po-L1","L1-Po","Gn-Pt","Pt-Gn","Ba-Pt","Pt-Ba","N-Me","Me-N","Co-Gn","Gn-Co","L1-LMT","LMT-L1","A-B","B-A","L1A-L1","L1-L1A"]),L=gt(c,P);if(h.has(L))return}const $=W(c),z=W(P);if(!(!$||!z)&&$&&z){const h=s($);let L=s(z);if(w==="Occlusal Plane"&&c==="L1"&&P==="LMT"){const b=W("UMT")||W("umt")||W("upper_molar")||W("Upper Molar")||W("U6")||W("u6");if(b){const u=s(b);u&&L&&(L={x:(L.x+u.x)/2,y:(L.y+u.y)/2})}}if(h&&L){if(pe){const b=r[c]||r.default||"#00D9FF",u=r[P]||r.default||"#00D9FF",n=t.createLinearGradient(h.x,h.y,L.x,L.y);n.addColorStop(0,b),n.addColorStop(1,u),t.strokeStyle=n}else t.strokeStyle=no;if(t.lineWidth=st,t.setLineDash([]),t.beginPath(),t.moveTo(h.x,h.y),t.lineTo(L.x,L.y),t.stroke(),j){const b=(C=kt.current)==null?void 0:C.getBoundingClientRect(),u=(b==null?void 0:b.width)||e.width,n=(b==null?void 0:b.height)||e.height,d=(Math.max(u,n)+100)*y,k=L.x-h.x,g=L.y-h.y,m=Math.sqrt(k*k+g*g);if(m>0){const O=k/m,M=g/m,f={x:h.x-O*d,y:h.y-M*d},S={x:L.x+O*d,y:L.y+M*d};t.lineWidth=st,t.setLineDash([5*y,5*y]),t.strokeStyle=pe?r[c]||r.default||"#00D9FF":no,t.beginPath(),t.moveTo(f.x,f.y),t.lineTo(h.x,h.y),t.stroke(),t.strokeStyle=pe?r[P]||r.default||"#00D9FF":no,t.beginPath(),t.moveTo(L.x,L.y),t.lineTo(S.x,S.y),t.stroke(),t.setLineDash([])}}}}});const ot=(c,P,w,j)=>{const $=r[c]||r.default||"#00D9FF",z=r[P]||r.default||"#00D9FF";if(pe&&w&&j){const C=t.createLinearGradient(w.x,w.y,j.x,j.y);return C.addColorStop(0,$),C.addColorStop(1,z),C}return $},p=Object.keys(xe).length>0?xe:Wt||{};if(pt&&(F==="mcnamara"||F==="general")){const c=o("S"),P=o("Go"),w=o("N"),j=o("Me");if(c&&P){const C=s(c),h=s(P);if(C&&h){const L=Math.sqrt((h.x-C.x)**2+(h.y-C.y)**2),b={x:(C.x+h.x)/2,y:(C.y+h.y)/2},u=Math.atan2(h.y-C.y,h.x-C.x),n=St(L,"S-Go",["Posterior Facial Height (S-Go)"]),l=N?7:10;if(n!==null&&!isNaN(n)){const d=`S-Go: ${typeof n=="number"?n.toFixed(1):n}mm`;Kt(d,b.x,b.y,u,l,"#FFD700")}}}if(w&&j){const C=s(w),h=s(j);if(C&&h){const L=Math.sqrt((h.x-C.x)**2+(h.y-C.y)**2),b={x:(C.x+h.x)/2,y:(C.y+h.y)/2},u=Math.atan2(h.y-C.y,h.x-C.x),n=St(L,"N-Me",["Anterior Facial Height (N-Me)"]),l=N?7:10;if(n!==null&&!isNaN(n)){const d=`N-Me: ${typeof n=="number"?n.toFixed(1):n}mm`;Kt(d,b.x,b.y,u,l,"#FFD700")}}}const $=o("A"),z=o("Pog");if($&&w&&z){const C=s($),h=s(w),L=s(z);if(C&&h&&L){const b=N?7:12,u=(N?10:30)*y;let n=p&&(p["Skeletal Convexity"]||p["N-A-Pog"])?parseFloat(p["Skeletal Convexity"]||p["N-A-Pog"]):void 0;if(n==null||isNaN(n)){const l=ne(h,C,L,C);l!==null&&!isNaN(l)&&(n=l)}n!=null&&!isNaN(n)&&rt(h,C,L,n,"Skeletal Convexity","#FFD700",b,u,"N","Pog")}}}if(pt&&(F==="wits"||F==="general")){const c=o("L1"),P=o("LMT"),w=o("UMT"),j=o("A"),$=o("B");if(c&&P&&j&&$){const z=s(c),C=s(P),h=w?s(w):null,L=s(j),b=s($);if(z&&C&&L&&b){const u=h?{x:(C.x+h.x)/2,y:(C.y+h.y)/2}:C,n=(hn=kt.current)==null?void 0:hn.getBoundingClientRect(),l=(n==null?void 0:n.width)||e.width,d=(n==null?void 0:n.height)||e.height,g=(Math.max(l,d)+100)*y,m=u.x-z.x,O=u.y-z.y,M=Math.sqrt(m*m+O*O);if(M>0){const f=m/M,S=O/M,B={x:z.x-f*g,y:z.y-S*g},R={x:u.x+f*g,y:u.y+S*g};t.lineWidth=st*1.5,t.setLineDash([]),t.strokeStyle=ot("L1","LMT",z,u),t.beginPath(),t.moveTo(z.x,z.y),t.lineTo(u.x,u.y),t.stroke(),t.lineWidth=st,t.setLineDash([5*y,5*y]),t.strokeStyle=ot("L1","LMT",B,R),t.beginPath(),t.moveTo(B.x,B.y),t.lineTo(R.x,R.y),t.stroke(),t.setLineDash([]);const it=(ht,ut,yt,Dt)=>{const zt=ht.x-ut.x,Yt=ht.y-ut.y,Bt=(zt*yt+Yt*Dt)/(yt*yt+Dt*Dt);return{x:ut.x+Bt*yt,y:ut.y+Bt*Dt}},Pt=it(L,z,f,S),lt=it(b,z,f,S);t.lineWidth=st,t.setLineDash([]),t.strokeStyle="#00FF00",t.beginPath(),t.moveTo(L.x,L.y),t.lineTo(Pt.x,Pt.y),t.stroke(),t.beginPath(),t.moveTo(b.x,b.y),t.lineTo(lt.x,lt.y),t.stroke();const at=lt.x-Pt.x,D=lt.y-Pt.y,Z=at*f+D*S;let Q=de||.11;const tt=o("p1")||o("P1"),J=o("p2")||o("P2");if(tt&&J){const ht=s(tt),ut=s(J);if(ht&&ut){const yt=Math.abs(ut.x-ht.x),Dt=Math.abs(ut.y-ht.y),zt=Math.sqrt(yt*yt+Dt*Dt);zt>0&&(Q=10/zt)}}const Ct=Math.abs(Z)*Q*(Z>=0?1:-1);Wt&&typeof Wt=="object"&&(Wt["AO-BO"]=Ct)}}}}if(pt&&(F==="steiner"||F==="all"||F==="general")){const c=o("S"),P=o("N"),w=o("A"),j=o("B");if(c&&P&&w&&j){const u=s(c),n=s(P),l=s(w),d=s(j);if(u&&n&&l&&d){const k=N?7:12,g=(N?10:30)*y,m=Et(u,n,l);let O=Math.atan2(u.y-n.y,u.x-n.x),M=Math.atan2(l.y-n.y,l.x-n.x),f=M-O;if(f<0&&(f+=2*Math.PI),f>Math.PI){const J=O;O=M,M=J}M<O&&(M+=2*Math.PI),t.strokeStyle="#FFD700",t.lineWidth=st,t.setLineDash([]),t.beginPath(),t.arc(n.x,n.y,g,O,M),t.stroke(),n.y>a/2;const S=(N?12:18)*y,B=n.x,R=n.y-(g+S);if(F!=="general"&&F!=="all"){const J=(p==null?void 0:p.SNA)||m,ct=`SNA: ${typeof J=="number"?J.toFixed(1):J}°`;Lt(ct,B,R,k,"#FFD700")}const it=Et(u,n,d);let Pt=Math.atan2(u.y-n.y,u.x-n.x),lt=Math.atan2(d.y-n.y,d.x-n.x),at=lt-Pt;if(at<0&&(at+=2*Math.PI),at>Math.PI){const J=Pt;Pt=lt,lt=J}lt<Pt&&(lt+=2*Math.PI);const D=g+(N?7:15)*y;t.strokeStyle="#FFD700",t.lineWidth=st,t.setLineDash([]),t.beginPath(),t.arc(n.x,n.y,D,Pt,lt),t.stroke(),n.y>a/2;const Z=(N?12:18)*y,Q=n.x,tt=n.y-(D+Z);if(F!=="general"&&F!=="all"){const J=(p==null?void 0:p.SNB)||it,ct=`SNB: ${typeof J=="number"?J.toFixed(1):J}°`;Lt(ct,Q,tt,k,"#FFD700")}}}const $=o("U1"),z=o("U1A");if($&&z&&c&&P){const u=s($),n=s(z),l=s(c),d=s(P);if(u&&n&&l&&d&&p["U1-SN"]){const k=N?7:12,g=(N?10:30)*y;qt(u,n,d,l,p["U1-SN"],"U1-SN","#FFD700",k,g,"U1","U1A","S","N")}}const C=o("L1"),h=o("L1A"),L=o("Go"),b=o("Me");if(C&&h&&L&&b){const u=s(C),n=s(h),l=s(L),d=s(b);if(u&&n&&l&&d&&p["L1-MP"]){const k=N?7:12,g=(N?10:30)*y;qt(u,n,d,l,p["L1-MP"],"L1-MP","#FFD700",k,g,"L1","L1A","Go","Me")}}}if(pt&&(F==="jarabak"||F==="general")){const c=o("S"),P=o("N"),w=o("Go"),j=o("Me"),$=o("ANS"),z=o("Ar");let C,h,L,b,u,n;if(c&&P&&$&&j&&w&&z&&(C=s(c),h=s(P),L=s($),b=s(j),u=s(w),n=s(z),C&&h&&L&&b&&u&&n)){const l=st*1.5,d=r.S||r.default||"#00D9FF",k=r.N||r.default||"#00D9FF";se(C,h,d,k,l,!1);const g=r.ANS||r.default||"#00D9FF";se(h,L,k,g,l,!1);const m=r.Me||r.default||"#00D9FF";se(L,b,g,m,l,!1);const O=r.Go||r.default||"#00D9FF";se(b,u,m,O,l,!1);const M=r.Ar||r.default||"#00D9FF";se(u,n,O,M,l,!1),se(n,C,M,d,l,!1);const f=[{pos:C,name:"S"},{pos:h,name:"N"},{pos:L,name:"ANS"},{pos:b,name:"Me"},{pos:u,name:"Go"},{pos:n,name:"Ar"}],S=N?7:11,B=(N?12:25)*y;for(let R=0;R<f.length;R++){const it=(R-1+f.length)%f.length,Pt=R,lt=(R+1)%f.length,at=f[it].pos,D=f[Pt].pos,Z=f[lt].pos,Q=Et(at,D,Z);let tt=Math.atan2(at.y-D.y,at.x-D.x),J=Math.atan2(Z.y-D.y,Z.x-D.x),ct=J-tt;if(ct<0&&(ct+=2*Math.PI),ct>Math.PI){const yt=tt;tt=J,J=yt}J<tt&&(J+=2*Math.PI),t.strokeStyle="#FFD700",t.lineWidth=st,t.setLineDash([]),t.beginPath(),t.arc(D.x,D.y,B,tt,J),t.stroke();const Ct=(N?12:18)*y,ht=D.x,ut=D.y-(B+Ct);if(F!=="general"&&F!=="all"){const yt=(p==null?void 0:p[`Jarabak-${f[Pt].name}`])||Q,Dt=`${f[Pt].name}: ${typeof yt=="number"?yt.toFixed(1):yt}°`;Lt(Dt,ht,ut,S,"#FFD700")}}}if(c&&P&&w&&j&&(C||(C=s(c)),h||(h=s(P)),u||(u=s(w)),b||(b=s(j)),C&&h&&u&&b)){const l=(Ln=kt.current)==null?void 0:Ln.getBoundingClientRect(),d=(l==null?void 0:l.width)||e.width,k=(l==null?void 0:l.height)||e.height,m=(Math.max(d,k)+100)*y;t.lineWidth=st*1.5,t.setLineDash([]),t.strokeStyle=ot("S","N",C,h),t.beginPath(),t.moveTo(C.x,C.y),t.lineTo(h.x,h.y),t.stroke(),t.strokeStyle=ot("Go","Me",u,b),t.beginPath(),t.moveTo(u.x,u.y),t.lineTo(b.x,b.y),t.stroke(),t.lineWidth=st,t.setLineDash([5*y,5*y]);const O=h.x-C.x,M=h.y-C.y,f=Math.sqrt(O*O+M*M),S=O/f,B=M/f,R={x:h.x+S*m,y:h.y+B*m},it={x:C.x-S*m,y:C.y-B*m};t.strokeStyle=ot("N","S",h,R),t.beginPath(),t.moveTo(h.x,h.y),t.lineTo(R.x,R.y),t.stroke(),t.strokeStyle=ot("S","N",C,it),t.beginPath(),t.moveTo(C.x,C.y),t.lineTo(it.x,it.y),t.stroke();const Pt=b.x-u.x,lt=b.y-u.y,at=Math.sqrt(Pt*Pt+lt*lt),D=Pt/at,Z=lt/at,Q={x:b.x+D*m,y:b.y+Z*m},tt={x:u.x-D*m,y:u.y-Z*m};t.strokeStyle=ot("Go","Me",b,Q),t.beginPath(),t.moveTo(b.x,b.y),t.lineTo(Q.x,Q.y),t.stroke(),t.strokeStyle=ot("Go","Me",u,tt),t.beginPath(),t.moveTo(u.x,u.y),t.lineTo(tt.x,tt.y),t.stroke(),t.setLineDash([]);const ct=((Ct,ht,ut,yt)=>{const Dt=Ct.x,zt=Ct.y,Yt=ht.x,Bt=ht.y,ie=ut.x,te=ut.y,Me=yt.x,Jt=yt.y,Ae=(Dt-Yt)*(te-Jt)-(zt-Bt)*(ie-Me);if(Math.abs(Ae)<.001)return null;const Zt=((Dt-ie)*(te-Jt)-(zt-te)*(ie-Me))/Ae,Qe=-((Dt-Yt)*(zt-te)-(zt-Bt)*(Dt-ie))/Ae;if(Zt>=0&&Zt<=1&&Qe>=0&&Qe<=1)return{x:Dt+Zt*(Yt-Dt),y:zt+Zt*(Bt-zt)};const be=Dt+Zt*(Yt-Dt),ge=zt+Zt*(Bt-zt);return{x:be,y:ge}})(it,R,tt,Q);if(ct){const Ct=Math.atan2(Q.y-ct.y,Q.x-ct.x),ht=Math.atan2(R.y-ct.y,R.x-ct.x);let ut=Math.abs(Ct-ht);ut>Math.PI&&(ut=2*Math.PI-ut);const yt=ut*(180/Math.PI),Dt=N?7:12,zt=(N?10:30)*y;let Yt=ht,Bt=Ct,ie=Bt-Yt;ie<0&&(ie+=2*Math.PI);let te=Yt-Bt;if(te<0&&(te+=2*Math.PI),te<ie){const Jt=Yt;Yt=Bt,Bt=Jt}if(Bt<Yt&&(Bt+=2*Math.PI),Bt-Yt>Math.PI){const Jt=Bt-2*Math.PI;Jt<Yt?Yt-=2*Math.PI:Bt=Jt}if(t.strokeStyle="#FFD700",t.lineWidth=st,t.setLineDash([]),t.beginPath(),t.arc(ct.x,ct.y,zt,Yt,Bt),t.stroke(),t.setLineDash([]),F!=="general"&&F!=="all"){const Jt=ct.x,Ae=ct.y-(zt+(N?18:25)*y),Zt=`GoMe-SN: ${typeof yt=="number"?yt.toFixed(1):yt}°`;Lt(Zt,Jt,Ae,Dt,"#FFD700")}}}}if(pt&&F==="sassouni"){const c=o("S"),P=o("N"),w=o("Gn"),j=o("Me"),$=o("Go"),z=o("Ar"),C=o("Co")||o("co")||o("CO")||o("condyle")||o("Condyle"),h=o("ANS"),L=o("PNS"),b=o("L1"),u=o("LMT"),n=o("UMT");if(c&&P&&j&&$&&z){const l=s(c),d=s(P);w&&s(w);const k=s(j),g=s($),m=s(z),O=C?s(C):null,M=h?s(h):null,f=L?s(L):null,S=b?s(b):null,B=u?s(u):null,R=n?s(n):null;if(l&&d&&k&&g&&m){const it=(pn=kt.current)==null?void 0:pn.getBoundingClientRect(),Pt=(it==null?void 0:it.width)||e.width,lt=(it==null?void 0:it.height)||e.height,D=(Math.max(Pt,lt)+100)*y,Z=(ft,Ft,Mt)=>{const It=ft.x-Ft.x,Ht=ft.y-Ft.y,Ut=Mt.x-Ft.x,At=Mt.y-Ft.y,Tt=It*Ut+Ht*At,le=Math.sqrt(It*It+Ht*Ht),ce=Math.sqrt(Ut*Ut+At*At);if(le===0||ce===0)return 0;const we=Tt/(le*ce),he=Math.max(-1,Math.min(1,we));return Math.acos(he)*(180/Math.PI)};t.lineWidth=st,t.setLineDash([5*y,5*y]);const Q=d.x-l.x,tt=d.y-l.y,J=Math.sqrt(Q*Q+tt*tt),ct=Q/J,Ct=tt/J,ht={x:d.x+ct*D,y:d.y+Ct*D},ut={x:l.x-ct*D,y:l.y-Ct*D};t.strokeStyle=ot("N","S",d,ht),t.beginPath(),t.moveTo(d.x,d.y),t.lineTo(ht.x,ht.y),t.stroke(),t.strokeStyle=ot("S","N",l,ut),t.beginPath(),t.moveTo(l.x,l.y),t.lineTo(ut.x,ut.y),t.stroke();const yt=g.x-k.x,Dt=g.y-k.y,zt=Math.sqrt(yt*yt+Dt*Dt),Yt=yt/zt,Bt=Dt/zt,ie={x:g.x+Yt*D,y:g.y+Bt*D},te={x:k.x-Yt*D,y:k.y-Bt*D};if(t.strokeStyle=ot("Go","Me",g,ie),t.beginPath(),t.moveTo(g.x,g.y),t.lineTo(ie.x,ie.y),t.stroke(),t.strokeStyle=ot("Me","Go",k,te),t.beginPath(),t.moveTo(k.x,k.y),t.lineTo(te.x,te.y),t.stroke(),S&&B){const ft=R?{x:(B.x+R.x)/2,y:(B.y+R.y)/2}:B,Ft=ft.x-S.x,Mt=ft.y-S.y,It=Math.sqrt(Ft*Ft+Mt*Mt);if(It>0){const Ht=Ft/It,Ut=Mt/It,At={x:ft.x+Ht*D,y:ft.y+Ut*D},Tt={x:S.x-Ht*D,y:S.y-Ut*D};t.strokeStyle=ot("LMT","L1",ft,At),t.beginPath(),t.moveTo(ft.x,ft.y),t.lineTo(At.x,At.y),t.stroke(),t.strokeStyle=ot("L1","LMT",S,Tt),t.beginPath(),t.moveTo(S.x,S.y),t.lineTo(Tt.x,Tt.y),t.stroke()}}if(M&&f){const ft=f.x-M.x,Ft=f.y-M.y,Mt=Math.sqrt(ft*ft+Ft*Ft);if(Mt>0){const It=ft/Mt,Ht=Ft/Mt,Ut={x:f.x+It*D,y:f.y+Ht*D},At={x:M.x-It*D,y:M.y-Ht*D};t.strokeStyle=ot("PNS","ANS",f,Ut),t.beginPath(),t.moveTo(f.x,f.y),t.lineTo(Ut.x,Ut.y),t.stroke(),t.strokeStyle=ot("ANS","PNS",M,At),t.beginPath(),t.moveTo(M.x,M.y),t.lineTo(At.x,At.y),t.stroke()}}t.setLineDash([]);const Me=N?7:12,Jt=(N?10:30)*y,Zt=((ft,Ft,Mt,It)=>{const Ht=ft.x,Ut=ft.y,At=Ft.x,Tt=Ft.y,le=Mt.x,ce=Mt.y,we=It.x,he=It.y,Ge=(Ht-At)*(ce-he)-(Ut-Tt)*(le-we);if(Math.abs(Ge)<.001)return null;const Ce=((Ht-le)*(ce-he)-(Ut-ce)*(le-we))/Ge,Fo=-((Ht-At)*(Ut-ce)-(Ut-Tt)*(Ht-le))/Ge;if(Ce>=0&&Ce<=1&&Fo>=0&&Fo<=1)return{x:Ht+Ce*(At-Ht),y:Ut+Ce*(Tt-Ut)};const Ko=Ht+Ce*(At-Ht),xn=Ut+Ce*(Tt-Ut);return{x:Ko,y:xn}})(ut,ht,ie,te);if(Zt){const ft=Math.atan2(te.y-Zt.y,te.x-Zt.x),Ft=Math.atan2(ht.y-Zt.y,ht.x-Zt.x);let Mt=Math.abs(ft-Ft);Mt>Math.PI&&(Mt=2*Math.PI-Mt);const It=Mt*(180/Math.PI),Ht=N?7:12,Ut=(N?10:30)*y;let At=Ft,Tt=ft,le=Tt-At;le<0&&(le+=2*Math.PI);let ce=At-Tt;if(ce<0&&(ce+=2*Math.PI),ce<le){const he=At;At=Tt,Tt=he}if(Tt<At&&(Tt+=2*Math.PI),Tt-At>Math.PI){const he=Tt-2*Math.PI;he<At?At-=2*Math.PI:Tt=he}if(t.strokeStyle="#FFD700",t.lineWidth=st,t.setLineDash([]),t.beginPath(),t.arc(Zt.x,Zt.y,Ut,At,Tt),t.stroke(),t.setLineDash([]),F!=="general"&&F!=="all"){const he=Zt.x,Ge=Zt.y-(Ut+(N?18:25)*y),Ce=`GoMe-SN: ${typeof It=="number"?It.toFixed(1):It}°`;Lt(Ce,he,Ge,Ht,"#FFD700")}}const Qe=Z(d,l,m);let be=Math.atan2(d.y-l.y,d.x-l.x),ge=Math.atan2(m.y-l.y,m.x-l.x),qo=ge-be;if(qo<0&&(qo+=2*Math.PI),qo>Math.PI){const ft=be;if(be=ge,ge=ft,ge<be&&(ge+=2*Math.PI),ge-be>Math.PI){const Mt=ge-2*Math.PI;Mt<be?be-=2*Math.PI:ge=Mt}}else ge<be&&(ge+=2*Math.PI);t.strokeStyle="#FFD700",t.lineWidth=st,t.setLineDash([]),t.beginPath(),t.arc(l.x,l.y,Jt,be,ge),t.stroke(),t.setLineDash([]),l.y>a/2;const ss=(N?12:18)*y,is=l.x,as=l.y-(Jt+ss);if(F!=="general"&&F!=="all"){const ft=`S: ${typeof Qe=="number"?Qe.toFixed(1):Qe}°`;Lt(ft,is,as,Me,"#FFD700")}const Yo=Z(l,m,g);let Ne=Math.atan2(l.y-m.y,l.x-m.x),ye=Math.atan2(g.y-m.y,g.x-m.x),Xo=ye-Ne;if(Xo<0&&(Xo+=2*Math.PI),Xo>Math.PI){const ft=Ne;if(Ne=ye,ye=ft,ye<Ne&&(ye+=2*Math.PI),ye-Ne>Math.PI){const Mt=ye-2*Math.PI;Mt<Ne?Ne-=2*Math.PI:ye=Mt}}else ye<Ne&&(ye+=2*Math.PI);t.strokeStyle="#FFD700",t.lineWidth=st,t.setLineDash([]),t.beginPath(),t.arc(m.x,m.y,Jt,Ne,ye),t.stroke(),t.setLineDash([]),m.y>a/2;const rs=(N?12:18)*y,ls=m.x,cs=m.y-(Jt+rs);if(F!=="general"&&F!=="all"){const ft=`Ar: ${typeof Yo=="number"?Yo.toFixed(1):Yo}°`;Lt(ft,ls,cs,Me,"#FFD700")}const $o=Z(m,g,k);let De=Math.atan2(m.y-g.y,m.x-g.x),Fe=Math.atan2(k.y-g.y,k.x-g.x),Vo=Fe-De;if(Vo<0&&(Vo+=2*Math.PI),Vo>Math.PI){const ft=De;if(De=Fe,Fe=ft,Fe<De&&(Fe+=2*Math.PI),Fe-De>Math.PI){const Mt=Fe-2*Math.PI;Mt<De?De-=2*Math.PI:Fe=Mt}}else Fe<De&&(Fe+=2*Math.PI);t.strokeStyle="#FFD700",t.lineWidth=st,t.setLineDash([]),t.beginPath(),t.arc(g.x,g.y,Jt,De,Fe),t.stroke(),t.setLineDash([]),g.y>a/2;const ds=(N?12:18)*y,us=g.x,fs=g.y-(Jt+ds);if(F!=="general"&&F!=="all"){const ft=`Go: ${typeof $o=="number"?$o.toFixed(1):$o}°`;Lt(ft,us,fs,Me,"#FFD700")}if(O&&g&&l&&d){const ft=Object.keys(xe).length>0?xe:Wt||{};let Ft=ft&&ft["Sagittal Differentiation Angle"]?parseFloat(ft["Sagittal Differentiation Angle"]):void 0;const Mt=(It,Ht,Ut,At)=>{const Tt=Ht.x-It.x,le=Ht.y-It.y,ce=At.x-Ut.x,we=At.y-Ut.y,he=Tt*ce+le*we,Ge=Math.sqrt(Tt*Tt+le*le),Ce=Math.sqrt(ce*ce+we*we);if(Ge===0||Ce===0)return 0;const Fo=he/(Ge*Ce),Ko=Math.max(-1,Math.min(1,Fo)),Jo=Math.acos(Ko)*(180/Math.PI);return Jo>90?180-Jo:Jo};if(Ft==null||isNaN(Ft)){const It=Mt(g,O,d,l);It!==null&&!isNaN(It)&&(Ft=It)}Ft!=null&&!isNaN(Ft)&&qt(g,O,d,l,Ft,"Sagittal Differentiation","#FFD700",Me,Jt,"Go","Co","N","S",!0)}}}}if(pt&&(F==="leganBurstone"||F==="all")){const c=o("G"),P=o("Sn"),w=o("Pog'"),j=o("Cm"),$=o("UL");if(o("LL"),c&&P&&w){const z=s(c),C=s(P),h=s(w);if(z&&C&&h){const L=N?7:12,b=(N?10:30)*y;let u=p==null?void 0:p["Glabella-Sn-Pog' (Facial Convexity)"];if(u==null&&(u=Et(z,C,h)),rt(z,C,h,u,"Glabella-Sn-Pog'","#FFD700",L,b,"G","Pog'",!1),j&&$){const M=s(j),f=s($);if(M&&f){let S=p==null?void 0:p.NasolabialAngle;S==null&&(S=Et(M,C,f));const B=b*.8;rt(M,C,f,S,"Nasolabial","#FFD700",L,B,"Cm","UL",!1)}}const n=o("Or"),l=o("Po");if(n&&l&&w&&$){const M=s(n),f=s(l),S=s(w),B=s($);if(M&&f&&S&&B){let R=p==null?void 0:p["Z-Angle"];R==null&&(R=180-ne(M,f,S,B)),qt(M,f,S,B,R,"Z-Angle","#FFD700",L,b,"Or","Po","Pog'","UL",!0)}}const d=o("Pn");if(w&&d&&c){const M=s(w),f=s(d),S=s(c);if(M&&f&&S){let B=p==null?void 0:p["Total Soft-Tissue Convexity"];B==null&&(B=Et(M,f,S)),rt(M,f,S,B,"Total Convexity","#FFD700",L,b,"Pog'","G",!1)}}const k=o("Gn'"),g=o("C");if(P&&k&&g){const M=s(P),f=s(k),S=s(g);if(M&&f&&S){let B=p==null?void 0:p["Lower Face Throat Angle"];B==null&&(B=Et(M,f,S)),rt(M,f,S,B,"Lower Face Throat","#FFD700",L,b,"Sn","C",!1)}}const m=o("N'")||o("N"),O=o("Pn");if(m&&O&&w){const M=s(m),f=s(O),S=s(w);if(M&&f&&S){let B=p==null?void 0:p["Facial Contour Angle"];B==null&&(B=Et(M,f,S)),rt(M,f,S,B,"Facial Contour","#FFD700",L,b,"N'","Pog'",!1)}}}}}if(F==="holdaway"||F==="all"){const c=Object.keys(xe).length>0?xe:Wt||{},P=N?7:12,w=(N?10:30)*y,j=o("S"),$=o("N"),z=o("N'"),C=o("Pog"),h=o("Pog'"),L=o("UL"),b=o("UL'"),u=o("LL'"),n=o("LL"),l=o("Or"),d=o("Po");let k,g;if(L&&h&&(k=s(L),g=s(h),k&&g)){const m=r.UL||r["UL'"]||r["UL`"]||r["UL′"]||r.Ls||r.default||"#00D9FF",O=r["Pog`"]||r["Pog'"]||r["Pog′"]||r.Pog||r.default||"#00D9FF";if(se(k,g,m,O),j&&$){const f=s(j),S=s($);if(f&&S){const B=r.S||r.default||"#00D9FF",R=r.N||r.default||"#00D9FF";se(f,S,B,R,st,!1);const it=ne(k,g,f,S);it!==null&&!isNaN(it)&&qt(k,g,f,S,it,"UL-Pog'-SN","#FFD700",P,w,"UL","Pog'","S","N",!0)}}if(b){const f=s(b);if(f){const S=r["UL'"]||r.UL||r.default||"#00D9FF";He(f,g,k,S,st),c["Upper Lip to H-line"]&&_e(f,g,k,c["Upper Lip to H-line"],"UL'-H",S,P)}}const M=u||n;if(M){const f=s(M);if(f){const S=r["LL'"]||r.LL||r.Li||r.default||"#00D9FF";He(f,g,k,S,st),c["Lower Lip to H-line"]&&_e(f,g,k,c["Lower Lip to H-line"],"LL'-H",S,P)}}}if($&&C&&k&&g){const m=s($),O=s(C);if(m&&O){const M=r.N||r.default||"#00D9FF",f=r.Pog||r.default||"#00D9FF";se(m,O,M,f,st,!1);const S=c["H-angle"];if(S!=null&&S!=="")qt(m,O,k,g,parseFloat(S),"H-angle","#FFD700",P,w,"N","Pog","UL","Pog'",!1);else{const B=ne(m,O,k,g);B!==null&&!isNaN(B)&&qt(m,O,k,g,B,"H-angle","#FFD700",P,w,"N","Pog","UL","Pog'",!1)}}}if(l&&d){const m=s(l),O=s(d);if(m&&O){const M=r.Or||r.default||"#00D9FF",f=r.Po||r.default||"#00D9FF";se(m,O,M,f)}}if(z&&h&&l&&d){const m=s(z),O=s(h),M=s(l),f=s(d);if(m&&O&&M&&f){const S=r["N`"]||r["N'"]||r["N′"]||r.N||r.default||"#00D9FF",B=r["Pog`"]||r["Pog'"]||r["Pog′"]||r.Pog||r.default||"#00D9FF";se(m,O,S,B,st,!1);const R=c["Soft Tissue Facial Angle"];R!=null&&R!==""&&qt(m,O,M,f,parseFloat(R),"ST Facial Angle","#FFD700",P,w,"N'","Pog'","Or","Po",!0)}}if(C&&h){const m=s(C),O=s(h);if(m&&O){const M=r.Pog||r.default||"#00D9FF",f=r["Pog`"]||r["Pog'"]||r["Pog′"]||r.Pog||r.default||"#00D9FF";if(se(m,O,M,f,st,!1),c["Soft Tissue Chin Thickness"]){const S=M;Xt(m,O,c["Soft Tissue Chin Thickness"],"Chin Thickness",S,P)}}}}if(pt&&(F==="arnettMcLaughlin"||F==="all")){const c=o("Pn"),P=o("Pog'"),w=o("UL"),j=o("LL"),$=o("G"),z=o("Sn"),C=o("Cm"),h=o("Me'"),L=o("N"),b=N?7:12,u=(N?12:30)*y;if(c&&P){const n=s(c),l=s(P);if(n&&l){const d=r.Pn||r.Prn||r.default||"#00D9FF",k=r["Pog`"]||r["Pog'"]||r["Pog′"]||r.Pog||r.default||"#00D9FF";if(se(n,l,d,k,st,!1),w&&j){const g=s(w),m=s(j);if(g&&m){t.strokeStyle="#FFD700",t.lineWidth=st*.8,t.setLineDash([3*y,3*y]),t.beginPath(),t.moveTo(g.x,g.y);const O=l.x-n.x,M=l.y-n.y,f=Math.sqrt(O*O+M*M);if(f>0){const S=((g.x-n.x)*O+(g.y-n.y)*M)/(f*f),B=n.x+S*O,R=n.y+S*M;t.lineTo(B,R),t.stroke()}if(t.beginPath(),t.moveTo(m.x,m.y),f>0){const S=((m.x-n.x)*O+(m.y-n.y)*M)/(f*f),B=n.x+S*O,R=n.y+S*M;t.lineTo(B,R),t.stroke()}if(t.setLineDash([]),F!=="general"&&F!=="all"){const S=p==null?void 0:p["Upper Lip to E-line"];if(S!=null){const B=(g.x+n.x)/2,R=(g.y+n.y)/2,it=`UL-E: ${typeof S=="number"?S.toFixed(1):S}mm`;Lt(it,B,R,b,"#FFD700")}}if(F!=="general"&&F!=="all"){const S=p==null?void 0:p["Lower Lip to E-line"];if(S!=null){const B=(m.x+n.x)/2,R=(m.y+n.y)/2,it=`LL-E: ${typeof S=="number"?S.toFixed(1):S}mm`;Lt(it,B,R,b,"#FFD700")}}}}}}if(C&&z&&w){const n=s(C),l=s(z),d=s(w);if(n&&l&&d){let k=p==null?void 0:p["Nasolabial Angle"];k==null&&(k=Et(n,l,d));const g=u*.8;rt(n,l,d,k,"Nasolabial","#FFD700",b,g,"Cm","UL",!1)}}if(L&&P){const n=s(L),l=s(P);if(n&&l){const d=l.x-n.x,k=l.y-n.y,g=Math.sqrt(d*d+k*k);if(g>0){const m=Be.getColorForLandmark("N"),O=Be.getColorForLandmark("Pog'");pe&&n&&l&&(()=>{const f=t.createLinearGradient(n.x,n.y,l.x,l.y);return f.addColorStop(0,m),f.addColorStop(1,O),f})(),t.strokeStyle=m,t.lineWidth=st,t.setLineDash([]),t.beginPath(),t.moveTo(n.x,n.y),t.lineTo(l.x,l.y),t.stroke();const M=o("Pog");if(M){const f=s(M);if(f){const S=p==null?void 0:p["Chin Prominence"];if(S!=null){t.strokeStyle="#FFD700",t.lineWidth=st*.8,t.setLineDash([3*y,3*y]),t.beginPath(),t.moveTo(f.x,f.y);const B=((f.x-n.x)*d+(f.y-n.y)*k)/(g*g),R=n.x+B*d,it=n.y+B*k;t.lineTo(R,it),t.stroke(),t.font=`bold ${b*y}px Arial`,t.fillStyle="rgba(0, 0, 0, 0.05)",t.textAlign="center",t.textBaseline="middle",t.setLineDash([]);const Pt=(f.x+R)/2,lt=(f.y+it)/2,at=`Chin: ${typeof S=="number"?S.toFixed(1):S}mm`,D=t.measureText(at);t.fillRect(Pt-D.width/2-4*y,lt-(N?6:8)*y,D.width+8*y,(N?12:16)*y),t.fillStyle="#FFD700",t.fillText(at,Pt,lt)}}}}}}if($&&z&&P){const n=s($),l=s(z),d=s(P);if(n&&l&&d){let k=p==null?void 0:p["Facial Convexity (Glabella-Sn-Pog')"];k==null&&(k=Et(n,l,d)),rt(n,l,d,k,"Facial Convexity","#FFD700",b,u,"G","Pog'",!1)}}if(z&&h){const n=s(z),l=s(h);if(n&&l){const k=((m,O,M,f)=>{const S=r[m]||r.default||"#00D9FF",B=r[O]||r.default||"#00D9FF";if(pe&&M&&f){const R=t.createLinearGradient(M.x,M.y,f.x,f.y);return R.addColorStop(0,S),R.addColorStop(1,B),R}return S})("Sn","Me'",n,l);t.strokeStyle=k,t.lineWidth=st,t.setLineDash([]),t.beginPath(),t.moveTo(n.x,n.y),t.lineTo(l.x,l.y),t.stroke();const g=p==null?void 0:p["Lower Face Height (Sn-Me')"];g!=null&&Xt(n,l,g,"Lower Face Height","#FFD700",b)}}if(C&&z&&w){const n=s(C),l=s(z),d=s(w);if(n&&l&&d){const g=((O,M,f,S)=>{const B=r[O]||r.default||"#00D9FF",R=r[M]||r.default||"#00D9FF";if(pe&&f&&S){const it=t.createLinearGradient(f.x,f.y,S.x,S.y);return it.addColorStop(0,B),it.addColorStop(1,R),it}return B})("Cm","UL",n,d);t.strokeStyle=g,t.lineWidth=st,t.setLineDash([]),t.beginPath(),t.moveTo(n.x,n.y),t.lineTo(d.x,d.y),t.stroke();const m=p==null?void 0:p["Upper Lip Protrusion"];m!=null&&Xt(n,d,m,"Upper Lip Protrusion","#FFD700",b)}}}if(pt&&(F==="softTissueAngular"||F==="all")){const c=N?7:12,P=(N?10:30)*y,w=o("G"),j=o("Sn"),$=o("Pog'"),z=o("Cm"),C=o("UL"),h=o("LL"),L=o("Me'");if(o("Gn'"),h&&$&&L){const u=s(h),n=s($),l=s(L);if(u&&n&&l){let d=p==null?void 0:p["Mentolabial Angle"];d==null&&(d=Et(u,n,l)),rt(u,n,l,d,"Mentolabial","#FFD700",c,P,"LL","Me'",!1)}}const b=o("N'")||o("N");if($&&j&&b){const u=s($),n=s(j),l=s(b);if(u&&n&&l){let d=p==null?void 0:p["Soft Tissue Chin Angle"];d==null&&(d=Et(u,n,l)),rt(u,n,l,d,"ST Chin Angle","#FFD700",c,P,"Pog'","N'",!1)}}if(z&&j&&C){const u=s(z),n=s(j),l=s(C);if(u&&n&&l&&F==="softTissueAngular"){let d=p==null?void 0:p["Upper Lip Angle"];d==null&&(d=Et(u,n,l)),rt(u,n,l,d,"Upper Lip Angle","#FFD700",c,P,"Cm","UL",!1)}}if(j&&h&&$){const u=s(j),n=s(h),l=s($);if(u&&n&&l){let d=p==null?void 0:p["Lower Lip Angle"];d==null&&(d=Et(u,n,l)),rt(u,n,l,d,"Lower Lip Angle","#FFD700",c,P,"Sn","Pog'",!1)}}if(w&&j&&$){const u=s(w),n=s(j),l=s($);if(u&&n&&l&&F==="softTissueAngular"){let d=p==null?void 0:p["Total Facial Convexity"];d==null&&(d=Et(u,n,l)),rt(u,n,l,d,"Total Convexity","#FFD700",c,P,"G","Pog'",!1)}}}if(pt&&p&&(F==="ricketts"||F==="general")){const c=o("Ba"),P=o("Pt"),w=o("Gn");if(c&&P&&w&&p["Facial Axis"]){const at=s(c),D=s(P),Z=s(w);if(at&&D&&Z){const Q=N?7:12,tt=(N?10:30)*y;qt(D,Z,D,at,p["Facial Axis"],"Facial Axis","#FFD700",Q,tt,"Gn","Pt","Ba","Pt")}}const j=o("N"),$=o("Pog"),z=o("Or"),C=o("Po");if(j&&$&&z&&C&&p["Facial Depth"]){const at=s(j),D=s($),Z=s(z),Q=s(C);if(at&&D&&Z&&Q){const tt=N?7:12,J=(N?10:30)*y;qt(at,D,Z,Q,p["Facial Depth"],"Facial Depth","#FFD700",tt,J,"N","Pog","Or","Po")}}const h=o("U1"),L=o("U1A"),b=o("L1"),u=o("L1A");if(h&&L&&b&&u&&p.InterincisalAngle){const at=s(h),D=s(L),Z=s(b),Q=s(u);if(at&&D&&Z&&Q){const tt=N?7:12,J=(N?10:30)*y;qt(at,D,Z,Q,p.InterincisalAngle,"Interincisal","#FFD700",tt,J,"U1","U1A","L1","L1A")}}const n=o("L1"),l=o("LMT"),d=o("UMT"),k=o("S"),g=o("N");if(n&&l&&k&&g&&p["Occlusal Plane Angle"]){const at=s(n),D=s(l),Z=d?s(d):null,Q=s(k),tt=s(g);if(at&&D&&Q&&tt){const J=Z?{x:(D.x+Z.x)/2,y:(D.y+Z.y)/2}:D,ct=N?7:12,Ct=(N?10:30)*y,ht=180-(p["Occlusal Plane Angle"]||0);qt(at,J,Q,tt,ht,"OP-SN","#FFD700",ct,Ct,"L1","LMT","S","N")}}const m=o("Ba"),O=o("N"),M=o("S");if(m&&O&&M&&p["Cranial Deflection"]){const at=s(m),D=s(O),Z=s(M);if(at&&D&&Z){t.lineWidth=st*1.5,t.setLineDash([]),t.strokeStyle=ot("Ba","N",at,D),t.beginPath(),t.moveTo(at.x,at.y),t.lineTo(D.x,D.y),t.stroke();const Q=N?7:12,tt=(N?10:30)*y,J=Math.atan2(at.y-D.y,at.x-D.x),ct=Math.atan2(Z.y-D.y,Z.x-D.x);if(t.strokeStyle="#FFD700",t.lineWidth=st,t.setLineDash([]),t.beginPath(),t.arc(D.x,D.y,tt,J,ct),t.stroke(),t.setLineDash([]),F!=="general"&&F!=="all"){const Ct=D.x,ht=D.y-(tt+(N?18:25)*y),ut=typeof p["Cranial Deflection"]=="number"?p["Cranial Deflection"].toFixed(1):p["Cranial Deflection"],yt=N?`CD: ${ut}°`:`Cranial Deflection: ${ut}°`;Lt(yt,Ct,ht,Q,"#FFD700")}}}const f=o("ANS"),S=o("PNS"),B=o("S"),R=o("N"),it=p["Palatal Plane Angle"];let Pt=null;if(!it&&f&&S&&B&&R){const at=(J,ct,Ct,ht)=>{const ut=ct.x-J.x,yt=ct.y-J.y,Dt=ht.x-Ct.x,zt=ht.y-Ct.y,Yt=ut*Dt+yt*zt,Bt=Math.sqrt(ut*ut+yt*yt),ie=Math.sqrt(Dt*Dt+zt*zt);if(Bt===0||ie===0)return 0;const te=Yt/(Bt*ie),Me=Math.max(-1,Math.min(1,te)),Ae=Math.acos(Me)*(180/Math.PI);return Ae>90?180-Ae:Ae},D=s(f),Z=s(S),Q=s(B),tt=s(R);D&&Z&&Q&&tt&&(Pt=at(D,Z,Q,tt),Pt>90&&(Pt=180-Pt))}let lt=it||Pt;if(lt!=null&&(typeof lt=="string"&&(lt=parseFloat(lt)),typeof lt=="number"&&!isNaN(lt)&&(lt=parseFloat(lt.toFixed(1)))),f&&S&&B&&R&&lt!==void 0&&lt!==null){const at=s(f),D=s(S),Z=s(B),Q=s(R);if(at&&D&&Z&&Q){const tt=N?7:12,J=(N?10:30)*y;qt(at,D,Z,Q,lt,"PP-SN","#FFD700",tt,J,"ANS","PNS","S","N",!0)}}}if(Bo&&pt&&Wt&&(F==="tweed"||F==="general")){const c=Object.keys(xe).length>0?xe:Wt||{},P=o("Or"),w=o("Po"),j=o("Go"),$=o("Me"),z=o("L1A"),C=o("L1");if(P&&w&&j&&$){const h=s(P),L=s(w),b=s(j),u=s($);let n=null,l=null,d="L1",k="Me";if(z&&C){const g=s(z),m=s(C);g&&m&&(n=g,l=m,d="L1A",k="L1")}else if(C){const g=s(C);g&&(n=g,l=u,d="L1",k="Me")}if(h&&L&&b&&u&&n&&l){const g=N?7:12,m=(N?10:30)*y;(c==null?void 0:c.FMA)!==void 0&&(c==null?void 0:c.FMA)!==null&&qt(h,L,b,u,c.FMA,"FMA","#FFD700",g,m,"Or","Po","Go","Me",!0),(c==null?void 0:c.FMIA)!==void 0&&(c==null?void 0:c.FMIA)!==null&&qt(h,L,n,l,c.FMIA,"FMIA","#FFD700",g,m,"Or","Po",d,k,!0),(c==null?void 0:c.IMPA)!==void 0&&(c==null?void 0:c.IMPA)!==null&&qt(u,b,n,l,c.IMPA,"IMPA","#FFD700",g,m,"Go","Me",d,k,!0)}}}t.setLineDash([])}const G=["Li","LL","UL","Sn","Pn","Cm","cm","CM","columella","Columella","LL'","UL'","LMT","UMT","Pog'","Gn'","Me'","N'","Pog′","Gn′","Me′","N′"],x=W=>W==="p1"||W==="p2"?!1:G.includes(W)?!0:W.endsWith("'")||W.endsWith("′"),_=(W=>{const K=new Set(["p1","p2","P1","P2"]);if(["N","S","Go","Pog","Me","A","B","Or","Po","Ar","Pt","ANS","PNS"].forEach(E=>{K.add(E),K.add(E.toLowerCase()),K.add(E.toUpperCase())}),W==="all")return null;const bt={steiner:["S","N","A","B","Pog","Go","Gn","Me","Or","Po","ANS","PNS","U1","U1A","L1","L1A"],ricketts:["N","Pog","Pt","Ba","Go","Me","Or","Po","ANS","PNS","L1","LMT","Pn","Pog'","Pog′","Gn","U1A","L1A","UMT"],mcnamara:["N","A","Pog","S","Go","Me","Gn","U1","L1","Co","Ar"],tweed:["Or","Po","Go","Me","L1A","L1","L1a"],jarabak:["S","N","ANS","Go","Me","Gn","Ar","Co"],sassouni:["S","N","Me","Go","Ar","Co","L1","LMT","ANS","PNS"],wits:["A","B","L1","LMT"],leganBurstone:["G","Sn","Pog'","Pog′","Cm","UL","LL","Or","Po","Pn","Prn","Gn'","Gn′","C","N'","N′","Me'","Me′"],arnettMcLaughlin:["Pn","Prn","Pog'","Pog′","UL","LL","G","Sn","Cm","Me'","Me′","N"],holdaway:["N","N'","N′","Pog","Pog'","Pog′","UL","LL","UL'","UL′","LL'","LL′","Or","Po"],softTissueAngular:["G","Sn","Pog'","Pog′","Cm","UL","LL","Me'","Me′","Gn'","Gn′","N'","N′","Li","Ls"]}[W];return bt&&bt.forEach(E=>{K.add(E),K.add(E.toLowerCase()),K.add(E.toUpperCase()),E.includes("'")&&K.add(E.replace(/'/g,"′")),E.includes("′")&&K.add(E.replace(/′/g,"'"))}),K})(F),wt=W=>{if(W==="p1"||W==="p2"||W==="P1"||W==="P2")return!0;if(_===null)return!(oe==="hard-tissue-only"&&x(W));const K=W.toLowerCase(),o=W.toUpperCase(),St=[W,K,o,W.charAt(0).toUpperCase()+W.slice(1).toLowerCase(),W.replace(/'/g,"′"),W.replace(/′/g,"'")];if(_.has(W))return!0;for(const bt of St)if(_.has(bt))return!0;for(const bt of _){const E=bt.toLowerCase(),X=W.toLowerCase();if(X===E||(E.includes("pog'")||E.includes("pog′"))&&(X.includes("pog'")||X.includes("pog′"))||(E.includes("n'")||E.includes("n′"))&&(X.includes("n'")||X.includes("n′"))||(E.includes("me'")||E.includes("me′"))&&(X.includes("me'")||X.includes("me′"))||(E.includes("gn'")||E.includes("gn′"))&&(X.includes("gn'")||X.includes("gn′"))||(E.includes("ul'")||E.includes("ul′"))&&(X.includes("ul'")||X.includes("ul′"))||(E.includes("ll'")||E.includes("ll′"))&&(X.includes("ll'")||X.includes("ll′"))||(E==="pog'"||E==="pog′")&&(X.includes("pogonion")||X.includes("pog"))||(E==="n'"||E==="n′")&&X.includes("nasion")&&X.includes("soft")||(E==="ul"||E==="ul'")&&X.includes("labiale")&&X.includes("superius")||(E==="ll"||E==="ll'")&&X.includes("labiale")&&X.includes("inferius")||E==="cm"&&X.includes("columella")||(E==="pn"||E==="prn")&&X.includes("pronasale")||E==="g"&&X.includes("glabella")||E==="sn"&&X.includes("subnasale"))return!0}return!1};Object.entries(V).forEach(([W,K])=>{if(!wt(W)||oe==="hard-tissue-only"&&x(W))return;const o=s(K);if(!o)return;const St=Se===W,bt=So.current[W]||1,E=Go*bt;t.fillStyle=Be.getColorForLandmark(W),t.beginPath(),t.arc(o.x,o.y,E,0,2*Math.PI),t.fill(),t.strokeStyle=St?"#FFD700":"#FFFFFF";const X=wo*bt,gt=X<=2?.5:X<=4?1:St?1.5:1,Gt=(N?gt/2:gt)*y;if(t.lineWidth=Gt,t.beginPath(),t.arc(o.x,o.y,E,0,2*Math.PI),t.stroke(),To&&Ee){const ot=(N?9:14)*y;t.font=`bold ${ot}px Arial, sans-serif`,t.fillStyle="#FFFFFF",t.textAlign="center",t.textBaseline="bottom";const p=`‭${W}‬`;t.strokeStyle="rgba(0, 0, 0, 0.7)";const c=N?1:2;t.lineWidth=c*y;const P=N?4:10,w=o.y-E-P*y;t.strokeText(p,o.x,w),t.fillText(p,o.x,w),t.textAlign="left",t.textBaseline="alphabetic"}})}if(Je.length>0){t.strokeStyle="#00FF00";const G=N?1:2;t.lineWidth=G*y,t.setLineDash([]),t.beginPath(),Je.forEach((x,Y)=>{Y===0?t.moveTo(x.x,x.y):t.lineTo(x.x,x.y)}),t.stroke(),Je.forEach(x=>{t.fillStyle="#00FF00",t.beginPath();const _=(N?2:4)*y;t.arc(x.x,x.y,_,0,2*Math.PI),t.fill()})}if(Ze.forEach(G=>{t.strokeStyle=G.color||"#FF00FF";const x=N?1:2;t.lineWidth=x*y,t.setLineDash([]),t.beginPath(),G.points.forEach((Y,_)=>{_===0?t.moveTo(Y.x,Y.y):t.lineTo(Y.x,Y.y)}),G.closed&&t.closePath(),t.stroke()}),pt&&(F==="general"||F==="all")){const G=Object.keys(xe).length>0?xe:Wt||{};if(Object.keys(G).length>0){const x=N?8:11,Y=x*1.4,_=8*y,wt=H*.3,W=_,K=_,o=Object.entries(G).filter(([X,gt])=>gt!=null&&gt!=="").sort(([X],[gt])=>X.localeCompare(gt)).slice(0,30),St=o.length*Y+_*2,bt=Math.min(wt,200*y);t.fillStyle="rgba(0, 0, 0, 0.7)",t.fillRect(W,K,bt,St),t.strokeStyle="#FFD700",t.lineWidth=1*y,t.strokeRect(W,K,bt,St),t.fillStyle="#FFFFFF",t.font=`${x}px Arial`,t.textAlign="left",t.textBaseline="top";let E=K+_;o.forEach(([X,gt])=>{const Gt=typeof gt=="number"?gt.toFixed(1):gt,Rt=X.includes("Angle")||X.includes("زاویه")||X.includes("°")?"°":X.includes("mm")||X.includes("Distance")||X.includes("Height")||X.includes("Length")?"mm":"",ot=`${X}: ${Gt}${Rt}`;if(t.measureText(ot).width>bt-_*2){const c=Math.floor((bt-_*2)/(x*.6)),P=ot.length>c?`${ot.substring(0,c-3)}...`:ot;t.fillText(P,W+_,E)}else t.fillText(ot,W+_,E);E+=Y})}}},[ue,y,ae,V,To,so,no,je,r,Io,Se,Je,Ze,s,Wt,xe,pt,Bo,pe,eo,Ee,Nt.palette.mode,N,oe,st,Go,wo,F,de,Et,ne,Be]);I.useEffect(()=>{if(!ue)return;const e={};Object.keys(V).forEach(U=>{e[U]=U===Io?1.5:1});let i=null;const t=()=>{let U=!1;Object.keys(e).forEach(A=>{const a=So.current[A]||1,H=e[A],q=H-a;Math.abs(q)>.01?(So.current[A]=a+q*.3,U=!0):So.current[A]=H}),U&&(Re(),i=requestAnimationFrame(t))};return i=requestAnimationFrame(t),()=>{i&&cancelAnimationFrame(i)}},[Io,ue,V,Re]);const ze=I.useRef(null);I.useEffect(()=>{if(ue&&!Ie)return ze.current&&cancelAnimationFrame(ze.current),ze.current=requestAnimationFrame(()=>{Re(),ze.current=null}),()=>{ze.current&&(cancelAnimationFrame(ze.current),ze.current=null)}},[V,ae,y,no,Do,je,To,so,pe,r,Bo,Wt,ue,Je,Ze,Ie,Re,F,pt,xe,Ve,eo,Ee]),I.useEffect(()=>{const e=()=>{ue&&Re()};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[Re,ue]);const yo=I.useCallback(e=>{if(e==="p1"||e==="p2"||e==="P1"||e==="P2")return!0;const i=["Li","LL","UL","Sn","Pn","Cm","cm","CM","columella","Columella","LL'","UL'","LMT","UMT","Pog'","Gn'","Me'","N'","Pog′","Gn′","Me′","N′"],t=q=>q==="p1"||q==="p2"?!1:i.includes(q)?!0:q.endsWith("'")||q.endsWith("′"),A=(q=>{const v=new Set(["p1","p2","P1","P2"]);if(["N","S","Go","Pog","Me","A","B","Or","Po","Ar","Pt","ANS","PNS"].forEach(rt=>{v.add(rt),v.add(rt.toLowerCase()),v.add(rt.toUpperCase())}),q==="all")return null;const Kt={steiner:["S","N","A","B","Pog","Go","Gn","Me","Or","Po","ANS","PNS","U1","U1A","L1","L1A"],ricketts:["N","Pog","Pt","Ba","Go","Me","Or","Po","ANS","PNS","L1","LMT","Pn","Pog'","Pog′","UL","LL","Ls","Li"],mcnamara:["N","A","Pog","S","Go","Me","Gn","U1","L1","Co","Ar"],tweed:["Or","Po","Go","Me","L1A","L1","L1a"],jarabak:["S","N","Go","Me","Gn","Ar","Co"],sassouni:["S","N","Me","Go","Ar","Co","L1","LMT","ANS","PNS"],wits:["A","B","L1","LMT"],leganBurstone:["G","Sn","Pog'","Pog`","Pog′","Cm","UL","LL","Or","Po","Pn","Prn","Gn'","Gn`","Gn′","C","N'","N`","N′","Me'","Me`","Me′"],arnettMcLaughlin:["Pn","Prn","Pog'","Pog`","Pog′","UL","LL","G","Sn","Cm","Me'","Me`","Me′","N"],holdaway:["N","N'","N`","N′","Pog","Pog'","Pog`","Pog′","UL","LL","UL'","UL`","UL′","LL'","LL`","LL′","Or","Po"],softTissueAngular:["G","Sn","Pog'","Pog`","Pog′","Cm","UL","LL","Me'","Me`","Me′","Gn'","Gn`","Gn′","N'","N`","N′","Li","Ls"]}[q];return Kt&&Kt.forEach(rt=>{v.add(rt),v.add(rt.toLowerCase()),v.add(rt.toUpperCase()),rt.includes("'")&&(v.add(rt.replace(/'/g,"′")),v.add(rt.replace(/'/g,"`"))),rt.includes("′")&&(v.add(rt.replace(/′/g,"'")),v.add(rt.replace(/′/g,"`"))),rt.includes("`")&&(v.add(rt.replace(/`/g,"'")),v.add(rt.replace(/`/g,"′")))}),v})(F);if(A===null)return!(oe==="hard-tissue-only"&&t(e));const a=e.toLowerCase(),H=[e,a,e.toUpperCase(),e.charAt(0).toUpperCase()+e.slice(1).toLowerCase(),e.replace(/'/g,"′"),e.replace(/′/g,"'"),e.replace(/`/g,"'"),e.replace(/'/g,"`"),e.replace(/`/g,"′"),e.replace(/′/g,"`")];if(A.has(e))return!0;for(const q of H)if(A.has(q))return!0;for(const q of A){const v=q.toLowerCase();if(a===v||(v.includes("pog'")||v.includes("pog′"))&&(a.includes("pog'")||a.includes("pog′"))||(v.includes("n'")||v.includes("n′"))&&(a.includes("n'")||a.includes("n′"))||(v.includes("me'")||v.includes("me′"))&&(a.includes("me'")||a.includes("me′"))||(v.includes("gn'")||v.includes("gn′"))&&(a.includes("gn'")||a.includes("gn′"))||(v.includes("ul'")||v.includes("ul′"))&&(a.includes("ul'")||a.includes("ul′"))||(v.includes("ll'")||v.includes("ll′"))&&(a.includes("ll'")||a.includes("ll′"))||(v==="pog'"||v==="pog′")&&(a.includes("pogonion")||a.includes("pog"))||(v==="n'"||v==="n′")&&a.includes("nasion")&&a.includes("soft")||(v==="ul"||v==="ul'")&&a.includes("labiale")&&a.includes("superius")||(v==="ll"||v==="ll'")&&a.includes("labiale")&&a.includes("inferius")||v==="cm"&&a.includes("columella")||(v==="pn"||v==="prn")&&a.includes("pronasale")||v==="g"&&a.includes("glabella")||v==="sn"&&a.includes("subnasale"))return!0}return!1},[F,oe]),Zn=e=>{var q;if(N)return;const i=Le.current,t=((q=kt.current)==null?void 0:q.getBoundingClientRect())||i.getBoundingClientRect(),U=e.clientX-t.left,A=e.clientY-t.top,a=bo(U,A);a&&(a.includes("`")||a.includes("'")||a.includes("′"))&&console.log("🔍 [Debug] Clicked soft tissue landmark:",a,"| All landmarks:",Object.keys(V).filter(v=>v.includes("`")||v.includes("'")||v.includes("′")));const H=a?ln(a):null;a&&H&&(a.includes("`")||a.includes("'")||a.includes("′"))&&console.log("🔍 [Debug] Normalized:",a,"->",H,"| Has description:",!!mt[H],"| Should show:",yo(a)),H&&mt[H]&&Vt&&yo(a)?(console.log("🖥️ [Snackbar] Opening snackbar for landmark:",a,"->",H),Ro(a),zo(H),Eo(!0),e.stopPropagation()):a&&(a.includes("`")||a.includes("'")||a.includes("′"))&&console.log("❌ [Debug] Snackbar NOT opened for:",a,{normalized:H,hasDescription:!!mt[H],readOnly:Vt,shouldShow:yo(a)})},Qn=e=>{var q;const i=Le.current,t=((q=kt.current)==null?void 0:q.getBoundingClientRect())||i.getBoundingClientRect(),U=e.clientX-t.left,A=e.clientY-t.top,a=bo(U,A),H=a?ln(a):null;if(H&&mt[H]&&N&&Vt&&yo(a)){console.log("📱 [Snackbar] Opening snackbar for landmark:",a,"->",H),Ro(a),zo(H),Eo(!0);return}if(a&&!Vt){en(a),zn(a);const v=V[a];v&&(on.current={x:v.x,y:v.y},ho.current=!1)}else if(Hn&&!Vt){const v=rn(U,A);v&&(xo(v),po(!0),_n(!1))}else qn&&!Vt?Yn([...Je,{x:U,y:A}]):Vt||(lo(!0),uo({x:e.clientX-ae.x,y:e.clientY-ae.y}))};I.useEffect(()=>{go.current=V},[V]);const ts=e=>{var a;const i=Le.current,t=((a=kt.current)==null?void 0:a.getBoundingClientRect())||i.getBoundingClientRect(),U=e.clientX-t.left,A=e.clientY-t.top;if(Ie&&!Vt)Ke.current&&cancelAnimationFrame(Ke.current),Ke.current=requestAnimationFrame(()=>{const H=rn(U,A);if(H&&Ie){const q=go.current[Ie];q&&(Math.abs(q.x-H.x)>.1||Math.abs(q.y-H.y)>.1)&&(ho.current=!0),We(v=>{const vt={...v,[Ie]:{...v[Ie],x:H.x,y:H.y}};return go.current=vt,vt}),requestAnimationFrame(()=>{Re()})}}),jo({show:!1,text:"",x:0,y:0});else if(No&&!Vt)ko({x:e.clientX-co.x,y:e.clientY-co.y}),jo({show:!1,text:"",x:0,y:0});else{const H=bo(U,A);En(H),Rn(null),jo({show:!1,text:"",x:0,y:0}),i.style.cursor="default"}},cn=()=>{Ke.current&&(cancelAnimationFrame(Ke.current),Ke.current=null),Ie&&ho.current&&setTimeout(()=>{const i=go.current;i&&Object.keys(i).length>0&&(dt==null||dt(i))},10),en(null),on.current=null,ho.current=!1,lo(!1)},es=e=>{var H;if(e.preventDefault(),Vt)return;const i=Le.current,t=((H=kt.current)==null?void 0:H.getBoundingClientRect())||i.getBoundingClientRect(),U=e.clientX-t.left,A=e.clientY-t.top,a=bo(U,A);a&&nn({landmark:a,mouseX:e.clientX,mouseY:e.clientY})},_o=()=>{nn(null)},os=()=>{if(_t!=null&&_t.landmark){const e={...V};delete e[_t.landmark],We(e),dt==null||dt(e)}_o()},ns=e=>{_t!=null&&_t.landmark&&vo({...r,[_t.landmark]:e}),_o()},dn=()=>{if(io&&Wo){const e={...V,[io]:{x:Wo.x,y:Wo.y,confidence:1}};We(e),dt==null||dt(e)}po(!1),Po(""),xo(null)};return T.jsxs(T.Fragment,{children:[T.jsxs(Ue,{spacing:2,children:[!Vt&&T.jsx(yn,{children:T.jsx(Fn,{children:T.jsxs(Ue,{spacing:2,sx:{minHeight:120},children:[T.jsx(Ue,{direction:"row",spacing:2,alignItems:"center",flexWrap:"wrap",justifyContent:"center",children:T.jsxs(Ue,{direction:"row",spacing:1,children:[T.jsx(Oe,{size:"small",onClick:()=>ro(e=>Math.min(e+.2,5)),sx:{minWidth:40,minHeight:40},children:T.jsx(ke,{icon:"solar:magnifer-zoom-in-linear"})}),T.jsx(Oe,{size:"small",onClick:()=>ro(e=>Math.max(e-.2,.5)),sx:{minWidth:40,minHeight:40},children:T.jsx(ke,{icon:"solar:magnifer-zoom-out-linear"})}),T.jsx(Sn,{title:Ee?"مخفی کردن لندمارک":"نمایش لندمارک",children:T.jsx(Oe,{size:"small",onClick:()=>{jn(!Ee)},color:Ee?"primary":"default",sx:{minWidth:40,minHeight:40},children:T.jsx(ke,{icon:Ee?"solar:tag-bold":"solar:tag-linear"})})}),T.jsx(Sn,{title:"خطوط",children:T.jsx(Oe,{size:"small",onClick:()=>Wn(!so),sx:{color:so?"primary.main":"text.secondary",minWidth:40,minHeight:40},children:T.jsx(ke,{icon:"solar:hamburger-menu-linear",width:20})})})]})}),T.jsx(Ue,{direction:"row",spacing:3,alignItems:"center",flexWrap:"wrap",justifyContent:"center",children:T.jsxs(Ue,{direction:"row",spacing:1,alignItems:"center",children:[T.jsx(Ue,{direction:"row",spacing:1,children:An.map(e=>T.jsx(Oe,{size:"small",onClick:()=>{Se?vo({...r,[Se]:e}):On(e)},sx:{width:24,height:24,minWidth:24,minHeight:24,bgcolor:e,border:"1px solid",borderColor:"divider",flexShrink:0,"&:hover":{bgcolor:e}}},e))}),T.jsx(Oe,{size:"small",onClick:e=>Oo(e.currentTarget),sx:{width:28,height:28,minWidth:28,minHeight:28,border:"2px solid",borderColor:"divider","&:hover":{opacity:.8},display:"flex",alignItems:"center",justifyContent:"center"},children:T.jsx(Te,{sx:{width:20,height:20,minWidth:20,minHeight:20,display:"flex",alignItems:"center",justifyContent:"center"},children:T.jsx(ke,{icon:"carbon:color-palette",width:20,sx:{color:Nt.palette.mode==="dark"?"rgba(255, 255, 255, 0.85)":void 0}})})})]})})]})})}),T.jsx(Te,{ref:kt,sx:{width:"100%",maxWidth:"100%",minWidth:0,height:ue?Ve:"auto",bgcolor:"transparent",borderRadius:{xs:2,sm:2},overflow:"hidden",position:"relative",display:"block",boxSizing:"border-box"},children:T.jsx("canvas",{id:"cephalometric-canvas",ref:Le,onClick:Zn,onMouseDown:Qn,onMouseMove:ts,onMouseUp:cn,onMouseLeave:cn,onContextMenu:es,style:{width:"100%",height:"100%",cursor:"default",borderRadius:"inherit",display:"block",maxWidth:"100%",maxHeight:"100%"}})}),Ze.length>0&&T.jsx(yn,{children:T.jsxs(Fn,{children:[T.jsx($e,{variant:"h6",sx:{mb:1},children:"🎨 ساختارهای ترسیم شده"}),T.jsx(Ue,{spacing:1,children:Ze.map((e,i)=>T.jsxs(Te,{sx:{p:1,borderRadius:1,bgcolor:"background.neutral",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[T.jsxs(Ue,{direction:"row",spacing:1,alignItems:"center",children:[T.jsx(Te,{sx:{width:20,height:20,bgcolor:e.color,borderRadius:.5}}),T.jsx($e,{variant:"body2",children:e.name}),T.jsxs($e,{variant:"caption",color:"text.secondary",children:["(",e.points.length," نقطه)"]})]}),T.jsx(Oe,{size:"small",onClick:()=>{Xn(Ze.filter((t,U)=>U!==i))},children:T.jsx(ke,{icon:"solar:trash-bin-trash-bold"})})]},i))})]})}),T.jsxs(Cn,{open:_t!==null,onClose:_o,anchorReference:"anchorPosition",anchorPosition:_t!==null?{top:_t.mouseY,left:_t.mouseX}:void 0,PaperProps:{sx:{minWidth:180}},children:[T.jsxs(Te,{sx:{px:2,py:1},children:[T.jsxs($e,{variant:"caption",sx:{color:"text.secondary",display:"block",mb:1},children:["انتخاب رنگ ",_t==null?void 0:_t.landmark,":"]}),T.jsx(Cs,{colors:An,selected:r[_t==null?void 0:_t.landmark]||r.default,onSelectColor:ns})]}),T.jsx(ms,{sx:{my:1}}),T.jsxs(Co,{onClick:os,sx:{color:"inherit"},children:[T.jsx(ke,{icon:"solar:trash-bin-trash-bold",sx:{mr:1,color:"inherit"}}),"حذف ",_t==null?void 0:_t.landmark]})]}),T.jsxs(Cn,{open:!!sn,anchorEl:sn,onClose:()=>Lo(null),PaperProps:{sx:{minWidth:150}},children:[T.jsxs(Co,{onClick:()=>{Uo("solid"),Lo(null)},selected:je==="solid",children:[T.jsx(ke,{icon:"material-symbols:line-style",sx:{mr:1}}),"خط توپر"]}),T.jsxs(Co,{onClick:()=>{Uo("dashed"),Lo(null)},selected:je==="dashed",children:[T.jsx(ke,{icon:"ph:minus-bold",sx:{mr:1}}),"خط چین"]}),T.jsxs(Co,{onClick:()=>{Uo("dotted"),Lo(null)},selected:je==="dotted",children:[T.jsx(ke,{icon:"bi:three-dots",sx:{mr:1}}),"نقطه چین"]})]}),T.jsx(Ss,{open:!!an,anchorEl:an,onClose:()=>Oo(null),anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},children:T.jsxs(Te,{sx:{p:1.5},children:[T.jsxs($e,{variant:"caption",sx:{mb:1,display:"block"},children:["انتخاب رنگ نقطه ",Se?`(${Se})`:""]}),T.jsx(Te,{sx:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:1,width:160,justifyItems:"center"},children:Hs.map(e=>T.jsx(Oe,{onClick:()=>{Se&&vo({...r,[Se]:e}),Oo(null)},disabled:!Se,sx:{width:24,height:24,minWidth:24,minHeight:24,padding:0,bgcolor:e,border:"1px solid",borderColor:"divider",opacity:Se?1:.5,"&:hover":{bgcolor:e,opacity:Se?.8:.5}}},e))})]})}),T.jsxs(bs,{open:$n,onClose:()=>{po(!1),Po(""),xo(null)},maxWidth:"xs",fullWidth:!0,children:[T.jsx(Ms,{children:"افزودن نقطه جدید"}),T.jsx(As,{children:T.jsx(ks,{autoFocus:!0,fullWidth:!0,label:"نام نقطه",placeholder:"مثلاً: M1, Landmark1, ...",value:io,onChange:e=>Po(e.target.value),onKeyPress:e=>{e.key==="Enter"&&io&&dn()},sx:{mt:2}})}),T.jsxs(Ns,{children:[T.jsx(bn,{onClick:()=>{po(!1),Po(""),xo(null)},children:"لغو"}),T.jsx(bn,{onClick:dn,variant:"contained",disabled:!io,children:"تایید"})]})]})]}),T.jsx(ys,{children:T.jsx(zs,{open:Vn,autoHideDuration:null,onClose:()=>{Eo(!1)},TransitionComponent:vn,TransitionProps:{timeout:{enter:300,exit:300},onExited:()=>{Ro(null),zo(null)}},anchorOrigin:{vertical:"bottom",horizontal:"center"},sx:{position:"fixed",bottom:N?"16px":"24px",left:"50%",transform:"translateX(-50%)",zIndex:9999,...N&&{maxWidth:"90vw",width:"90vw"}},message:mo&&mt[mo]?T.jsxs(Te,{sx:{py:.5,minHeight:"60px"},children:[T.jsx($e,{variant:"subtitle2",sx:{fontWeight:"bold",mb:.5},children:mt[mo].name}),T.jsx($e,{variant:"body2",sx:{color:"text.secondary"},children:mt[mo].description})]}):T.jsx(Te,{sx:{minHeight:"60px"}}),ContentProps:{sx:{maxWidth:N?"90vw":400,width:N?"90vw":"auto",minHeight:"60px",bgcolor:"background.paper",color:"text.primary",boxShadow:e=>e.customShadows.z8,whiteSpace:"pre-wrap",borderRadius:1}}},Kn||"empty")})]})}Xs.propTypes={imageUrl:ve.string.isRequired,landmarks:ve.object,imageSize:ve.shape({width:ve.number,height:ve.number}),onLandmarksChange:ve.func,showMeasurements:ve.bool,showCoordinateSystem:ve.bool,readOnly:ve.bool};export{Xs as A};
