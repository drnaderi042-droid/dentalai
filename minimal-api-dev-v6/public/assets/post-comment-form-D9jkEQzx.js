import{bx as fe,by as xe,r,aS as he,b as be,aT as q,bC as Ie,aU as m,dV as Ue,bF as Be,j as t,aV as O,aW as H,bW as ze,aX as J,aY as ge,bJ as Ke,cV as Ne,dL as Pe,c as _e,B as ye,aw as Ve,e as je,T as U,S as y,aB as We,aK as qe,aL as He,aG as Ge,as as Je,I as G,v as ne,cI as Ze,d as ve,ar as te,dq as Xe,h as Ye,k as Qe,dA as et,p as tt,bf as re,dD as le,o as ee}from"./index-BSItzkt3.js";import{t as Ce,z as F}from"./zod-BOXuI70n.js";import{u as De,a as Se,F as w}from"./form-provider-IFaCVrX4.js";import"./image-BuqYs7tq.js";import"./editor-cOR4tKCy.js";import{s as ce}from"./schema-helper-DeS_g_Vm.js";import{M as ot}from"./markdown-DkFU1EoS.js";import{E as st}from"./empty-content-Cx4hswZg.js";import{Z as it}from"./Zoom-DF_Z3Wyp.js";import{F as Te}from"./Fab-y6_dLooR.js";import{D as at}from"./dialogTitleClasses-BJYaWiXv.js";import{L as oe}from"./LoadingButton-HyVDRRh6.js";import{F as pe}from"./FormControlLabel-CtXEP1QR.js";import{C as de}from"./Card-BqWDE3fr.js";import{C as me}from"./CardHeader-CavtfEuu.js";import{C as ue}from"./Chip-CHY_XJWs.js";function nt(e){return xe("MuiSpeedDial",e)}const V=fe("MuiSpeedDial",["root","fab","directionUp","directionDown","directionLeft","directionRight","actions","actionsClosed"]),rt=["ref"],lt=["ariaLabel","FabProps","children","className","direction","hidden","icon","onBlur","onClose","onFocus","onKeyDown","onMouseEnter","onMouseLeave","onOpen","open","openIcon","TransitionComponent","transitionDuration","TransitionProps"],ct=["ref"],pt=e=>{const{classes:o,open:i,direction:a}=e,c={root:["root",`direction${J(a)}`],fab:["fab"],actions:["actions",!i&&"actionsClosed"]};return ge(c,nt,o)};function I(e){if(e==="up"||e==="down")return"vertical";if(e==="right"||e==="left")return"horizontal"}const k=32,W=16,dt=O("div",{name:"MuiSpeedDial",slot:"Root",overridesResolver:(e,o)=>{const{ownerState:i}=e;return[o.root,o[`direction${J(i.direction)}`]]}})(({theme:e,ownerState:o})=>m({zIndex:(e.vars||e).zIndex.speedDial,display:"flex",alignItems:"center",pointerEvents:"none"},o.direction==="up"&&{flexDirection:"column-reverse",[`& .${V.actions}`]:{flexDirection:"column-reverse",marginBottom:-k,paddingBottom:W+k}},o.direction==="down"&&{flexDirection:"column",[`& .${V.actions}`]:{flexDirection:"column",marginTop:-k,paddingTop:W+k}},o.direction==="left"&&{flexDirection:"row-reverse",[`& .${V.actions}`]:{flexDirection:"row-reverse",marginRight:-k,paddingRight:W+k}},o.direction==="right"&&{flexDirection:"row",[`& .${V.actions}`]:{flexDirection:"row",marginLeft:-k,paddingLeft:W+k}})),mt=O(Te,{name:"MuiSpeedDial",slot:"Fab",overridesResolver:(e,o)=>o.fab})(()=>({pointerEvents:"auto"})),ut=O("div",{name:"MuiSpeedDial",slot:"Actions",overridesResolver:(e,o)=>{const{ownerState:i}=e;return[o.actions,!i.open&&o.actionsClosed]}})(({ownerState:e})=>m({display:"flex",pointerEvents:"auto"},!e.open&&{transition:"top 0s linear 0.2s",pointerEvents:"none"})),ft=r.forwardRef(function(o,i){const a=he({props:o,name:"MuiSpeedDial"}),c=be(),p={enter:c.transitions.duration.enteringScreen,exit:c.transitions.duration.leavingScreen},{ariaLabel:d,FabProps:{ref:f}={},children:j,className:u,direction:D="up",hidden:g=!1,icon:v,onBlur:L,onClose:x,onFocus:S,onKeyDown:A,onMouseEnter:n,onMouseLeave:l,onOpen:b,open:R,TransitionComponent:B=it,transitionDuration:z=p,TransitionProps:we}=a,K=q(a.FabProps,rt),Fe=q(a,lt),[C,M]=Ie({controlled:R,default:!1,name:"SpeedDial",state:"open"}),N=m({},a,{open:C,direction:D}),P=pt(N),$=Ue(),Z=r.useRef(0),X=r.useRef(),E=r.useRef([]);E.current=[E.current[0]];const Ae=r.useCallback(s=>{E.current[0]=s},[]),ke=Be(f,Ae),Le=(s,h)=>T=>{E.current[s+1]=T,h&&h(T)},Re=s=>{A&&A(s);const h=s.key.replace("Arrow","").toLowerCase(),{current:T=h}=X;if(s.key==="Escape"){M(!1),E.current[0].focus(),x&&x(s,"escapeKeyDown");return}if(I(h)===I(T)&&I(h)!==void 0){s.preventDefault();const Q=h===T?1:-1,_=Ke(Z.current+Q,0,E.current.length-1);E.current[_].focus(),Z.current=_,X.current=T}};r.useEffect(()=>{C||(Z.current=0,X.current=void 0)},[C]);const se=s=>{s.type==="mouseleave"&&l&&l(s),s.type==="blur"&&L&&L(s),$.clear(),s.type==="blur"?$.start(0,()=>{M(!1),x&&x(s,"blur")}):(M(!1),x&&x(s,"mouseLeave"))},Ee=s=>{K.onClick&&K.onClick(s),$.clear(),C?(M(!1),x&&x(s,"toggle")):(M(!0),b&&b(s,"toggle"))},ie=s=>{s.type==="mouseenter"&&n&&n(s),s.type==="focus"&&S&&S(s),$.clear(),C||$.start(0,()=>{M(!0),b&&b(s,{focus:"focus",mouseenter:"mouseEnter"}[s.type])})},Y=d.replace(/^[^a-z]+|[^\w:.-]+/gi,""),ae=r.Children.toArray(j).filter(s=>r.isValidElement(s)),Me=ae.map((s,h)=>{const T=s.props,{FabProps:{ref:Q}={},tooltipPlacement:_}=T,Oe=q(T.FabProps,ct),$e=_||(I(D)==="vertical"?"left":"top");return r.cloneElement(s,{FabProps:m({},Oe,{ref:Le(h,Q)}),delay:30*(C?h:ae.length-h),open:C,tooltipPlacement:$e,id:`${Y}-action-${h}`})});return t.jsxs(dt,m({className:H(P.root,u),ref:i,role:"presentation",onKeyDown:Re,onBlur:se,onFocus:ie,onMouseEnter:ie,onMouseLeave:se,ownerState:N},Fe,{children:[t.jsx(B,m({in:!g,timeout:z,unmountOnExit:!0},we,{children:t.jsx(mt,m({color:"primary","aria-label":d,"aria-haspopup":"true","aria-expanded":C,"aria-controls":`${Y}-actions`},K,{onClick:Ee,className:H(P.fab,K.className),ref:ke,ownerState:N,children:r.isValidElement(v)&&ze(v,["SpeedDialIcon"])?r.cloneElement(v,{open:C}):v}))})),t.jsx(ut,{id:`${Y}-actions`,role:"menu","aria-orientation":I(D),className:H(P.actions,!C&&P.actionsClosed),ownerState:N,children:Me})]}))});function xt(e){return xe("MuiSpeedDialAction",e)}const ht=fe("MuiSpeedDialAction",["fab","fabClosed","staticTooltip","staticTooltipClosed","staticTooltipLabel","tooltipPlacementLeft","tooltipPlacementRight"]),bt=["className","delay","FabProps","icon","id","open","TooltipClasses","tooltipOpen","tooltipPlacement","tooltipTitle"],gt=e=>{const{open:o,tooltipPlacement:i,classes:a}=e,c={fab:["fab",!o&&"fabClosed"],staticTooltip:["staticTooltip",`tooltipPlacement${J(i)}`,!o&&"staticTooltipClosed"],staticTooltipLabel:["staticTooltipLabel"]};return ge(c,xt,a)},yt=O(Te,{name:"MuiSpeedDialAction",slot:"Fab",skipVariantsResolver:!1,overridesResolver:(e,o)=>{const{ownerState:i}=e;return[o.fab,!i.open&&o.fabClosed]}})(({theme:e,ownerState:o})=>m({margin:8,color:(e.vars||e).palette.text.secondary,backgroundColor:(e.vars||e).palette.background.paper,"&:hover":{backgroundColor:e.vars?e.vars.palette.SpeedDialAction.fabHoverBg:Pe(e.palette.background.paper,.15)},transition:`${e.transitions.create("transform",{duration:e.transitions.duration.shorter})}, opacity 0.8s`,opacity:1},!o.open&&{opacity:0,transform:"scale(0)"})),jt=O("span",{name:"MuiSpeedDialAction",slot:"StaticTooltip",overridesResolver:(e,o)=>{const{ownerState:i}=e;return[o.staticTooltip,!i.open&&o.staticTooltipClosed,o[`tooltipPlacement${J(i.tooltipPlacement)}`]]}})(({theme:e,ownerState:o})=>({position:"relative",display:"flex",alignItems:"center",[`& .${ht.staticTooltipLabel}`]:m({transition:e.transitions.create(["transform","opacity"],{duration:e.transitions.duration.shorter}),opacity:1},!o.open&&{opacity:0,transform:"scale(0.5)"},o.tooltipPlacement==="left"&&{transformOrigin:"100% 50%",right:"100%",marginRight:8},o.tooltipPlacement==="right"&&{transformOrigin:"0% 50%",left:"100%",marginLeft:8})})),vt=O("span",{name:"MuiSpeedDialAction",slot:"StaticTooltipLabel",overridesResolver:(e,o)=>o.staticTooltipLabel})(({theme:e})=>m({position:"absolute"},e.typography.body1,{backgroundColor:(e.vars||e).palette.background.paper,borderRadius:(e.vars||e).shape.borderRadius,boxShadow:(e.vars||e).shadows[1],color:(e.vars||e).palette.text.secondary,padding:"4px 16px",wordBreak:"keep-all"})),Ct=r.forwardRef(function(o,i){const a=he({props:o,name:"MuiSpeedDialAction"}),{className:c,delay:p=0,FabProps:d={},icon:f,id:j,open:u,TooltipClasses:D,tooltipOpen:g=!1,tooltipPlacement:v="left",tooltipTitle:L}=a,x=q(a,bt),S=m({},a,{tooltipPlacement:v}),A=gt(S),[n,l]=r.useState(g),b=()=>{l(!1)},R=()=>{l(!0)},B={transitionDelay:`${p}ms`},z=t.jsx(yt,m({size:"small",className:H(A.fab,c),tabIndex:-1,role:"menuitem",ownerState:S},d,{style:m({},B,d.style),children:f}));return g?t.jsxs(jt,m({id:j,ref:i,className:A.staticTooltip,ownerState:S},x,{children:[t.jsx(vt,{style:B,id:`${j}-label`,className:A.staticTooltipLabel,ownerState:S,children:L}),r.cloneElement(z,{"aria-labelledby":`${j}-label`})]})):(!u&&n&&l(!1),t.jsx(Ne,m({id:j,ref:i,title:L,placement:v,onClose:b,onOpen:R,open:u&&n,classes:D},x,{children:z})))});function Dt({title:e,author:o,coverUrl:i,createdAt:a}){const c=be(),p=_e("up","sm");return t.jsx(ye,{sx:{...Ve({color:`0deg, ${ne(c.vars.palette.grey["900Channel"],.64)}, ${ne(c.vars.palette.grey["900Channel"],.64)}`,imgUrl:i}),height:480,overflow:"hidden"},children:t.jsxs(je,{sx:{height:1,position:"relative"},children:[t.jsx(U,{variant:"h3",component:"h1",sx:{zIndex:9,color:"common.white",position:"absolute",maxWidth:480,pt:{xs:2,md:8}},children:e}),t.jsxs(y,{sx:{left:0,width:1,bottom:0,position:"absolute"},children:[o&&a&&t.jsxs(y,{direction:"row",alignItems:"center",sx:{px:{xs:2,md:3},pb:{xs:3,md:8}},children:[t.jsx(We,{alt:o.name,src:o.avatarUrl,sx:{width:64,height:64,mr:2}}),t.jsx(qe,{sx:{color:"common.white"},primary:o.name,secondary:He(a),primaryTypographyProps:{typography:"subtitle1",mb:.5},secondaryTypographyProps:{color:"inherit",sx:{opacity:.64}}})]}),t.jsx(ft,{direction:p?"left":"up",ariaLabel:"Share post",icon:t.jsx(G,{icon:"solar:share-bold"}),FabProps:{size:"medium"},sx:{position:"absolute",bottom:{xs:32,md:64},right:{xs:16,md:24}},children:Ge.map(d=>t.jsx(Ct,{icon:t.jsx(Je,{icon:d.name}),tooltipTitle:d.name,tooltipPlacement:"top",FabProps:{color:"default"}},d.name))})]})]})})}function St({open:e,title:o,content:i,isValid:a,onClose:c,coverUrl:p,onSubmit:d,description:f,isSubmitting:j}){let u="";p&&(typeof p=="string"?u=p:u=URL.createObjectURL(p));const D=o||u,g=o||f||i||u;return t.jsxs(Ze,{fullScreen:!0,open:e,onClose:c,children:[t.jsxs(at,{sx:{py:2,px:3},children:[t.jsx(U,{variant:"h6",sx:{flexGrow:1},children:"Preview"}),t.jsx(ve,{variant:"outlined",color:"inherit",onClick:c,children:"Cancel"}),t.jsx(oe,{type:"submit",variant:"contained",disabled:!a,loading:j,onClick:d,children:"Post"})]}),t.jsx(te,{}),g?t.jsxs(Xe,{children:[(D||u)&&t.jsx(Dt,{title:o,coverUrl:u}),t.jsx(je,{sx:{mt:5,mb:10},children:t.jsxs(y,{sx:{mx:"auto",maxWidth:720},children:[t.jsx(U,{variant:"h6",children:f}),t.jsx(ot,{children:i})]})})]}):t.jsx(st,{filled:!0,title:"Empty content!"})]})}const Tt=F.object({title:F.string().min(1,{message:"Title is required!"}),description:F.string().min(1,{message:"Description is required!"}),content:ce.editor().min(100,{message:"Content must be at least 100 characters"}),coverUrl:ce.file({message:{required_error:"Cover is required!"}}),tags:F.string().array().min(2,{message:"Must have at least 2 items!"}),metaKeywords:F.string().array().nonempty({message:"Meta keywords is required!"}),metaTitle:F.string(),metaDescription:F.string()});function _t({currentPost:e}){const o=Ye(),i=Qe(),a=r.useMemo(()=>({title:(e==null?void 0:e.title)||"",description:(e==null?void 0:e.description)||"",content:(e==null?void 0:e.content)||"",coverUrl:(e==null?void 0:e.coverUrl)||null,tags:(e==null?void 0:e.tags)||[],metaKeywords:(e==null?void 0:e.metaKeywords)||[],metaTitle:(e==null?void 0:e.metaTitle)||"",metaDescription:(e==null?void 0:e.metaDescription)||""}),[e]),c=De({mode:"all",resolver:Ce(Tt),defaultValues:a}),{reset:p,watch:d,setValue:f,handleSubmit:j,formState:{isSubmitting:u,isValid:D}}=c,g=d();r.useEffect(()=>{e&&p(a)},[e,a,p]);const v=j(async n=>{try{await new Promise(l=>setTimeout(l,500)),p(),i.onFalse(),et.success(e?"Update success!":"Create success!"),o.push(tt.dashboard.post.root),console.info("DATA",n)}catch(l){console.error(l)}}),L=r.useCallback(()=>{f("coverUrl",null)},[f]),x=t.jsxs(de,{children:[t.jsx(me,{title:"Details",subheader:"Title, short description, image...",sx:{mb:3}}),t.jsx(te,{}),t.jsxs(y,{spacing:3,sx:{p:3},children:[t.jsx(w.Text,{name:"title",label:"Post title"}),t.jsx(w.Text,{name:"description",label:"Description",multiline:!0,rows:3}),t.jsxs(y,{spacing:1.5,children:[t.jsx(U,{variant:"subtitle2",children:"Content"}),t.jsx(w.Editor,{name:"content",sx:{maxHeight:480}})]}),t.jsxs(y,{spacing:1.5,children:[t.jsx(U,{variant:"subtitle2",children:"Cover"}),t.jsx(w.Upload,{name:"coverUrl",maxSize:3145728,onDelete:L})]})]})]}),S=t.jsxs(de,{children:[t.jsx(me,{title:"Properties",subheader:"Additional functions and attributes...",sx:{mb:3}}),t.jsx(te,{}),t.jsxs(y,{spacing:3,sx:{p:3},children:[t.jsx(w.Autocomplete,{name:"tags",label:"Tags",placeholder:"+ Tags",multiple:!0,freeSolo:!0,disableCloseOnSelect:!0,options:le.map(n=>n),getOptionLabel:n=>n,renderOption:(n,l)=>r.createElement("li",{...n,key:l},l),renderTags:(n,l)=>n.map((b,R)=>r.createElement(ue,{...l({index:R}),key:b,label:b,size:"small",color:"info",variant:"soft"}))}),t.jsx(w.Text,{name:"metaTitle",label:"Meta title"}),t.jsx(w.Text,{name:"metaDescription",label:"Meta description",fullWidth:!0,multiline:!0,rows:3}),t.jsx(w.Autocomplete,{name:"metaKeywords",label:"Meta keywords",placeholder:"+ Keywords",multiple:!0,freeSolo:!0,disableCloseOnSelect:!0,options:le.map(n=>n),getOptionLabel:n=>n,renderOption:(n,l)=>r.createElement("li",{...n,key:l},l),renderTags:(n,l)=>n.map((b,R)=>r.createElement(ue,{...l({index:R}),key:b,label:b,size:"small",color:"info",variant:"soft"}))}),t.jsx(pe,{control:t.jsx(re,{defaultChecked:!0,inputProps:{id:"comments-switch"}}),label:"Enable comments"})]})]}),A=t.jsxs(ye,{display:"flex",alignItems:"center",flexWrap:"wrap",justifyContent:"flex-end",children:[t.jsx(pe,{control:t.jsx(re,{defaultChecked:!0,inputProps:{id:"publish-switch"}}),label:"Publish",sx:{pl:3,flexGrow:1}}),t.jsxs("div",{children:[t.jsx(ve,{color:"inherit",variant:"outlined",size:"large",onClick:i.onTrue,children:"Preview"}),t.jsx(oe,{type:"submit",variant:"contained",size:"large",loading:u,sx:{ml:2},children:e?"Save changes":"Create post"})]})]});return t.jsxs(Se,{methods:c,onSubmit:v,children:[t.jsxs(y,{spacing:5,sx:{mx:"auto",maxWidth:{xs:720,xl:880}},children:[x,S,A]}),t.jsx(St,{isValid:D,onSubmit:v,title:g.title,open:i.value,content:g.content,onClose:i.onFalse,coverUrl:g.coverUrl,isSubmitting:u,description:g.description})]})}const wt=F.object({comment:F.string().min(1,{message:"Comment is required!"})});function Vt(){const e={comment:""},o=De({resolver:Ce(wt),defaultValues:e}),{reset:i,handleSubmit:a,formState:{isSubmitting:c}}=o,p=a(async d=>{try{await new Promise(f=>setTimeout(f,500)),i(),console.info("DATA",d)}catch(f){console.error(f)}});return t.jsx(Se,{methods:o,onSubmit:p,children:t.jsxs(y,{spacing:3,children:[t.jsx(w.Text,{name:"comment",placeholder:"Write some of your comments...",multiline:!0,rows:4}),t.jsxs(y,{direction:"row",alignItems:"center",children:[t.jsxs(y,{direction:"row",alignItems:"center",flexGrow:1,children:[t.jsx(ee,{children:t.jsx(G,{icon:"solar:gallery-add-bold"})}),t.jsx(ee,{children:t.jsx(G,{icon:"eva:attach-2-fill"})}),t.jsx(ee,{children:t.jsx(G,{icon:"eva:smiling-face-fill"})})]}),t.jsx(oe,{type:"submit",variant:"contained",loading:c,children:"Post comment"})]})]})})}export{Dt as P,Vt as a,_t as b};
