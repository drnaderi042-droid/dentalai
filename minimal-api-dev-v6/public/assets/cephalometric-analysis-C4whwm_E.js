import{r as b,j as e,B as i,cL as D,cK as E,T as t,I as c,ar as z,S as o,d as y,cG as u,aE as P,dK as G,i as O,e5 as R,e as L,dh as $,di as N,C as B,H as U}from"./index-BH9ijvcg.js";import{C}from"./Card-CwEGl0A2.js";import{G as M}from"./Grid-vZ7eNkvH.js";const T={SNA:{mean:82,sd:3.5,min:78.5,max:85.5},SNB:{mean:80,sd:3.5,min:76.5,max:83.5},ANB:{mean:2,sd:2,min:0,max:4},gonialAngle:{mean:120,sd:5,min:115,max:125},FMA:{mean:25,sd:4,min:21,max:29},IMPA:{mean:90,sd:3,min:87,max:93},interincisalAngle:{mean:130,sd:6,min:124,max:136},overjet:{mean:3,sd:1,min:2,max:4},overbite:{mean:3,sd:1,min:2,max:4},combinationFactor:{mean:157.9,sd:6.5,min:151.4,max:164.4}},W=[{key:"SNA",label:"SNA",unit:"Â°",description:"Ø²Ø§ÙˆÛŒÙ‡ SNA"},{key:"SNB",label:"SNB",unit:"Â°",description:"Ø²Ø§ÙˆÛŒÙ‡ SNB"},{key:"ANB",label:"ANB",unit:"Â°",description:"Ø²Ø§ÙˆÛŒÙ‡ ANB"},{key:"gonialAngle",label:"Gonial Angle",unit:"Â°",description:"Ø²Ø§ÙˆÛŒÙ‡ Ú¯ÙˆÙ†ÛŒØ§Ù„"},{key:"FMA",label:"FMA",unit:"Â°",description:"Ø²Ø§ÙˆÛŒÙ‡ ÙØ±Ø§Ù†Ú©ÙÙˆØ±Øª-Ù…Ù†Ø¯ÛŒØ¨ÙˆÙ„Ø§Ø±"}],V=[{key:"overjet",label:"Overjet",unit:"mm",description:"Ø§ÙˆØ±Ø¬Øª"},{key:"overbite",label:"Overbite",unit:"mm",description:"Ø§ÙˆØ±Ø¨Ø§ÛŒØª"},{key:"IMPA",label:"IMPA",unit:"Â°",description:"Ø²Ø§ÙˆÛŒÙ‡ Ø§ÛŒÙ†Ø³Ø§ÛŒØ²ÙˆØ± Ù…Ù†Ø¯ÛŒØ¨ÙˆÙ„Ø§Ø±"},{key:"interincisalAngle",label:"Interincisal Angle",unit:"Â°",description:"Ø²Ø§ÙˆÛŒÙ‡ Ø¨ÛŒÙ† Ø§ÛŒÙ†Ø³Ø§ÛŒØ²ÙˆØ±Ù‡Ø§"}];function K({measurements:l}){const[s,x]=b.useState(0),S=(a,r)=>{if(!a||!r)return null;const n=parseFloat(a);return n<r.min?"low":n>r.max?"high":"normal"},f=a=>{switch(a){case"low":return"error";case"high":return"error";case"normal":return"success";default:return"grey"}},j=a=>{switch(a){case"low":return"Ú©Ù…ØªØ± Ø§Ø² Ù†Ø±Ù…Ø§Ù„";case"high":return"Ø¨ÛŒØ´ØªØ± Ø§Ø² Ù†Ø±Ù…Ø§Ù„";case"normal":return"Ù†Ø±Ù…Ø§Ù„";default:return"Ù†Ø§Ù…Ø´Ø®Øµ"}},v=l.SNA&&l.SNB?(parseFloat(l.SNA)+parseFloat(l.SNB)).toFixed(2):null,k=S(v,T.combinationFactor),w=a=>{const r=l[a.key],n=T[a.key],p=S(r,n),d=f(p);return r?e.jsxs(i,{sx:{mb:3},children:[e.jsxs(o,{direction:"row",justifyContent:"space-between",alignItems:"center",sx:{mb:1},children:[e.jsx(t,{variant:"subtitle2",children:a.label}),e.jsxs(o,{direction:"row",alignItems:"center",spacing:1,children:[e.jsxs(t,{variant:"h6",color:`${d}.main`,children:[r,a.unit]}),p&&e.jsx(i,{sx:{px:1,py:.5,borderRadius:.75,bgcolor:h=>u(h.palette[d].main,.16),color:`${d}.main`,fontSize:"0.75rem"},children:j(p)})]})]}),n&&e.jsxs(e.Fragment,{children:[e.jsxs(o,{direction:"row",justifyContent:"space-between",sx:{mb:.5},children:[e.jsxs(t,{variant:"caption",color:"text.secondary",children:["Ù…ÛŒØ§Ù†Ú¯ÛŒÙ†: ",n.mean,a.unit]}),e.jsxs(t,{variant:"caption",color:"text.secondary",children:["SD: Â±",n.sd]})]}),e.jsxs(i,{sx:{position:"relative"},children:[e.jsx(P,{variant:"determinate",value:100,sx:{height:8,borderRadius:1,bgcolor:h=>u(h.palette.grey[500],.12),"& .MuiLinearProgress-bar":{bgcolor:h=>u(h.palette.success.main,.24)}}}),r&&e.jsx(i,{sx:{position:"absolute",top:-2,left:`${(parseFloat(r)-n.min)/(n.max-n.min)*100}%`,transform:"translateX(-50%)"},children:e.jsx(i,{sx:{width:12,height:12,borderRadius:"50%",bgcolor:`${d}.main`,border:2,borderColor:"background.paper"}})})]}),e.jsxs(o,{direction:"row",justifyContent:"space-between",sx:{mt:.5},children:[e.jsxs(t,{variant:"caption",color:"text.secondary",children:[n.min,a.unit]}),e.jsxs(t,{variant:"caption",color:"text.secondary",children:[n.max,a.unit]})]})]})]},a.key):null},F=()=>{if(!v)return null;const a=T.combinationFactor,r=f(k);return e.jsxs(C,{sx:{p:3,mb:3,bgcolor:n=>u(n.palette.primary.main,.08)},children:[e.jsx(t,{variant:"h6",gutterBottom:!0,children:"Combination Factor"}),e.jsxs(o,{direction:"row",justifyContent:"space-between",alignItems:"center",sx:{mb:2},children:[e.jsxs(i,{children:[e.jsx(t,{variant:"h3",color:`${r}.main`,children:v}),e.jsxs(t,{variant:"caption",color:"text.secondary",children:["Ù…ÛŒØ§Ù†Ú¯ÛŒÙ†: ",a.mean," | SD: Â±",a.sd]})]}),e.jsx(i,{sx:{px:2,py:1,borderRadius:1,bgcolor:n=>u(n.palette[r].main,.16),color:`${r}.main`},children:e.jsx(t,{variant:"subtitle2",children:j(k)})})]}),e.jsxs(i,{sx:{position:"relative",mb:1},children:[e.jsx(P,{variant:"determinate",value:100,sx:{height:12,borderRadius:1,bgcolor:n=>u(n.palette.grey[500],.12),"& .MuiLinearProgress-bar":{bgcolor:n=>u(n.palette.success.main,.24)}}}),e.jsx(i,{sx:{position:"absolute",top:-2,left:`${(parseFloat(v)-a.min)/(a.max-a.min)*100}%`,transform:"translateX(-50%)"},children:e.jsx(i,{sx:{width:16,height:16,borderRadius:"50%",bgcolor:`${r}.main`,border:2,borderColor:"background.paper"}})})]}),e.jsxs(o,{direction:"row",justifyContent:"space-between",children:[e.jsx(t,{variant:"caption",color:"text.secondary",children:a.min}),e.jsx(t,{variant:"caption",color:"text.secondary",children:a.mean}),e.jsx(t,{variant:"caption",color:"text.secondary",children:a.max})]})]})};return e.jsx(i,{children:e.jsxs(C,{sx:{mb:3},children:[e.jsxs(D,{value:s,onChange:(a,r)=>x(r),sx:{borderBottom:1,borderColor:"divider"},children:[e.jsx(E,{label:"ØªØ­Ù„ÛŒÙ„ Ø®Ø·ÛŒ"}),e.jsx(E,{label:"Ù¾Ø±ÙˆÙÛŒÙ„ÙˆÚ¯Ø±Ø§Ù…"}),e.jsx(E,{label:"Ù†Ù…ÙˆØ¯Ø§Ø±"})]}),e.jsxs(i,{sx:{p:3},children:[s===0&&e.jsxs(i,{children:[e.jsxs(t,{variant:"h6",gutterBottom:!0,sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(c,{icon:"solar:chart-2-bold"}),"Ù†ØªØ§ÛŒØ¬ ØªØ­Ù„ÛŒÙ„ Ø³ÙØ§Ù„ÙˆÙ…ØªØ±ÛŒ"]}),e.jsx(z,{sx:{my:2}}),F(),e.jsx(t,{variant:"subtitle1",gutterBottom:!0,sx:{mt:3,mb:2},children:"Ø§Ù†Ø¯Ø§Ø²Ù‡â€ŒÚ¯ÛŒØ±ÛŒâ€ŒÙ‡Ø§ÛŒ Ø§Ø³Ú©Ù„ØªÛŒ"}),W.map(w),e.jsx(t,{variant:"subtitle1",gutterBottom:!0,sx:{mt:3,mb:2},children:"Ø§Ù†Ø¯Ø§Ø²Ù‡â€ŒÚ¯ÛŒØ±ÛŒâ€ŒÙ‡Ø§ÛŒ Ø¯Ù†Ø¯Ø§Ù†ÛŒ"}),V.map(w),e.jsxs(o,{direction:"row",spacing:2,sx:{mt:4},children:[e.jsx(y,{variant:"contained",startIcon:e.jsx(c,{icon:"solar:printer-bold"}),fullWidth:!0,children:"Ú†Ø§Ù¾ Ú¯Ø²Ø§Ø±Ø´"}),e.jsx(y,{variant:"outlined",startIcon:e.jsx(c,{icon:"solar:export-bold"}),fullWidth:!0,children:"Ø®Ø±ÙˆØ¬ÛŒ Excel"})]})]}),s===1&&e.jsxs(i,{sx:{textAlign:"center",py:8},children:[e.jsx(c,{icon:"solar:graph-bold",width:64,sx:{color:"text.disabled",mb:2}}),e.jsx(t,{variant:"h6",color:"text.secondary",children:"Ù¾Ø±ÙˆÙÛŒÙ„ÙˆÚ¯Ø±Ø§Ù…"}),e.jsx(t,{variant:"body2",color:"text.disabled",children:"Ù†Ù…Ø§ÛŒØ´ Ú¯Ø±Ø§ÙÛŒÚ©ÛŒ Ù†ØªØ§ÛŒØ¬ ØªØ­Ù„ÛŒÙ„"})]}),s===2&&e.jsxs(i,{sx:{textAlign:"center",py:8},children:[e.jsx(c,{icon:"solar:chart-bold",width:64,sx:{color:"text.disabled",mb:2}}),e.jsx(t,{variant:"h6",color:"text.secondary",children:"Ù†Ù…ÙˆØ¯Ø§Ø± Ù…Ù‚Ø§ÛŒØ³Ù‡â€ŒØ§ÛŒ"}),e.jsx(t,{variant:"body2",color:"text.disabled",children:"Ù…Ù‚Ø§ÛŒØ³Ù‡ Ø§Ù†Ø¯Ø§Ø²Ù‡â€ŒÚ¯ÛŒØ±ÛŒâ€ŒÙ‡Ø§ Ø¨Ø§ Ù…Ù‚Ø§Ø¯ÛŒØ± Ù†Ø±Ù…Ø§Ù„"})]})]})]})})}function _(){const{patientId:l}=G(),{user:s}=O(),[x,S]=b.useState(null),[f,j]=b.useState(null),[I,v]=b.useState({}),[k,w]=b.useState(!0);b.useEffect(()=>{s&&l&&(async()=>{var n,p;try{w(!0);const d=await $.get(`${N.patients}/${l}`,{headers:{Authorization:`Bearer ${s==null?void 0:s.accessToken}`}});S(d.data.patient);try{const g=(await $.get(`${N.patients}/${l}/images`,{headers:{Authorization:`Bearer ${s==null?void 0:s.accessToken}`}})).data.images||[];console.log("ğŸ“¸ Patient images loaded:",g.length);const m=g.find(A=>A.category==="lateral"||A.category==="cephalometric"||A.category==="cephalometry");m?(j(`${B.site.serverUrl}${m.path}`),console.log("âœ… Lateral ceph image found:",m.originalName,"Category:",m.category)):console.log("âš ï¸ No lateral ceph image found in categories:",g.map(A=>A.category).join(", "))}catch(h){console.warn("Could not fetch patient images:",h);const g=(p=(n=d.data.patient)==null?void 0:n.radiologyImages)==null?void 0:p.find(m=>m.category==="lateral"||m.category==="cephalometric"||m.category==="cephalometry");g&&(j(`${B.site.serverUrl}${g.path}`),console.log("âœ… Lateral ceph image found from patient data"))}}catch(d){console.error("Error fetching patient:",d)}finally{w(!1)}})()},[s,l]);const F=async()=>{try{await $.post(`${N.patients}/${l}/cephalometric-analysis`,{measurements:I,timestamp:new Date().toISOString()},{headers:{Authorization:`Bearer ${s==null?void 0:s.accessToken}`}}),alert("ØªØ­Ù„ÛŒÙ„ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯")}catch(r){console.error("Error saving analysis:",r),alert("Ø®Ø·Ø§ Ø¯Ø± Ø°Ø®ÛŒØ±Ù‡ ØªØ­Ù„ÛŒÙ„")}},a=async r=>{var d,h;const n=(d=r.target.files)==null?void 0:d[0];if(!n)return;const p=new FormData;p.append("image",n),p.append("category","cephalometric");try{const m=(h=(await $.post(`${N.patients}/${l}/radiology-images`,p,{headers:{Authorization:`Bearer ${s==null?void 0:s.accessToken}`,"Content-Type":"multipart/form-data"}})).data.image)==null?void 0:h.path;m&&j(`${B.site.serverUrl}${m}`)}catch(g){console.error("Error uploading image:",g),alert("Ø®Ø·Ø§ Ø¯Ø± Ø¢Ù¾Ù„ÙˆØ¯ ØªØµÙˆÛŒØ±")}};return k?e.jsx(R,{children:e.jsx(L,{children:e.jsx(t,{variant:"h4",sx:{textAlign:"center",mt:4},children:"Ø¨Ø§Ø±Ú¯ÛŒØ±ÛŒ..."})})}):e.jsx(R,{children:e.jsxs(L,{maxWidth:"xl",children:[e.jsxs(o,{direction:"row",justifyContent:"space-between",alignItems:"center",sx:{mb:3},children:[e.jsxs(i,{children:[e.jsx(t,{variant:"h4",gutterBottom:!0,children:"ØªØ­Ù„ÛŒÙ„ Ø³ÙØ§Ù„ÙˆÙ…ØªØ±ÛŒ"}),e.jsxs(t,{variant:"body2",color:"text.secondary",children:[x==null?void 0:x.firstName," ",x==null?void 0:x.lastName," - ",x==null?void 0:x.age," Ø³Ø§Ù„"]})]}),e.jsxs(o,{direction:"row",spacing:2,children:[e.jsx(y,{variant:"outlined",startIcon:e.jsx(c,{icon:"eva:arrow-back-fill"}),onClick:()=>window.history.back(),children:"Ø¨Ø§Ø²Ú¯Ø´Øª"}),e.jsx(y,{fullWidth:!0,size:"large",variant:"contained",startIcon:e.jsx(c,{icon:"eva:save-fill"}),onClick:F,disabled:Object.keys(I).length===0,children:"Ø°Ø®ÛŒØ±Ù‡ ØªØ­Ù„ÛŒÙ„"})]})]}),f?e.jsxs(M,{container:!0,spacing:3,children:[e.jsx(M,{item:!0,xs:12,lg:8,children:e.jsxs(C,{sx:{p:2},children:[e.jsxs(o,{direction:"row",justifyContent:"space-between",alignItems:"center",sx:{mb:2},children:[e.jsx(t,{variant:"h6",children:"Ú©Ø§Ù†ÙˆØ³ ØªØ­Ù„ÛŒÙ„"}),e.jsxs("label",{htmlFor:"change-ceph-image",children:[e.jsx("input",{type:"file",accept:"image/*",style:{display:"none"},id:"change-ceph-image",onChange:a}),e.jsx(y,{component:"span",size:"small",startIcon:e.jsx(c,{icon:"eva:image-outline"}),children:"ØªØºÛŒÛŒØ± ØªØµÙˆÛŒØ±"})]})]}),e.jsx(i,{sx:{p:3,textAlign:"center",color:"text.secondary"},children:"CephalometricCanvas component is currently being refactored"})]})}),e.jsx(M,{item:!0,xs:12,lg:4,children:e.jsx(K,{measurements:I})})]}):e.jsxs(C,{sx:{p:8,textAlign:"center",borderStyle:"dashed",borderWidth:2,borderColor:"divider",bgcolor:r=>u(r.palette.grey[500],.04)},children:[e.jsx(c,{icon:"solar:upload-bold",width:64,sx:{color:"text.disabled",mb:2}}),e.jsx(t,{variant:"h6",gutterBottom:!0,children:"Ø¢Ù¾Ù„ÙˆØ¯ ØªØµÙˆÛŒØ± Ø³ÙØ§Ù„ÙˆÙ…ØªØ±ÛŒ"}),e.jsx(t,{variant:"body2",color:"text.secondary",sx:{mb:3},children:"Ù„Ø·ÙØ§Ù‹ ØªØµÙˆÛŒØ± Ø±Ø§Ø¯ÛŒÙˆÚ¯Ø±Ø§ÙÛŒ Ø¬Ø§Ù†Ø¨ÛŒ Ø¬Ù…Ø¬Ù…Ù‡ Ø±Ø§ Ø¢Ù¾Ù„ÙˆØ¯ Ú©Ù†ÛŒØ¯"}),e.jsxs("label",{htmlFor:"ceph-image-upload",children:[e.jsx("input",{type:"file",accept:"image/*",style:{display:"none"},id:"ceph-image-upload",onChange:a}),e.jsx(y,{variant:"contained",component:"span",startIcon:e.jsx(c,{icon:"eva:cloud-upload-fill"}),children:"Ø§Ù†ØªØ®Ø§Ø¨ ØªØµÙˆÛŒØ±"})]})]}),f&&e.jsxs(C,{sx:{p:3,mt:3},children:[e.jsx(t,{variant:"h6",gutterBottom:!0,children:"Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡"}),e.jsxs(o,{spacing:1.5,children:[e.jsxs(o,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(c,{icon:"eva:checkmark-circle-2-fill",color:"success.main"}),e.jsx(t,{variant:"body2",children:"Ù†Ù‚Ø§Ø· Ø¢Ù†Ø§ØªÙˆÙ…ÛŒÚ©ÛŒ Ø±Ø§ Ø¨Ø§ Ú©Ù„ÛŒÚ© Ø±ÙˆÛŒ ØªØµÙˆÛŒØ± Ù…Ø´Ø®Øµ Ú©Ù†ÛŒØ¯"})]}),e.jsxs(o,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(c,{icon:"eva:checkmark-circle-2-fill",color:"success.main"}),e.jsx(t,{variant:"body2",children:"Ø¨Ø±Ø§ÛŒ Ø¨Ø²Ø±Ú¯Ù†Ù…Ø§ÛŒÛŒ Ø§Ø² Ú†Ø±Ø® Ù…Ø§ÙˆØ³ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯"})]}),e.jsxs(o,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(c,{icon:"eva:checkmark-circle-2-fill",color:"success.main"}),e.jsx(t,{variant:"body2",children:"Ø¨Ø±Ø§ÛŒ Ø­Ø±Ú©Øª ØªØµÙˆÛŒØ±ØŒ Ú©Ù„ÛŒØ¯ Ctrl Ø±Ø§ Ù†Ú¯Ù‡ Ø¯Ø§Ø±ÛŒØ¯ Ùˆ Ù…Ø§ÙˆØ³ Ø±Ø§ Ø­Ø±Ú©Øª Ø¯Ù‡ÛŒØ¯"})]}),e.jsxs(o,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(c,{icon:"eva:checkmark-circle-2-fill",color:"success.main"}),e.jsx(t,{variant:"body2",children:"Ù†ØªØ§ÛŒØ¬ ØªØ­Ù„ÛŒÙ„ Ø¨Ù‡ ØµÙˆØ±Øª Ø®ÙˆØ¯Ú©Ø§Ø± Ù…Ø­Ø§Ø³Ø¨Ù‡ Ùˆ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯"})]})]})]})]})})}const H={title:`ØªØ­Ù„ÛŒÙ„ Ø³ÙØ§Ù„ÙˆÙ…ØªØ±ÛŒ | ${B.site.name}`};function Q(){return e.jsxs(e.Fragment,{children:[e.jsx(U,{children:e.jsx("title",{children:H.title})}),e.jsx(_,{})]})}export{Q as default};
