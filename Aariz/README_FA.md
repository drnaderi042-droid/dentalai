# ุฑุงูููุง ุขููุฒุด ูุฏู ุชุดุฎุต ููุฏูุงุฑฺฉโูุง ุณูุงูููุชุฑ

ุงู ูพุฑูฺู ฺฉ ูพุงุฏูโุณุงุฒ ฺฉุงูู ุจุฑุง ุขููุฒุด ูุฏู ุชุดุฎุต ุฎูุฏฺฉุงุฑ 29 ููุฏูุงุฑฺฉ ุณูุงูููุชุฑ ุจุง ุงุณุชูุงุฏู ุงุฒ ุฏุชุงุณุช Aariz ุงุณุช.

## ๐ ููุฑุณุช ูุทุงูุจ

- [ููุฏูู](#ููุฏูู)
- [ูฺฺฏโูุง](#ูฺฺฏโูุง)
- [ูุตุจ ู ุฑุงูโุงูุฏุงุฒ](#ูุตุจ-ู-ุฑุงูโุงูุฏุงุฒ)
- [ุณุงุฎุชุงุฑ ูพุฑูฺู](#ุณุงุฎุชุงุฑ-ูพุฑูฺู)
- [ุงุณุชูุงุฏู](#ุงุณุชูุงุฏู)
- [ูุนูุงุฑ ูุฏู](#ูุนูุงุฑ-ูุฏู)
- [ูพุดููุงุฏุงุช ู ูฺฉุงุช](#ูพุดููุงุฏุงุช-ู-ูฺฉุงุช)

## ููุฏูู

ุงู ูพุฑูฺู ุจุฑุง ุขููุฒุด ูุฏู ุชุดุฎุต ููุฏูุงุฑฺฉโูุง ุณูุงูููุชุฑ ุทุฑุงุญ ุดุฏู ุงุณุช. ุฏุชุงุณุช Aariz ุดุงูู 1000 ุชุตูุฑ ูุชุฑุงู ุณูุงูููุชุฑ ุงุณุช ฺฉู ูุฑ ฺฉุฏุงู ุฏุงุฑุง 29 ููุฏูุงุฑฺฉ ุขูุงุชููฺฉ ุงุณุช. ุงู ููุฏูุงุฑฺฉโูุง ุจุฑุง ุชุญูู ุณูุงูููุชุฑ ู ุจุฑูุงููโุฑุฒ ุฏุฑูุงู ุงุฑุชูุฏูุณ ุงุณุชูุงุฏู ูโุดููุฏ.

## ูฺฺฏโูุง

โ **ุณู ูุนูุงุฑ ูุฏู ูุฎุชูู:**
- ResNet-based: ุงุณุชูุงุฏู ุงุฒ ResNet pretrained ุจุง decoder ุจุฑุง ูพุดโุจู heatmap
- UNet: ูุนูุงุฑ UNet ฺฉูุงุณฺฉ ุจุง skip connections
- Hourglass: ุดุจฺฉูโูุง Hourglass ุจุฑุง ุชุดุฎุต pose/landmark

โ **ุฑูฺฉุฑุฏ Heatmap-based:**
- ุชุจุฏู ููุฏูุงุฑฺฉโูุง ุจู heatmap ุจุง Gaussian distribution
- ุฏูุช ุจุงูุงุชุฑ ูุณุจุช ุจู coordinate regression ูุณุชูู

โ **Data Augmentation:**
- ฺุฑุฎุด ุชุตุงุฏู
- ุชุบุฑ ููุงุณ ู ูููุนุช
- ุชูุธู ุฑูุดูุง ู ฺฉูุชุฑุงุณุช

โ **ุงุฑุฒุงุจ ฺฉุงูู:**
- Mean Radial Error (MRE) ุจุฑ ุญุณุจ ููโูุชุฑ
- Success Detection Rate (SDR) ุฏุฑ ุขุณุชุงููโูุง 2.0, 2.5, 3.0, 4.0 ููโูุชุฑ

โ **Logging ู Visualization:**
- TensorBoard ุจุฑุง ูุงูุชูุฑูฺฏ ุขููุฒุด
- ุฐุฎุฑู checkpoint ูุง ุจูุชุฑู ูุฏู

## ูุตุจ ู ุฑุงูโุงูุฏุงุฒ

### ูพุดโูุงุฒูุง

- Python 3.8+
- CUDA-enabled GPU (ูพุดููุงุฏ)
- ุญุฏุงูู 16GB RAM
- ุญุฏุงูู 10GB ูุถุง ุฎุงู ุจุฑุง ุฐุฎุฑู checkpoint ูุง

### ูุตุจ

1. ฺฉููู ฺฉุฑุฏู ุง ุฏุงูููุฏ ูพุฑูฺู
2. ูุตุจ ูพฺฉุฌโูุง ููุฑุฏ ูุงุฒ:

```bash
pip install -r requirements.txt
```

3. ุงุทููุงู ุงุฒ ุณุงุฎุชุงุฑ ุตุญุญ ุฏุชุงุณุช:

```
Aariz/
โโโ train/
โ   โโโ Cephalograms/
โ   โโโ Annotations/
โโโ valid/
โ   โโโ Cephalograms/
โ   โโโ Annotations/
โโโ test/
โ   โโโ Cephalograms/
โ   โโโ Annotations/
โโโ cephalogram_machine_mappings.csv
```

## ุณุงุฎุชุงุฑ ูพุฑูฺู

```
.
โโโ dataset.py          # ฺฉูุงุณ Dataset ุจุฑุง ุฎูุงูุฏู ุฏุงุฏูโูุง
โโโ model.py            # ูุนูุงุฑโูุง ูุฎุชูู ูุฏู
โโโ train.py            # ุงุณฺฉุฑูพุช ุขููุฒุด
โโโ evaluate.py         # ุงุณฺฉุฑูพุช ุงุฑุฒุงุจ
โโโ utils.py            # ุชูุงุจุน ฺฉูฺฉ
โโโ requirements.txt    # ูพฺฉุฌโูุง ููุฑุฏ ูุงุฒ
โโโ README_FA.md        # ุงู ูุงู
โโโ checkpoints/        # ูุฏูโูุง ุฐุฎุฑู ุดุฏู (ุณุงุฎุชู ูโุดูุฏ)
```

## ุงุณุชูุงุฏู

### ุขููุฒุด ูุฏู

**ุขููุฒุด ูพุงู:**
```bash
python train.py --dataset_path Aariz --model resnet --batch_size 8 --epochs 100
```

**ุขููุฒุด ุจุง ุชูุธูุงุช ูพุดุฑูุชู:**
```bash
python train.py \
    --dataset_path Aariz \
    --model resnet \
    --batch_size 16 \
    --epochs 150 \
    --lr 1e-4 \
    --image_size 512 512 \
    --annotation_type "Senior Orthodontists" \
    --save_dir checkpoints \
    --log_dir logs
```

**ูพุงุฑุงูุชุฑูุง ููู:**

- `--model`: ูุนูุงุฑ ูุฏู (`resnet`, `unet`, `hourglass`)
- `--batch_size`: ุงูุฏุงุฒู batch (ุจุณุชู ุจู GPU ุดูุง)
- `--lr`: ูุฑุฎ ุงุฏฺฏุฑ (ูพุดโูุฑุถ: 1e-4)
- `--image_size`: ุงุจุนุงุฏ ุชุตูุฑ ูุฑูุฏ (height width)
- `--annotation_type`: ููุน annotation ("Senior Orthodontists" ุง "Junior Orthodontists")
- `--resume`: ุงุฏุงูู ุขููุฒุด ุงุฒ checkpoint

**ูุซุงู ุจุง UNet:**
```bash
python train.py --model unet --batch_size 12 --epochs 120
```

**ุงุฏุงูู ุขููุฒุด:**
```bash
python train.py --resume checkpoints/checkpoint_latest.pth
```

### ุงุฑุฒุงุจ ูุฏู

```bash
python evaluate.py \
    --checkpoint checkpoints/checkpoint_best.pth \
    --model resnet \
    --dataset_path Aariz \
    --save_predictions
```

ุงู ุฏุณุชูุฑ ูุฏู ุฑุง ุฑู test set ุงุฑุฒุงุจ ูโฺฉูุฏ ู ูุชุงุฌ ุฑุง ุฐุฎุฑู ูโฺฉูุฏ.

### ูุงูุชูุฑูฺฏ ุขููุฒุด

ุจุฑุง ูุดุงูุฏู ูููุฏุงุฑูุง ุขููุฒุด ุฏุฑ TensorBoard:

```bash
tensorboard --logdir logs
```

ุณูพุณ ุจู ุขุฏุฑุณ `http://localhost:6006` ุจุฑูุฏ.

## ูุนูุงุฑ ูุฏู

### 1. ResNet-based Model

- **Encoder**: ResNet-50 pretrained (ุงุฒ ImageNet)
- **Decoder**: ฺูุฏ ูุงู ConvTranspose2d
- **ูุฒุงุง**: ุงุณุชูุงุฏู ุงุฒ ูฺฺฏโูุง pretrainedุ ุขููุฒุด ุณุฑุนโุชุฑ
- **ูุนุงุจ**: ูุงุฒ ุจู ุญุงูุธู ุจุดุชุฑ

### 2. UNet Model

- **ุณุงุฎุชุงุฑ**: Encoder-Decoder ุจุง skip connections
- **ูุฒุงุง**: ุณุงุฏูุ ูุงุจู ูููุ ูุงุฒ ุจู ุญุงูุธู ฺฉูุชุฑ
- **ูุนุงุจ**: ููฺฉู ุงุณุช ุฏุฑ ุชุตุงูุฑ ูพฺุฏู ุฏูุช ฺฉูุชุฑ ุฏุงุดุชู ุจุงุดุฏ

### 3. Hourglass Model

- **ุณุงุฎุชุงุฑ**: Stacked Hourglass networks
- **ูุฒุงุง**: ุทุฑุงุญ ุดุฏู ุจุฑุง pose estimationุ ุฏูุช ุจุงูุง
- **ูุนุงุจ**: ุขููุฒุด ฺฉูุฏุชุฑุ ูพฺุฏูโุชุฑ

## ูพุดููุงุฏุงุช ู ูฺฉุงุช

### ๐ฏ ุงูุชุฎุงุจ ูุฏู

1. **ุจุฑุง ุดุฑูุน**: ุงุฒ `resnet` ุงุณุชูุงุฏู ฺฉูุฏ - ุณุฑุนโุชุฑ ู ุจุง ุฏูุช ุฎูุจ
2. **ุจุฑุง ุฏูุช ุจุงูุง**: ุงุฒ `hourglass` ุงุณุชูุงุฏู ฺฉูุฏ - ูุงุฒ ุจู GPU ููโุชุฑ ุฏุงุฑุฏ
3. **ุจุฑุง ููุงุจุน ูุญุฏูุฏ**: ุงุฒ `unet` ุงุณุชูุงุฏู ฺฉูุฏ

### ๐ ุชูุธูุงุช ูพุดููุงุฏ

**ุจุฑุง GPU ุจุง 8GB VRAM:**
```bash
python train.py --model resnet --batch_size 8 --image_size 512 512
```

**ุจุฑุง GPU ุจุง 16GB+ VRAM:**
```bash
python train.py --model hourglass --batch_size 16 --image_size 640 640
```

**ุจุฑุง CPU ุง GPU ุถุนู:**
```bash
python train.py --model unet --batch_size 4 --image_size 384 384
```

### ๐ง ุชฺฉูฺฉโูุง ุจูุจูุฏ ุฏูุช

1. **Data Augmentation ุจุดุชุฑ:**
   - ุฏุฑ `dataset.py` ูโุชูุงูุฏ augmentation ูุง ุจุดุชุฑ ุงุถุงูู ฺฉูุฏ
   - Elastic transformation
   - Random brightness/contrast ุดุฏุฏุชุฑ

2. **Ensemble Models:**
   - ฺูุฏู ูุฏู ุจุง ูุนูุงุฑโูุง ูุฎุชูู ุขููุฒุด ุฏูุฏ
   - ุงุฒ ูุงูฺฏู ูพุดโุจูโูุง ุงุณุชูุงุฏู ฺฉูุฏ

3. **Fine-tuning:**
   - ุงุฒ learning rate scheduler ุงุณุชูุงุฏู ฺฉูุฏ
   - ูพุณ ุงุฒ 50 epochุ learning rate ุฑุง ฺฉุงูุด ุฏูุฏ

4. **Multi-scale Training:**
   - ุชุตุงูุฑ ุฑุง ุฏุฑ ุงุจุนุงุฏ ูุฎุชูู ุขููุฒุด ุฏูุฏ
   - Test-time augmentation

5. **Loss Function:**
   - ุฏุฑ `train.py` ูโุชูุงูุฏ ูุฒูโูุง focal loss ุฑุง ุชูุธู ฺฉูุฏ
   - ุงุฒ L1 loss ุจู ุฌุง MSE ุงุณุชูุงุฏู ฺฉูุฏ

### ๐ ูุนุงุฑูุง ุงุฑุฒุงุจ

- **MRE < 2.0 mm**: ุนุงู (ูุงุจู ุงุณุชูุงุฏู ุฏุฑ ูุญุท ุจุงูู)
- **MRE 2.0-3.0 mm**: ุฎูุจ (ูุงุฒ ุจู ุจุฑุฑุณ ุฏุงุฑุฏ)
- **MRE > 3.0 mm**: ูุงุฒ ุจู ุจูุจูุฏ

- **SDR > 80% @ 2mm**: ุฏูุช ุจุงูุง ุชุดุฎุต
- **SDR > 90% @ 3mm**: ูุงุจู ูุจูู

### โ๏ธ ูฺฉุงุช ููู

1. **ุงุณุชูุงุฏู ุงุฒ Senior Orthodontists annotations:**
   - ูพุดููุงุฏ ูโุดูุฏ ุงุฒ annotations ูุชุฎุตุตุงู ุงุฑุดุฏ ุงุณุชูุงุฏู ฺฉูุฏ
   - ุฏูุช ุจุงูุงุชุฑ ุฏุงุฑูุฏ

2. **ุฐุฎุฑู Checkpoint ูุง:**
   - ููุดู ุจูุชุฑู checkpoint ุฑุง ูฺฏู ุฏุงุฑุฏ
   - ูุฑ 10 epoch ฺฉ checkpoint ุฐุฎุฑู ูโุดูุฏ

3. **Overfitting:**
   - ุงฺฏุฑ gap ุจู train ู validation ุฒุงุฏ ุดุฏุ augmentation ุฑุง ุงูุฒุงุด ุฏูุฏ
   - ุง ุงุฒ dropout ุงุณุชูุงุฏู ฺฉูุฏ

4. **Normalization:**
   - ุชุตุงูุฑ ุจู ุทูุฑ ุฎูุฏฺฉุงุฑ normalize ูโุดููุฏ (0-1)
   - ุงฺฏุฑ ุงุฒ pretrained models ุงุณุชูุงุฏู ูโฺฉูุฏุ ูโุชูุงูุฏ ImageNet normalization ุงุนูุงู ฺฉูุฏ

### ๐ Workflow ูพุดููุงุฏ

1. **ูุฑุญูู 1: Baseline**
   ```bash
   python train.py --model resnet --epochs 50
   ```

2. **ูุฑุญูู 2: ุงุฑุฒุงุจ ุงููู**
   ```bash
   python evaluate.py --checkpoint checkpoints/checkpoint_best.pth
   ```

3. **ูุฑุญูู 3: Fine-tuning**
   - ุงฺฏุฑ MRE > 2.5mm ุจูุฏุ ูุฏู ุฑุง ุจุดุชุฑ ุขููุฒุด ุฏูุฏ
   - ุง ุงุฒ ูุฏู ุฏฺฏุฑ ุงุณุชูุงุฏู ฺฉูุฏ

4. **ูุฑุญูู 4: Ensemble (ุงุฎุชุงุฑ)**
   - ฺูุฏู ูุฏู ุขููุฒุด ุฏูุฏ
   - ุงุฒ ูุงูฺฏู ูพุดโุจูโูุง ุงุณุชูุงุฏู ฺฉูุฏ

### ๐ ูุซุงู ฺฉุงูู

```bash
# 1. ุขููุฒุด ูุฏู ResNet
python train.py \
    --dataset_path Aariz \
    --model resnet \
    --batch_size 8 \
    --epochs 100 \
    --lr 1e-4 \
    --save_dir checkpoints/resnet

# 2. ุงุฑุฒุงุจ
python evaluate.py \
    --checkpoint checkpoints/resnet/checkpoint_best.pth \
    --model resnet \
    --save_predictions

# 3. ูุดุงูุฏู ูุชุงุฌ ุฏุฑ TensorBoard
tensorboard --logdir logs
```

## ูุดฺฉูุงุช ุฑุงุฌ ู ุฑุงูโุญู

### ุฎุทุง Out of Memory

- `batch_size` ุฑุง ฺฉุงูุด ุฏูุฏ
- `image_size` ุฑุง ฺฉูฺฺฉโุชุฑ ฺฉูุฏ
- ุงุฒ ูุฏู `unet` ุงุณุชูุงุฏู ฺฉูุฏ

### ุฏูุช ูพุงู ุฏุฑ validation

- Data augmentation ุฑุง ุงูุฒุงุด ุฏูุฏ
- Learning rate ุฑุง ฺฉุงูุด ุฏูุฏ
- ูุฏู ุฑุง ุจุดุชุฑ ุขููุฒุด ุฏูุฏ

### ุขููุฒุด ฺฉูุฏ

- ุงุฒ GPU ุงุณุชูุงุฏู ฺฉูุฏ
- `num_workers` ุฑุง ุงูุฒุงุด ุฏูุฏ
- ุงุฒ `mixed precision training` ุงุณุชูุงุฏู ฺฉูุฏ (ูุงุฒ ุจู ุชุบุฑ ฺฉุฏ ุฏุงุฑุฏ)

## ููุงุจุน ู ูุฑุงุฌุน

- [ููุงูู Aariz Dataset](https://github.com/manwaarkhd/aariz)
- [Stacked Hourglass Networks](https://arxiv.org/abs/1603.06937)
- [UNet Paper](https://arxiv.org/abs/1505.04597)

## ูพุดุชุจุงู

ุงฺฏุฑ ุณูุงู ุฏุงุฑุฏ ุง ูุดฺฉู ูพุด ุขูุฏ:
1. Issues ุฑุง ุฏุฑ GitHub ุจุฑุฑุณ ฺฉูุฏ
2. Documentation ุฑุง ูุทุงูุนู ฺฉูุฏ
3. ุจุง maintainers ุชูุงุณ ุจฺฏุฑุฏ

---

**ูููู ุจุงุดุฏ! ๐**

