# ๐ง ุฑูุน ูุดฺฉู ุงูุฏุงุฒู ุชุตูุฑ ุฏุฑ Inference

## ูุดฺฉู

ูุฏู ุฑู ุชุตุงูุฑ ุจุง ุงูุฏุงุฒู **256ร256 ูพฺฉุณู** ุขููุฒุด ุฏุฏู ุจูุฏุ ุงูุง ุฏุฑ ฺฉุฏ inference ุงุฒ **512ร512** ุงุณุชูุงุฏู ูโุดุฏ. ุงู ุจุงุนุซ ูโุดุฏ ฺฉู:

1. **MRE ุจุณุงุฑ ุจุงูุง ุดูุฏ**: ุงุฒ ~1.7mm ุจู **~54mm** ุงูุฒุงุด ุงูุช
2. **SDR ฺฉุงูุด ุดุฏุฏ ุฏุงุดุชู ุจุงุดุฏ**: ุงุฒ 72% ุจู ฺฉูุชุฑ ุงุฒ 10%
3. **ููุฏูุงุฑฺฉโูุง ุฏุฑ ูููุนุชโูุง ฺฉุงููุงู ุงุดุชุจุงู** ูุฑุงุฑ ฺฏุฑูุฏ

## ุนูุช

ูุฏูโูุง ุชุดุฎุต ููุฏูุงุฑฺฉ ฺฉู ุจุง heatmap ฺฉุงุฑ ูโฺฉููุฏุ ุจู ุดุฏุช ุจู **ุงูุฏุงุฒู ุชุตูุฑ ูุฑูุฏ** ุญุณุงุณ ูุณุชูุฏ. ุงฺฏุฑ ูุฏู ุฑู 256ร256 ุขููุฒุด ุฏุฏู ุจุงุดุฏ:

- **ุชูุฒุน heatmap ูุง**: ุจุฑุง 256ร256 ุจูููโุณุงุฒ ุดุฏู
- **Receptive field**: ุงูุฏุงุฒูโ ุขู ุจุฑุง 256ร256 ูุญุงุณุจู ุดุฏู
- **Feature maps**: ุงุจุนุงุฏ feature map ูุง ุจุฑุง 256ร256 ุทุฑุงุญ ุดุฏู

ููุช ุชุตูุฑ 512ร512 ูุงุฑุฏ ูโุดูุฏุ ูููโ ุงููุง ุชุบุฑ ูโฺฉูุฏ ู ูุฏู ููโุชูุงูุฏ ุฏุฑุณุช ฺฉุงุฑ ฺฉูุฏ.

## ุชุบุฑุงุช ุงูุฌุงู ุดุฏู

### 1. `cephx_service/app_aariz.py`
```python
# ูุจู:
result = predictor.predict(image, target_size=(512, 512))

# ุจุนุฏ:
# CRITICAL: Model was trained on 256ร256, must use same size for inference!
result = predictor.predict(image, target_size=(256, 256))
```

### 2. `Aariz/inference.py`
```python
# ููู default values ุชุบุฑ ฺฉุฑุฏ:
def preprocess_image(self, image, target_size=(256, 256)):  # ุจูุฏ: (512, 512)
def predict(self, image, target_size=(256, 256), ...):      # ุจูุฏ: (512, 512)
def predict_batch(self, images, target_size=(256, 256)):    # ุจูุฏ: (512, 512)
```

### 3. `cephx_service/app_aariz.py` - Endpoint `/info`
```python
"input_size": {
    "width": 256,   # ุจูุฏ: 512
    "height": 256   # ุจูุฏ: 512
}
```

## ูุญูู ุชุณุช

ุจุนุฏ ุงุฒ ุชุบุฑุงุชุ ุจุงุฏ:

1. **ุณุฑูุณ ุฑุง restart ฺฉูุฏ**:
   ```batch
   cephx_service\run_aariz_service.bat
   ```

2. **ฺฉ ุชุตูุฑ ุชุณุช ฺฉูุฏ** ู ูุชุงุฌ ุฑุง ุจุง annotation ูุงูุน ููุงุณู ฺฉูุฏ:
   - MRE ุจุงุฏ ูุฒุฏฺฉ ุจู **1.7mm** ุจุงุดุฏ (ูู 54mm!)
   - SDR @ 2mm ุจุงุฏ ูุฒุฏฺฉ ุจู **72%** ุจุงุดุฏ

3. **ูุดุงูุฏู ฺฉูุฏ ฺฉู**:
   - ููุฏูุงุฑฺฉโูุง ุฏุฑ ูููุนุชโูุง ุตุญุญ ูุฑุงุฑ ุฏุงุฑูุฏ
   - ุฎุทุงูุง ุฏุฑ ูุญุฏูุฏู ูุงุจู ูุจูู ุจุงูู ูุณุชูุฏ (ฺฉูุชุฑ ุงุฒ 2-3mm)

## ูฺฉุงุช ููู

โ๏ธ **ูุฑฺฏุฒ** ุงูุฏุงุฒู ุชุตูุฑ inference ุฑุง ุจุง ุงูุฏุงุฒู ุขููุฒุด ูุชูุงูุช ูฺฉูุฏุ ูฺฏุฑ ุงูฺฉู:

1. **ูุฏู ุงุฒ ุงูู** ุฑู ุงูุฏุงุฒู ุจุฒุฑฺฏโุชุฑ ุขููุฒุด ุฏุฏู ุจุงุดุฏ
2. **Transform ูุง ุฏูู** ุจุฑุง ุชุจุฏู ูุฎุชุตุงุช ูพุงุฏู ุดุฏู ุจุงุดุฏ
3. **Test ุดุฏู** ู ูุชุงุฌ ูุนุชุจุฑ ุจุงุดูุฏ

## ุงฺฏุฑ ูโุฎูุงูุฏ ุงุฒ 512ร512 ุงุณุชูุงุฏู ฺฉูุฏ:

1. **ูุฏู ุฑุง ุฏูุจุงุฑู ุขููุฒุด ุฏูุฏ** ุจุง `image_size=(512, 512)`
2. **ุง fine-tune ฺฉูุฏ** ุงุฒ checkpoint ูุนู ุจุง ุงูุฏุงุฒู 512ร512
3. **ุชุณุช ฺฉูุฏ** ู ูุชุงุฌ ุฑุง ุจุง 256ร256 ููุงุณู ฺฉูุฏ

---

**ุชุงุฑุฎ ุฑูุน ูุดฺฉู**: 2024-11-01
**ูุณุฎู**: 1.0.0

