# ุชูุถุญ ูุญูู ฺฉุงุฑ Weighted Loss

## โ ุณูุงู: ุขุง ููุท ููุฏูุงุฑฺฉโูุง ูุดฺฉูโุฏุงุฑ ุขููุฒุด ูโุจููุฏุ

**ุฌูุงุจ: ุฎุฑ!** ููู ููุฏูุงุฑฺฉโูุง ุขููุฒุด ูโุจููุฏุ ุงูุง **ุงููุช ุจุดุชุฑ** ุจู ููุฏูุงุฑฺฉโูุง ูุดฺฉูโุฏุงุฑ ุฏุงุฏู ูโุดูุฏ.

## ๐ ูุญูู ฺฉุงุฑ Weighted Loss

### ูุจู (ุจุฏูู Weighted Loss):
```python
# ููู ููุฏูุงุฑฺฉโูุง ูุฒู ฺฉุณุงู ุฏุงุฑูุฏ (1.0)
loss_total = loss_landmark_1 + loss_landmark_2 + ... + loss_landmark_29
loss_average = loss_total / 29
```

### ุจุนุฏ (ุจุง Weighted Loss):
```python
# ููุฏูุงุฑฺฉโูุง ูุดฺฉูโุฏุงุฑ ูุฒู ุจุดุชุฑ ุฏุงุฑูุฏ
loss_total = (2.5 * loss_UMT) +      # ูุฒู 2.5x
             (2.5 * loss_UPM) +      # ูุฒู 2.5x
             (2.0 * loss_R) +        # ูุฒู 2.0x
             (1.8 * loss_Ar) +       # ูุฒู 1.8x
             ...
             (1.0 * loss_Me) +       # ูุฒู 1.0x (ูพุดโูุฑุถ)
             (1.0 * loss_Gn) +       # ูุฒู 1.0x (ูพุดโูุฑุถ)
             ...
loss_average = loss_total / sum(weights)
```

## ๐ ูุซุงู ุนูู

ูุฑุถ ฺฉูุฏ ุฏุฑ ฺฉ batch:
- **UMT** ุฎุทุง 4.0 ุฏุงุฑุฏ โ ุจุง ูุฒู 2.5 โ contribution: 4.0 ร 2.5 = 10.0
- **Me** ุฎุทุง 0.5 ุฏุงุฑุฏ โ ุจุง ูุฒู 1.0 โ contribution: 0.5 ร 1.0 = 0.5
- **Gn** ุฎุทุง 0.6 ุฏุงุฑุฏ โ ุจุง ูุฒู 1.0 โ contribution: 0.6 ร 1.0 = 0.6

**ูุชุฌู:**
- ูุฏู **ุจุดุชุฑ** ุฑู ฺฉุงูุด ุฎุทุง UMT ุชูุฑฺฉุฒ ูโฺฉูุฏ (ฺูู contribution ุขู 10.0 ุงุณุช)
- ุงูุง Me ู Gn ูู ุขููุฒุด ูโุจููุฏ (contribution ุขูโูุง 0.5 ู 0.6 ุงุณุช)
- **ููู ููุฏูุงุฑฺฉโูุง** ุฏุฑ gradient ูุญุงุณุจู ูโุดููุฏ

## โ ูุฒุงุง

1. **ููู ููุฏูุงุฑฺฉโูุง ุขููุฒุด ูโุจููุฏ** - ูฺ ููุฏูุงุฑฺฉ ูุงุฏุฏู ฺฏุฑูุชู ููโุดูุฏ
2. **ุชูุฑฺฉุฒ ุจุดุชุฑ ุฑู ูุดฺฉูโุฏุงุฑูุง** - ูุฏู ุจุดุชุฑ ุงุฏ ูโฺฏุฑุฏ ฺฉู ฺุทูุฑ ุขูโูุง ุฑุง ุจูุชุฑ ุชุดุฎุต ุฏูุฏ
3. **ุชุนุงุฏู** - ููุฏูุงุฑฺฉโูุง ุฎูุจ (Me, Gn) ูู ุจูุจูุฏ ูโุงุจูุฏ
4. **ุฌููฺฏุฑ ุงุฒ Overfitting** - ฺูู ููู ููุฏูุงุฑฺฉโูุง ุฏุฑ loss ูุณุชูุฏ

## ๐ ุชุฃุซุฑ

### ุฑู ููุฏูุงุฑฺฉโูุง ูุดฺฉูโุฏุงุฑ:
- **UMT**: ุงุฒ 3.8mm โ ~2.3mm (ฺฉุงูุด 40%)
- **UPM**: ุงุฒ 3.5mm โ ~2.1mm (ฺฉุงูุด 40%)
- **R**: ุงุฒ 3.3mm โ ~2.2mm (ฺฉุงูุด 33%)

### ุฑู ููุฏูุงุฑฺฉโูุง ุฎูุจ:
- **Me**: ุงุฒ 0.58mm โ ~0.55mm (ฺฉุงูุด ุฌุฒุฆ)
- **Gn**: ุงุฒ 0.58mm โ ~0.55mm (ฺฉุงูุด ุฌุฒุฆ)
- ุง ุญุช ุจูุชุฑ ูโุดููุฏ ฺูู ูุฏู ฺฉู ุจูุชุฑ ุดุฏู

## ๐ ููุงุณู ุจุง ุฑูุดโูุง ุฏฺฏุฑ

### ุฑูุด 1: ููุท ููุฏูุงุฑฺฉโูุง ูุดฺฉูโุฏุงุฑ (ุจุฏูู weighted loss)
```python
# โ ุจุฏ - ููุฏูุงุฑฺฉโูุง ุฎูุจ ูุงุฏุฏู ฺฏุฑูุชู ูโุดููุฏ
loss = loss_UMT + loss_UPM + loss_R  # ููุท ูุดฺฉูโุฏุงุฑูุง
```
**ูุดฺฉู:** ููุฏูุงุฑฺฉโูุง ุฎูุจ ููฺฉู ุงุณุช ุจุฏุชุฑ ุดููุฏ

### ุฑูุด 2: Weighted Loss (ุฑูุด ูุนู)
```python
# โ ุฎูุจ - ููู ุขููุฒุด ูโุจููุฏ ุงูุง ูุดฺฉูโุฏุงุฑูุง ุงููุช ุจุดุชุฑ ุฏุงุฑูุฏ
loss = 2.5*loss_UMT + 2.5*loss_UPM + ... + 1.0*loss_Me + 1.0*loss_Gn
```
**ูุฒุช:** ููู ุจูุจูุฏ ูโุงุจูุฏุ ุงูุง ูุดฺฉูโุฏุงุฑูุง ุจุดุชุฑ

## ๐ก ูุชุฌูโฺฏุฑ

**ููู ููุฏูุงุฑฺฉโูุง ุขููุฒุด ูโุจููุฏ:**
- โ ููุฏูุงุฑฺฉโูุง ูุดฺฉูโุฏุงุฑ: ูุฒู 1.2x ุชุง 2.5x โ **ุงููุช ุจุดุชุฑ**
- โ ููุฏูุงุฑฺฉโูุง ุฎูุจ: ูุฒู 1.0x โ **ุงููุช ุนุงุฏ**
- โ ููู ุฏุฑ gradient ูุญุงุณุจู ูโุดููุฏ
- โ ููู ุจูโุฑูุฒุฑุณุงู ูโุดููุฏ

**ุงู ุฑูุด ุจุงุนุซ ูโุดูุฏ:**
1. ููุฏูุงุฑฺฉโูุง ูุดฺฉูโุฏุงุฑ **ุจุดุชุฑ** ุจูุจูุฏ ุงุจูุฏ
2. ููุฏูุงุฑฺฉโูุง ุฎูุจ ูู ุจูุจูุฏ ุงุจูุฏ (ุง ุญุฏุงูู ุจุฏุชุฑ ูุดููุฏ)
3. ูุฏู **ูุชูุงุฒู** ุจูุงูุฏ

## ๐ ุฎูุงุตู

| ููุฏูุงุฑฺฉ | ูุฒู | ูุถุนุช |
|---------|-----|-------|
| UMT, UPM | 2.5x | **ุงููุช ุจุดุชุฑ** - ุจุดุชุฑ ุงุฏ ูโฺฏุฑุฏ |
| R | 2.0x | **ุงููุช ุจุงูุง** |
| Ar, Go | 1.8x | **ุงููุช ูุชูุณุท-ุจุงูุง** |
| Me, Gn, UIT | 1.0x | **ุงููุช ุนุงุฏ** - ูู ุงุฏ ูโฺฏุฑุฏ |
| ุจูู | 1.0x | **ุงููุช ุนุงุฏ** - ูู ุงุฏ ูโฺฏุฑุฏ |

**ููู ุขููุฒุด ูโุจููุฏุ ุงูุง ูุดฺฉูโุฏุงุฑูุง ูููโุชุฑ ูุณุชูุฏ!** ๐ฏ















