# ๐ ุฑุงูููุง ุณุฑุน ุจูุจูุฏ ุฏูุช ูุฏู Aariz

## ๐ ูุถุนุช ูุนู

ุงุฒ ูุชุงุฌ evaluation:
- **MRE**: 1.67mm โ (ุฎูุจ ุงูุง ูุงุจู ุจูุจูุฏ)
- **SDR @ 2mm**: 71.86% โ๏ธ (ูุฏู: > 75%)
- **SDR @ 4mm**: 92.85% โ (ุฎูุจ)

**ูุดฺฉู:** ุจุฑุฎ ููุฏูุงุฑฺฉโูุง ุฏุฑ ูููุนุช ูุงุฏุฑุณุช ูุณุชูุฏ.

---

## ๐ฏ ุฑุงูโุญูโูุง ุณุฑุน (ุจุฏูู ุขููุฒุด ูุฌุฏุฏ)

### ุฑุงูโุญู 1: ุงุณุชูุงุฏู ุงุฒ ุจูุชุฑู Checkpoint

#### ูุฑุญูู 1: ูพุฏุง ฺฉุฑุฏู ุจูุชุฑู checkpoint

```powershell
cd Aariz
python find_best_checkpoint.py
```

ุงู ุงุณฺฉุฑูพุช ุชูุงู checkpoint ูุง ุฑุง ุจุฑุฑุณ ูโฺฉูุฏ ู ุจูุชุฑู ุฑุง ุจุฑ ุงุณุงุณ MRE ูพุฏุง ูโฺฉูุฏ.

#### ูุฑุญูู 2: ุชุบุฑ checkpoint ุฏุฑ ุณุฑูุณ

ุฏุฑ ูุงู `cephx_service/app_aariz.py`:

```python
# ุฎุท 32 ุฑุง ูพุฏุง ฺฉูุฏ ู ุชุบุฑ ุฏูุฏ:
CHECKPOINT_PATH = os.path.join(aariz_path, 'checkpoints', 'checkpoint_epoch_XXX.pth')  # checkpoint ุจุง ฺฉูุชุฑู MRE
```

ุง ุงฺฏุฑ `checkpoint_best.pth` ุจูุชุฑู ุงุณุชุ ููุงู ุฑุง ูฺฏู ุฏุงุฑุฏ.

---

### ุฑุงูโุญู 2: Fine-tuning (ุชูุตู ูโุดูุฏ)

ุงู ุณุฑุนโุชุฑู ุฑุงู ุจุฑุง ุจูุจูุฏ ุงุณุช:

```powershell
cd Aariz
python train_optimized.py ^
  --model hrnet ^
  --resume checkpoints/checkpoint_best.pth ^
  --epochs 50 ^
  --learning_rate 1e-5 ^
  --batch_size 4 ^
  --image_size 512 512 ^
  --mixed_precision ^
  --use_ema ^
  --gradient_accumulation_steps 2 ^
  --warmup_epochs 5
```

**ูุฒุงุง:**
- โ ุณุฑุน: ููุท 50 epoch (ุญุฏูุฏ 2-4 ุณุงุนุช ุจุณุชู ุจู GPU)
- โ ุจูุจูุฏ ุชุฏุฑุฌ: ูุนูููุงู 0.1-0.2mm ุจูุจูุฏ MRE
- โ ุญูุธ ุฏุงูุด ูุจู: ูุฏู ฺุฒูุง ฺฉู ุงุฏ ฺฏุฑูุชู ุฑุง ุญูุธ ูโฺฉูุฏ

**ุงูุชุธุงุฑ:** MRE ุงุฒ 1.67mm ุจู 1.5-1.6mm ุจูุจูุฏ ูโุงุจุฏ.

---

## ๐ง ุฑุงูโุญูโูุง ูพุดุฑูุชูโุชุฑ

### ุฑุงูโุญู 3: ุขููุฒุด ูุฌุฏุฏ ุจุง ุชูุธูุงุช ุจููู

ุงฺฏุฑ fine-tuning ฺฉุงู ูุจูุฏ:

```powershell
cd Aariz
python train_optimized.py ^
  --model hrnet ^
  --dataset_path Aariz ^
  --epochs 300 ^
  --batch_size 4 ^
  --image_size 512 512 ^
  --learning_rate 3e-4 ^
  --mixed_precision ^
  --use_ema ^
  --gradient_accumulation_steps 2 ^
  --warmup_epochs 10
```

**ุชุบุฑุงุช ูุณุจุช ุจู ุชูุธูุงุช ูุนู:**
- โ Epochs ุจุดุชุฑ: 300 (ุจู ุฌุง 250)
- โ Learning rate ูพุงูโุชุฑ: 3e-4 (ุจุฑุง ุฏูุช ุจุดุชุฑ)
- โ Warmup ุจุดุชุฑ: 10 epochs

**ุงูุชุธุงุฑ:** MRE ุจู 1.4-1.5mm ูโุฑุณุฏ.

---

### ุฑุงูโุญู 4: ุชูุธูุงุช ูพุดุฑูุชู ุจุฑุง ุฏูุช ุจุงูุง

ุงฺฏุฑ ูโุฎูุงูุฏ ุจูุชุฑู ูุชุงุฌ ุฑุง ุจฺฏุฑุฏุ `config.py` ุฑุง ุชุบุฑ ุฏูุฏ:

```python
# ุฏุฑ Aariz/config.py
@dataclass
class TrainingConfig:
    # ... ุณุงุฑ ุชูุธูุงุช ...
    
    # Image
    image_size: tuple = (512, 512)
    heatmap_sigma: float = 3.5  # โ ุจุงุฏ 3-4 ุจุงุดุฏ!
    
    # Loss - ุงูุฒุงุด ูุฒู focal loss
    focal_weight: float = 0.6  # ุชุบุฑ ุงุฒ 0.5 ุจู 0.6
    
    # Augmentation - ฺฉุงูุด ุจุฑุง ุฏูุช ุจุดุชุฑ
    rotation_degrees: float = 3.0  # ฺฉุงูุด ุงุฒ 5.0 ุจู 3.0
    brightness: float = 0.05  # ฺฉุงูุด ุงุฒ 0.1 ุจู 0.05
    contrast: float = 0.05  # ฺฉุงูุด ุงุฒ 0.1 ุจู 0.05
    
    # Learning rate
    learning_rate: float = 3e-4  # ฺฉุงูุด ุงุฒ 5e-4 ุจู 3e-4
```

ุณูพุณ ุขููุฒุด ูุฌุฏุฏ:

```powershell
python train_optimized.py --config HIGH_ACCURACY_CONFIG ...
```

---

## ๐ ฺฺฉโูุณุช ุงูุฏุงูุงุช

### ููุฑ (ุจุฏูู ุขููุฒุด):

- [ ] ุงุฌุฑุง `find_best_checkpoint.py` ุจุฑุง ูพุฏุง ฺฉุฑุฏู ุจูุชุฑู checkpoint
- [ ] ุชุบุฑ `CHECKPOINT_PATH` ุฏุฑ `app_aariz.py` ุงฺฏุฑ checkpoint ุจูุชุฑ ูพุฏุง ุดุฏ
- [ ] ุชุณุช ูุฌุฏุฏ ุฑู ฺูุฏ ุชุตูุฑ

### ฺฉูุชุงูโูุฏุช (Fine-tuning - 2-4 ุณุงุนุช):

- [ ] Fine-tuning ุจุง `learning_rate=1e-5` ุจุฑุง 50 epoch
- [ ] ุจุฑุฑุณ ุจูุจูุฏ ุฏุฑ TensorBoard
- [ ] ุชุณุช ุฑู validation set

### ุจููุฏโูุฏุช (ุขููุฒุด ูุฌุฏุฏ - 1-2 ุฑูุฒ):

- [ ] ุขููุฒุด ูุฌุฏุฏ ุจุง ุชูุธูุงุช ุจููู
- [ ] ุงุณุชูุงุฏู ุงุฒ 300 epochs
- [ ] ุงุณุชูุงุฏู ุงุฒ learning rate ูพุงูโุชุฑ

---

## ๐ ุนุจโุงุจ

### ุงฺฏุฑ ููุฏูุงุฑฺฉโูุง ุฎุงุต ูุดฺฉู ุฏุงุฑูุฏ:

```python
# ุจุฑุฑุณ MRE ูุฑ ููุฏูุงุฑฺฉ ุจู ุตูุฑุช ุฌุฏุงฺฏุงูู
python evaluate.py --checkpoint checkpoints/checkpoint_best.pth --per-landmark
```

ุงู ูุดุงู ูโุฏูุฏ ฺฉุฏุงู ููุฏูุงุฑฺฉโูุง ุจุดุชุฑู ุฎุทุง ุฑุง ุฏุงุฑูุฏ.

### ุงฺฏุฑ ูุดฺฉู ุงุฒ dataset ุงุณุช:

1. ุจุฑุฑุณ annotations: ุขุง ุชูุงู annotations ุฏุฑุณุช ูุณุชูุฏุ
2. ุจุฑุฑุณ pixel size: ุขุง pixel size ุจุฑุง ูุฑ ุชุตูุฑ ุฏุฑุณุช ุงุณุชุ
3. ุจุฑุฑุณ ุชุตุงูุฑ: ุขุง ุชุตุงูุฑ ฺฉูุช ุฎูุจ ุฏุงุฑูุฏุ

---

## ๐ ุงูุชุธุงุฑุงุช ูุงูุนโุจูุงูู

### ูพุณ ุงุฒ Fine-tuning (50 epochs):
- MRE: 1.5-1.6mm โ
- SDR @ 2mm: 75-78% โ

### ูพุณ ุงุฒ ุขููุฒุด ูุฌุฏุฏ (300 epochs):
- MRE: 1.4-1.5mm โ
- SDR @ 2mm: 78-82% โ

### ุจูุชุฑู ุญุงูุช (ุจุง ุชูุธูุงุช ุจููู + ุฏุงุฏูโูุง ุฎูุจ):
- MRE: 1.2-1.4mm โ
- SDR @ 2mm: 82-85% โ

---

## ๐ก ุชูุตู ููุง

**ุจุฑุง ุดุฑูุน ุณุฑุน:**

1. โ ุงุฌุฑุง `find_best_checkpoint.py`
2. โ Fine-tuning 50 epochs
3. โ ุชุณุช ู ุจุฑุฑุณ ูุชุงุฌ

**ุงฺฏุฑ ูุชุงุฌ ุจูุชุฑ ูุดุฏ:**

1. โ ุจุฑุฑุณ dataset ู annotations
2. โ ุขููุฒุด ูุฌุฏุฏ ุจุง ุชูุธูุงุช ุจููู
3. โ ุจุฑุฑุณ TensorBoard logs

---

**ูููู ุจุงุดุฏ! ๐**

ุจุฑุง ุณูุงูุงุช ุจุดุชุฑุ ูุงู `IMPROVE_MODEL_ACCURACY.md` ุฑุง ุจุฑุฑุณ ฺฉูุฏ.

