# ğŸ¯ Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ø¬Ø§Ù…Ø¹ Ø¨Ù‡Ø¨ÙˆØ¯ Ù†ØªØ§ÛŒØ¬ Ù…Ø¯Ù„

## ğŸ“Š ÙˆØ¶Ø¹ÛŒØª ÙØ¹Ù„ÛŒ

- **MRE**: 1.99 mm âœ… (Ø®ÙˆØ¨ - Ø²ÛŒØ± 2mm)
- **SDR @ 2mm**: 65.52% (19/29 Ù„Ù†Ø¯Ù…Ø§Ø±Ú©â€ŒÙ‡Ø§)
- **Ù‡Ø¯Ù**: MRE ~1.7mmØŒ SDR @ 2mm ~72%
- **ÙØ§ØµÙ„Ù‡ ØªØ§ Ù‡Ø¯Ù**: 6.48% (13 Ù„Ù†Ø¯Ù…Ø§Ø±Ú©â€ŒÙ‡Ø§ÛŒ Ø¨ÛŒØ´ØªØ± Ø¯Ø± Ù…Ø­Ø¯ÙˆØ¯Ù‡ 2mm)

## ğŸ¯ Ø§Ø³ØªØ±Ø§ØªÚ˜ÛŒ Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ÛŒ (Ø¨Ù‡ ØªØ±ØªÛŒØ¨ Ø§ÙˆÙ„ÙˆÛŒØª)

### 1ï¸âƒ£ Fine-tuning (Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ Ø§ÙˆÙ„) â­â­â­â­â­

**Ú†Ø±Ø§ Fine-tuning Ø¨Ù‡ØªØ± Ø§Ø³Øª:**
- âœ… **Ø³Ø±ÛŒØ¹â€ŒØªØ±**: ÙÙ‚Ø· 20-50 epoch Ù†ÛŒØ§Ø² Ø¯Ø§Ø±Ø¯
- âœ… **Ø®Ø·Ø± Ú©Ù…ØªØ±**: Ù…Ø¯Ù„ ÙØ¹Ù„ÛŒ Ø±Ø§ Ø¨Ù‡Ø¨ÙˆØ¯ Ù…ÛŒâ€ŒØ¯Ù‡Ø¯ØŒ Ù†Ù‡ Ù†Ø§Ø¨ÙˆØ¯
- âœ… **Ú©Ø§Ø±Ø¢Ù…Ø¯ØªØ±**: Ø§Ø² ÛŒØ§Ø¯Ú¯ÛŒØ±ÛŒ Ù‚Ø¨Ù„ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒÚ©Ù†Ø¯
- âœ… **Ø§Ø­ØªÙ…Ø§Ù„ Ù…ÙˆÙÙ‚ÛŒØª Ø¨Ø§Ù„Ø§**: Ù…Ø¯Ù„ Ø´Ù…Ø§ Ù‚Ø¨Ù„Ø§Ù‹ Ø®ÙˆØ¨ Ú©Ø§Ø± Ù…ÛŒâ€ŒÚ©Ù†Ø¯

**Ø²Ù…Ø§Ù†**: 2-4 Ø³Ø§Ø¹Øª (Ø¨Ø±Ø§ÛŒ 30-50 epoch)

---

### 2ï¸âƒ£ Ø¢Ù…ÙˆØ²Ø´ Ø§Ø² Ø§ÙˆÙ„ (Ú¯Ø²ÛŒÙ†Ù‡ Ø¯ÙˆÙ…) â­â­â­

**Ú†Ø±Ø§ Ù…Ù…Ú©Ù† Ø§Ø³Øª Ù„Ø§Ø²Ù… Ø¨Ø§Ø´Ø¯:**
- âŒ Ø§Ú¯Ø± fine-tuning Ø¬ÙˆØ§Ø¨ Ù†Ø¯Ù‡Ø¯
- âŒ Ø§Ú¯Ø± Ù…ÛŒâ€ŒØ®ÙˆØ§Ù‡ÛŒØ¯ Ø§Ø² ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ú©Ø§Ù…Ù„Ø§Ù‹ Ø¬Ø¯ÛŒØ¯ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯
- âŒ Ø§Ú¯Ø± checkpoint Ù‡Ø§ÛŒ Ù‚Ø¨Ù„ÛŒ Ù…Ø´Ú©Ù„ Ø¯Ø§Ø±Ù†Ø¯

**Ø²Ù…Ø§Ù†**: 8-12 Ø³Ø§Ø¹Øª (Ø¨Ø±Ø§ÛŒ 100 epoch)

---

### 3ï¸âƒ£ Ø¨Ù‡Ø¨ÙˆØ¯Ù‡Ø§ÛŒ Ø¯ÛŒÚ¯Ø± â­â­â­â­

- Augmentation Ø¨Ù‡ØªØ±
- Loss function Ø¨Ù‡ØªØ±
- Learning rate scheduling
- Post-processing

---

## ğŸ“ 1. Fine-tuning (Ù…Ø±Ø­Ù„Ù‡ Ø¨Ù‡ Ù…Ø±Ø­Ù„Ù‡)

### Ù…Ø±Ø­Ù„Ù‡ 1: Ø¨Ø±Ø±Ø³ÛŒ Ø¨Ù‡ØªØ±ÛŒÙ† Checkpoint

```bash
cd Aariz
python find_best_checkpoint.py checkpoints
```

Ø§ÛŒÙ† Ú©Ø§Ø± Ø¨Ù‡ Ø´Ù…Ø§ Ù†Ø´Ø§Ù† Ù…ÛŒâ€ŒØ¯Ù‡Ø¯ Ú©Ù‡ Ø¢ÛŒØ§ `checkpoint_best.pth` ÙˆØ§Ù‚Ø¹Ø§Ù‹ Ø¨Ù‡ØªØ±ÛŒÙ† Ø§Ø³Øª ÛŒØ§ Ù†Ù‡.

### Ù…Ø±Ø­Ù„Ù‡ 2: Fine-tuning Ø¨Ø§ Learning Rate Ù¾Ø§ÛŒÛŒÙ†

**Ú¯Ø²ÛŒÙ†Ù‡ A: Fine-tuning Ù…Ù„Ø§ÛŒÙ… (Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ÛŒ)**

```bash
python train2.py \
    --resume checkpoints/checkpoint_best.pth \
    --dataset_path Aariz \
    --model hrnet \
    --image_size 256 256 \
    --batch_size 16 \
    --lr 1e-5 \
    --warmup_epochs 2 \
    --epochs 30 \
    --loss adaptive_wing \
    --mixed_precision
```

**Ù¾Ø§Ø±Ø§Ù…ØªØ±Ù‡Ø§ÛŒ Ú©Ù„ÛŒØ¯ÛŒ:**
- `--lr 1e-5`: Learning rate Ø®ÛŒÙ„ÛŒ Ù¾Ø§ÛŒÛŒÙ† (10x Ú©Ù…ØªØ± Ø§Ø² Ø§ÙˆÙ„ÛŒÙ‡)
- `--epochs 30`: ÙÙ‚Ø· 30 epoch
- `--warmup_epochs 2`: Warmup Ú©ÙˆØªØ§Ù‡

**Ú¯Ø²ÛŒÙ†Ù‡ B: Fine-tuning Ù…ØªÙˆØ³Ø·**

```bash
python train2.py \
    --resume checkpoints/checkpoint_best.pth \
    --dataset_path Aariz \
    --model hrnet \
    --image_size 256 256 \
    --batch_size 16 \
    --lr 5e-5 \
    --warmup_epochs 3 \
    --epochs 50 \
    --loss adaptive_wing \
    --mixed_precision
```

### Ù…Ø±Ø­Ù„Ù‡ 3: Ø±ØµØ¯ Ú©Ø±Ø¯Ù† Ù†ØªØ§ÛŒØ¬

Ø¯Ø± Ø·ÙˆÙ„ Ø¢Ù…ÙˆØ²Ø´ØŒ Tensorboard Ø±Ø§ Ø§Ø¬Ø±Ø§ Ú©Ù†ÛŒØ¯:

```bash
tensorboard --logdir logs
```

**Ù†Ø´Ø§Ù†Ù‡â€ŒÙ‡Ø§ÛŒ Ù…ÙˆÙÙ‚ÛŒØª:**
- âœ… Validation MRE Ú©Ø§Ù‡Ø´ Ù…ÛŒâ€ŒÛŒØ§Ø¨Ø¯ (Ø§Ø² 1.99mm Ø¨Ù‡ 1.7-1.8mm)
- âœ… Validation loss Ú©Ø§Ù‡Ø´ Ù…ÛŒâ€ŒÛŒØ§Ø¨Ø¯
- âœ… SDR Ø§ÙØ²Ø§ÛŒØ´ Ù…ÛŒâ€ŒÛŒØ§Ø¨Ø¯

**Ù†Ø´Ø§Ù†Ù‡â€ŒÙ‡Ø§ÛŒ Ù…Ø´Ú©Ù„:**
- âŒ Validation MRE Ø§ÙØ²Ø§ÛŒØ´ Ù…ÛŒâ€ŒÛŒØ§Ø¨Ø¯ (overfitting)
- âŒ Loss Ù†ÙˆØ³Ø§Ù† Ø¯Ø§Ø±Ø¯ ÛŒØ§ Ø§ÙØ²Ø§ÛŒØ´ Ù…ÛŒâ€ŒÛŒØ§Ø¨Ø¯

### Ù…Ø±Ø­Ù„Ù‡ 4: ØªÙˆÙ‚Ù Ø¯Ø± ØµÙˆØ±Øª overfitting

Ø§Ú¯Ø± validation MRE Ø´Ø±ÙˆØ¹ Ø¨Ù‡ Ø§ÙØ²Ø§ÛŒØ´ Ú©Ø±Ø¯ØŒ Ø¢Ù…ÙˆØ²Ø´ Ø±Ø§ Ù…ØªÙˆÙ‚Ù Ú©Ù†ÛŒØ¯:
- `Ctrl + C`
- Ø§Ø² Ø¢Ø®Ø±ÛŒÙ† checkpoint Ù‚Ø¨Ù„ Ø§Ø² Ø§ÙØ²Ø§ÛŒØ´ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯

---

## ğŸ“ 2. Ø¢Ù…ÙˆØ²Ø´ Ø§Ø² Ø§ÙˆÙ„

### Ø§Ú¯Ø± Fine-tuning Ø¬ÙˆØ§Ø¨ Ù†Ø¯Ø§Ø¯:

**Ú¯Ø²ÛŒÙ†Ù‡ A: Ø¢Ù…ÙˆØ²Ø´ Ø¨Ø§ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø¨Ù‡ÛŒÙ†Ù‡**

```bash
python train2.py \
    --dataset_path Aariz \
    --model hrnet \
    --image_size 256 256 \
    --batch_size 16 \
    --lr 5e-4 \
    --warmup_epochs 5 \
    --epochs 100 \
    --loss adaptive_wing \
    --mixed_precision \
    --annotation_type "Senior Orthodontists"
```

**Ú¯Ø²ÛŒÙ†Ù‡ B: Ø¢Ù…ÙˆØ²Ø´ Ø¨Ø§ Augmentation Ø¨ÛŒØ´ØªØ±**

Ø§Ø¨ØªØ¯Ø§ `dataset.py` Ø±Ø§ Ø¨Ø±Ø±Ø³ÛŒ Ú©Ù†ÛŒØ¯ Ùˆ augmentation Ù‡Ø§ Ø±Ø§ ØªÙ‚ÙˆÛŒØª Ú©Ù†ÛŒØ¯.

---

## ğŸ“ 3. Ø¨Ù‡Ø¨ÙˆØ¯Ù‡Ø§ÛŒ ØªÚ©Ù…ÛŒÙ„ÛŒ

### A. Augmentation Ø¨Ù‡ØªØ±

Ø¯Ø± `dataset.py`ØŒ augmentation Ù‡Ø§ Ø±Ø§ ØªÙ‚ÙˆÛŒØª Ú©Ù†ÛŒØ¯:

```python
# Ø§ÙØ²Ø§ÛŒØ´ rotation
rotation_degrees: float = 8.0  # Ø¨ÙˆØ¯: 5.0

# Ø§ÙØ²Ø§ÛŒØ´ brightness/contrast variation
brightness: float = 0.15  # Ø¨ÙˆØ¯: 0.1
contrast: float = 0.15    # Ø¨ÙˆØ¯: 0.1
```

### B. Loss Function Ø¨Ù‡ØªØ±

Ø§Ø² Adaptive Wing Loss Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯ (Ø¯Ø± Ø­Ø§Ù„ Ø­Ø§Ø¶Ø± Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯):

```python
--loss adaptive_wing
```

### C. Learning Rate Scheduling

Ø§Ø² WarmupCosineScheduler Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯ (Ø¯Ø± Ø­Ø§Ù„ Ø­Ø§Ø¶Ø± Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯).

### D. Post-processing

ÛŒÚ© Ù„Ø§ÛŒÙ‡ post-processing Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†ÛŒØ¯ Ø¨Ø±Ø§ÛŒ Ø¨Ù‡Ø¨ÙˆØ¯ Ø¯Ù‚Øª:

```python
# Ø¯Ø± inference.py
def smooth_landmarks(landmarks, image_size):
    """Smooth landmarks using spatial constraints"""
    # TODO: Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ
    return landmarks
```

---

## ğŸ¯ Ø³Ù†Ø§Ø±ÛŒÙˆÙ‡Ø§ÛŒ Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ÛŒ

### Ø³Ù†Ø§Ø±ÛŒÙˆ 1: Ø³Ø±ÛŒØ¹ (2-3 Ø³Ø§Ø¹Øª) â­â­â­â­â­

```bash
# Fine-tuning Ù…Ù„Ø§ÛŒÙ…
python train2.py \
    --resume checkpoints/checkpoint_best.pth \
    --model hrnet \
    --image_size 256 256 \
    --batch_size 16 \
    --lr 1e-5 \
    --warmup_epochs 2 \
    --epochs 30 \
    --loss adaptive_wing \
    --mixed_precision
```

**Ø§Ù†ØªØ¸Ø§Ø±**: SDR @ 2mm Ø¨Ù‡ 68-70% Ø¨Ø±Ø³Ø¯

---

### Ø³Ù†Ø§Ø±ÛŒÙˆ 2: Ù…ØªØ¹Ø§Ø¯Ù„ (4-6 Ø³Ø§Ø¹Øª) â­â­â­â­

```bash
# Fine-tuning Ù…ØªÙˆØ³Ø·
python train2.py \
    --resume checkpoints/checkpoint_best.pth \
    --model hrnet \
    --image_size 256 256 \
    --batch_size 16 \
    --lr 5e-5 \
    --warmup_epochs 3 \
    --epochs 50 \
    --loss adaptive_wing \
    --mixed_precision
```

**Ø§Ù†ØªØ¸Ø§Ø±**: SDR @ 2mm Ø¨Ù‡ 70-72% Ø¨Ø±Ø³Ø¯

---

### Ø³Ù†Ø§Ø±ÛŒÙˆ 3: Ú©Ø§Ù…Ù„ (8-12 Ø³Ø§Ø¹Øª) â­â­â­

```bash
# Ø¢Ù…ÙˆØ²Ø´ Ø§Ø² Ø§ÙˆÙ„ Ø¨Ø§ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø¨Ù‡ÛŒÙ†Ù‡
python train2.py \
    --dataset_path Aariz \
    --model hrnet \
    --image_size 256 256 \
    --batch_size 16 \
    --lr 5e-4 \
    --warmup_epochs 5 \
    --epochs 100 \
    --loss adaptive_wing \
    --mixed_precision
```

**Ø§Ù†ØªØ¸Ø§Ø±**: SDR @ 2mm Ø¨Ù‡ 72-75% Ø¨Ø±Ø³Ø¯

---

## âš ï¸ Ù†Ú©Ø§Øª Ù…Ù‡Ù…

### 1. Ù‡Ù…ÛŒØ´Ù‡ Backup Ø¨Ú¯ÛŒØ±ÛŒØ¯

```bash
# Ù‚Ø¨Ù„ Ø§Ø² Ø´Ø±ÙˆØ¹ fine-tuning
cp checkpoints/checkpoint_best.pth checkpoints/checkpoint_best_backup.pth
```

### 2. Monitor Ú©Ù†ÛŒØ¯

Ù‡Ù…ÛŒØ´Ù‡ Tensorboard Ø±Ø§ Ø¨Ø§Ø² Ú©Ù†ÛŒØ¯ ØªØ§ Ø¨Ø¨ÛŒÙ†ÛŒØ¯ Ú†Ù‡ Ø§ØªÙØ§Ù‚ÛŒ Ù…ÛŒâ€ŒØ§ÙØªØ¯.

### 3. Early Stopping

Ø§Ú¯Ø± validation MRE Ø¨Ø±Ø§ÛŒ 10 epoch Ù…ØªÙˆØ§Ù„ÛŒ Ø§ÙØ²Ø§ÛŒØ´ ÛŒØ§ÙØªØŒ Ù…ØªÙˆÙ‚Ù Ú©Ù†ÛŒØ¯.

### 4. Test Ú©Ù†ÛŒØ¯

Ø¨Ø¹Ø¯ Ø§Ø² Ù‡Ø± fine-tuningØŒ Ù…Ø¯Ù„ Ø±Ø§ Ø±ÙˆÛŒ Ù‡Ù…Ø§Ù† ØªØµÙˆÛŒØ± ØªØ³Øª Ú©Ù†ÛŒØ¯:

```bash
python compare_new_results.py
```

---

## ğŸ“Š Ù…Ø¹ÛŒØ§Ø±Ù‡Ø§ÛŒ Ù…ÙˆÙÙ‚ÛŒØª

| Ù…Ø¹ÛŒØ§Ø± | ÙØ¹Ù„ÛŒ | Ù‡Ø¯Ù Fine-tuning | Ù‡Ø¯Ù Ø¢Ù…ÙˆØ²Ø´ Ø§Ø² Ø§ÙˆÙ„ |
|-------|------|-----------------|-------------------|
| **MRE (mm)** | 1.99 | 1.7-1.8 | 1.5-1.7 |
| **SDR @ 2mm** | 65.52% | 70-72% | 72-75% |
| **Ù„Ù†Ø¯Ù…Ø§Ø±Ú©â€ŒÙ‡Ø§ÛŒ < 2mm** | 19/29 | 21-22/29 | 22-24/29 |

---

## ğŸš€ Ø´Ø±ÙˆØ¹ Ø³Ø±ÛŒØ¹

**Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ Ù…Ù†: Ø¨Ø§ Fine-tuning Ù…Ù„Ø§ÛŒÙ… Ø´Ø±ÙˆØ¹ Ú©Ù†ÛŒØ¯:**

```bash
cd Aariz

# 1. Backup
cp checkpoints/checkpoint_best.pth checkpoints/checkpoint_best_backup.pth

# 2. Fine-tuning
python train2.py \
    --resume checkpoints/checkpoint_best.pth \
    --model hrnet \
    --image_size 256 256 \
    --batch_size 16 \
    --lr 1e-5 \
    --warmup_epochs 2 \
    --epochs 30 \
    --loss adaptive_wing \
    --mixed_precision

# 3. Test (Ø¯Ø± terminal Ø¬Ø¯Ø§Ú¯Ø§Ù†Ù‡)
tensorboard --logdir logs
```

**Ø²Ù…Ø§Ù†**: ~2-3 Ø³Ø§Ø¹Øª  
**Ø§Ø­ØªÙ…Ø§Ù„ Ù…ÙˆÙÙ‚ÛŒØª**: 70-80%

---

## ğŸ’¡ Ù†Ú©Ø§Øª Ù¾ÛŒØ´Ø±ÙØªÙ‡

### Ø§Ú¯Ø± Fine-tuning Ø®ÛŒÙ„ÛŒ Ø¢Ù‡Ø³ØªÙ‡ Ù¾ÛŒØ´ Ù…ÛŒâ€ŒØ±ÙˆØ¯:

LR Ø±Ø§ Ú©Ù…ÛŒ Ø§ÙØ²Ø§ÛŒØ´ Ø¯Ù‡ÛŒØ¯:
```bash
--lr 5e-5  # Ø¨ÙˆØ¯: 1e-5
```

### Ø§Ú¯Ø± Overfitting Ù…ÛŒâ€ŒØ´ÙˆØ¯:

LR Ø±Ø§ Ú©Ø§Ù‡Ø´ Ø¯Ù‡ÛŒØ¯ ÛŒØ§ epochs Ø±Ø§ Ú©Ù… Ú©Ù†ÛŒØ¯:
```bash
--lr 5e-6 \
--epochs 20
```

### Ø§Ú¯Ø± Ù†ØªØ§ÛŒØ¬ Ø¨Ù‡ØªØ± Ù†Ø´Ø¯Ù†Ø¯:

Ø¨Ù‡ Ø¢Ù…ÙˆØ²Ø´ Ø§Ø² Ø§ÙˆÙ„ Ø¨Ø±ÙˆÛŒØ¯ ÛŒØ§ augmentation Ø±Ø§ ØªÙ‚ÙˆÛŒØª Ú©Ù†ÛŒØ¯.

---

## ğŸ“ Ù†ØªÛŒØ¬Ù‡â€ŒÚ¯ÛŒØ±ÛŒ

**Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ Ø§ÙˆÙ„**: Fine-tuning Ù…Ù„Ø§ÛŒÙ… (30 epoch, LR 1e-5)  
**Ø²Ù…Ø§Ù†**: 2-3 Ø³Ø§Ø¹Øª  
**Ø§Ø­ØªÙ…Ø§Ù„ Ù…ÙˆÙÙ‚ÛŒØª**: 70-80%  
**Ø§Ù†ØªØ¸Ø§Ø±**: SDR @ 2mm Ø¨Ù‡ 68-70% Ø¨Ø±Ø³Ø¯

**Ø§Ú¯Ø± Ø¬ÙˆØ§Ø¨ Ù†Ø¯Ø§Ø¯**: Fine-tuning Ù…ØªÙˆØ³Ø· (50 epoch, LR 5e-5)

**Ø¢Ø®Ø±ÛŒÙ† Ø±Ø§Ù‡**: Ø¢Ù…ÙˆØ²Ø´ Ø§Ø² Ø§ÙˆÙ„ Ø¨Ø§ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø¨Ù‡ÛŒÙ†Ù‡

